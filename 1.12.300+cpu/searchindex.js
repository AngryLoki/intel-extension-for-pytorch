Search.setIndex({"docnames": ["design_doc/isa_dyndisp", "index", "tutorials/api_doc", "tutorials/blogs_publications", "tutorials/contribution", "tutorials/examples", "tutorials/features", "tutorials/features/amp", "tutorials/features/graph_optimization", "tutorials/features/int8", "tutorials/features/isa_dynamic_dispatch", "tutorials/features/nhwc", "tutorials/features/optimizer_fusion", "tutorials/features/runtime_extension", "tutorials/features/split_sgd", "tutorials/installation", "tutorials/license", "tutorials/performance", "tutorials/performance_tuning", "tutorials/performance_tuning/known_issues", "tutorials/performance_tuning/launch_script", "tutorials/performance_tuning/torchserve", "tutorials/performance_tuning/tuning_guide", "tutorials/releases"], "filenames": ["design_doc/isa_dyndisp.md", "index.rst", "tutorials/api_doc.rst", "tutorials/blogs_publications.md", "tutorials/contribution.md", "tutorials/examples.md", "tutorials/features.rst", "tutorials/features/amp.md", "tutorials/features/graph_optimization.md", "tutorials/features/int8.md", "tutorials/features/isa_dynamic_dispatch.md", "tutorials/features/nhwc.md", "tutorials/features/optimizer_fusion.md", "tutorials/features/runtime_extension.md", "tutorials/features/split_sgd.rst", "tutorials/installation.md", "tutorials/license.md", "tutorials/performance.md", "tutorials/performance_tuning.rst", "tutorials/performance_tuning/known_issues.md", "tutorials/performance_tuning/launch_script.md", "tutorials/performance_tuning/torchserve.md", "tutorials/performance_tuning/tuning_guide.md", "tutorials/releases.md"], "titles": ["Intel\u00ae Extension for PyTorch* CPU ISA Dynamic Dispatch Design Doc", "Welcome to Intel\u00ae Extension for PyTorch* Documentation", "API Documentation", "Blogs &amp; Publications", "Contribution", "Examples", "Features", "Auto Mixed Precision (AMP)", "Graph Optimization", "Intel\u00ae Extension for PyTorch* optimizations for quantization", "ISA Dynamic Dispatching", "Channels Last", "Optimizer Fusion", "Runtime Extension", "Split SGD", "Installation Guide", "License", "Performance", "Performance Tuning Guide", "Known Issues", "Launch Script Usage Guide", "TorchServe with Intel\u00ae Extension for PyTorch*", "Performance Tuning Guide", "Releases"], "terms": {"thi": [0, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 23], "document": [0, 6, 10, 13, 23], "explain": [0, 10, 11, 14], "mechan": [0, 6, 10, 14, 23], "ipex": [0, 2, 5, 8, 9, 12, 13, 15, 19, 22, 23], "base": [0, 1, 2, 4, 5, 10, 13, 14, 15, 17, 21, 22, 23], "It": [0, 2, 6, 7, 8, 10, 11, 13, 14, 19, 20, 22, 23], "i": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 19, 21, 22, 23], "an": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23], "similar": [0, 5, 9, 10, 22], "fork": [0, 10, 22], "from": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 20, 21, 22, 23], "nativ": [0, 6, 7, 12, 14, 19, 23], "addit": [0, 2, 5, 6, 10, 14, 23], "support": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 19, 21, 22, 23], "avx512_vnni": [0, 10], "avx512_bf16": [0, 10], "amx": [0, 1, 6, 10], "statement": [0, 10], "default": [0, 2, 6, 8, 9, 10, 13, 17, 18, 21, 22, 23], "avx2": [0, 10, 15, 19, 23], "avx512": [0, 1, 6, 10, 11, 21, 23], "_": [0, 5, 8, 9, 11, 13, 17, 19, 20, 21, 22, 23], "vnni": [0, 1, 9], "bf16": [0, 2, 3, 5, 6, 12, 14, 19, 23], "current": [0, 4, 8, 9, 10, 12, 13, 23], "same": [0, 4, 6, 9, 10, 11, 13, 14, 20, 21, 22, 23], "gcc": [0, 10, 15, 19], "ani": [0, 4, 7, 10, 11, 20, 21, 23], "9": [0, 5, 6, 10, 15, 20, 21], "2": [0, 6, 7, 10, 11, 13, 14, 15, 16, 17, 20, 22], "10": [0, 6, 10, 11, 14, 15, 19, 20, 21, 22], "3": [0, 4, 5, 6, 7, 8, 10, 11, 13, 14, 15, 17, 20, 22, 23], "11": [0, 10, 15, 19, 20, 21], "cmake": [0, 4, 5, 10, 23], "modul": [0, 1, 2, 5, 6, 7, 8, 10, 19, 20, 23], "findavx": [0, 10], "detail": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11, 15, 19, 21, 22, 23], "copi": [0, 4, 11], "sourc": [0, 1, 4, 16, 22, 23], "file": [0, 4, 5, 7, 9, 10, 11, 20, 23], "multipl": [0, 4, 6, 7, 11, 17, 21, 22], "each": [0, 2, 7, 12, 13, 14, 15, 19, 20, 21, 22, 23], "us": [0, 1, 2, 3, 4, 5, 9, 10, 11, 12, 14, 15, 16, 18, 19, 21, 22, 23], "its": [0, 2, 5, 7, 14, 15, 17, 18, 20, 21, 22, 23], "paramet": [0, 2, 5, 6, 7, 12, 13, 14, 17, 22, 23], "gener": [0, 4, 5, 6, 10, 11, 14, 17, 18, 20, 21, 22], "object": [0, 2, 5, 10, 13, 19, 22, 23], "contain": [0, 2, 4, 8, 19, 20, 21, 22, 23], "function": [0, 1, 2, 4, 5, 6, 7, 9, 10, 13, 14, 15, 19, 22, 23], "bodi": 0, "anonym": 0, "namespac": [0, 7], "so": [0, 1, 2, 4, 5, 7, 9, 11, 13, 15, 20, 21, 22, 23], "differ": [0, 2, 5, 6, 9, 11, 13, 20, 21, 22, 23], "version": [0, 5, 6, 15, 16, 21, 22, 23], "won": [0, 2, 7], "t": [0, 2, 4, 6, 7, 9, 11, 13, 15, 19, 21, 23], "conflict": 0, "virtual": 0, "polymorph": 0, "pertain": 0, "At": 0, "runtim": [0, 1, 7, 8, 19, 22, 23], "cpuid": 0, "o": [0, 5, 10, 17], "statu": 0, "determin": [0, 14, 22], "which": [0, 2, 4, 6, 7, 9, 11, 13, 19, 20, 22, 23], "pointer": 0, "best": [0, 2, 7, 22], "match": [0, 2, 7, 20], "system": [0, 22], "specifii": 0, "complier": 0, "The": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 19, 20, 21, 22, 23], "script": [0, 1, 4, 5, 6, 7, 13, 17, 18, 19, 21, 22, 23], "locat": [0, 4, 23], "new": [0, 3, 4, 11, 13, 22], "suffix": 0, "sampl": [0, 2, 22], "origin": [0, 2, 6, 8, 9, 13, 23], "adaptiveaveragepoolingkrnl": 0, "releas": [0, 1, 11, 15, 17, 19, 22], "o3": 0, "d__avx__": 0, "dcpu_capability_avx2": 0, "mavx2": 0, "mfma": 0, "mno": 0, "avx256": 0, "split": [0, 2, 6, 12, 13, 19, 23], "unalign": [0, 23], "load": [0, 1, 2, 5, 8, 9, 21, 23], "store": [0, 11, 12, 14, 21, 22, 23], "dcpu_cap": 0, "dcpu_capability_default": 0, "d__avx512f__": 0, "mavx512f": 0, "mavx512bw": 0, "mavx512vl": 0, "mavx512dq": 0, "dcpu_capability_avx512": 0, "mavx512vnni": 0, "dcpu_capability_avx512_vnni": 0, "mavx512bf16": 0, "dcpu_capability_avx512_bf16": 0, "mamx": 0, "tile": 0, "int8": [0, 1, 11, 13, 19, 23], "dcpu_capability_amx": 0, "note": [0, 2, 3, 4, 5, 9, 10, 11, 13, 15, 17, 19, 20, 21, 22], "fulli": [0, 4, 9, 14, 22, 23], "In": [0, 1, 2, 6, 7, 11, 12, 14, 19, 20, 21, 22, 23], "order": [0, 2, 11, 14, 20, 22], "align": [0, 11, 14, 23], "we": [0, 1, 2, 4, 5, 6, 7, 9, 11, 12, 13, 14, 15, 20, 21, 22, 23], "stead": 0, "minim": [0, 10, 22], "execut": [0, 2, 6, 7, 8, 10, 12, 13, 20, 21, 22], "machin": [0, 4, 6, 15, 19, 21, 22, 23], "defin": [0, 4, 5, 6, 7, 8, 11, 21], "depend": [0, 4, 6, 11, 19, 22, 23], "librari": [0, 1, 2, 4, 5, 13, 21, 22, 23], "sleef": 0, "ar": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23], "must": [0, 4, 12], "src": 0, "regist": [0, 23], "width": [0, 11], "isa_nam": 0, "inlin": 0, "name": [0, 2, 4, 6, 15, 21, 22, 23], "higher": [0, 8, 11], "compat": [0, 14], "lower": [0, 7, 14, 23], "need": [0, 2, 4, 8, 11, 12, 13, 14, 19, 20, 22, 23], "definit": [0, 14], "Such": 0, "But": [0, 11], "don": [0, 2, 4, 7, 23], "due": [0, 5, 7, 13], "If": [0, 2, 4, 5, 7, 8, 9, 13, 15, 19, 20, 22, 23], "you": [0, 1, 2, 4, 5, 6, 7, 8, 9, 11, 13, 15, 19, 20, 22, 23], "want": [0, 2, 4, 9, 13, 15, 20], "instruct": [0, 1, 4, 5, 6, 7, 14, 15, 19, 22, 23], "refer": [0, 8, 11, 13, 15, 21, 23], "tip": 0, "relat": [0, 8, 22, 23], "newkernelkrnl": 0, "newkernel": 0, "includ": [0, 1, 2, 4, 5, 6, 9, 16, 23], "header": 0, "comment": [0, 4, 23], "set": [0, 2, 4, 5, 6, 7, 9, 14, 15, 17, 19, 20, 21, 22, 23], "mai": [0, 2, 4, 6, 7, 11, 13, 19, 20, 21, 22, 23], "make": [0, 2, 4, 5, 9, 10, 14, 15, 21, 22], "special": [0, 11], "e": [0, 5, 7, 11, 20, 22], "g": [0, 7, 11], "time": [0, 1, 2, 4, 8, 11, 12, 17, 19, 22, 23], "flag": [0, 2, 4, 13], "A": [0, 2, 4, 5, 6, 19, 20, 22, 23], "tabl": [0, 15, 23], "fastest": 0, "avail": [0, 1, 2, 5, 6, 10, 13, 15, 20, 22, 23], "chosen": [0, 7], "report": 0, "cpuinfo": 0, "mykernel": 0, "fn_type": 0, "void": 0, "const": [0, 5], "tensor": [0, 2, 5, 6, 7, 9, 13, 19, 21, 23], "x": [0, 4, 7, 8, 9, 11, 13, 14, 19, 23], "declare_dispatch": 0, "define_dispatch": 0, "register_dispatch": 0, "To": [0, 2, 4, 5, 6, 8, 9, 11, 13, 14, 15, 18, 21, 22], "call": [0, 2, 7, 8, 11, 14, 19, 21, 22, 23], "kcpu": 0, "write": 0, "follow": [0, 1, 2, 4, 5, 7, 9, 11, 14, 15, 16, 19, 20, 21, 22, 23], "guid": [0, 21, 23], "declar": 0, "type": [0, 2, 4, 5, 6, 11, 13, 14, 17, 20, 21, 23], "etc": [0, 4, 23], "some": [0, 2, 4, 6, 7, 8, 11, 13, 20, 21, 22, 23], "onli": [0, 2, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 19, 20, 21, 23], "onednn": [0, 1, 2, 3, 5, 8, 15, 19, 23], "ideep": [0, 11], "other": [0, 2, 7, 11, 12, 20, 22], "backend": [0, 2, 5, 8, 22, 23], "batchnorm": [0, 8, 11, 19, 23], "can": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23], "common": [0, 14, 20, 22], "all": [0, 2, 4, 5, 6, 7, 8, 12, 13, 21, 22, 23], "pass": [0, 1, 2, 4, 13, 19, 21, 23], "For": [0, 2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 19, 20, 21, 22, 23], "more": [0, 1, 2, 4, 5, 6, 7, 8, 12, 13, 14, 15, 19, 21, 22, 23], "intrins": 0, "fp32": [0, 2, 5, 12, 14, 19, 23], "convert": [0, 1, 2, 5, 7, 8, 11, 13, 19, 21, 23], "cvtfp32tobf16": 0, "pragma": 0, "onc": [0, 4, 5, 11, 13, 14, 21, 22], "torch_ipex": [0, 15, 23], "cvt_fp32_to_bf16": 0, "bfloat16": [0, 2, 3, 6, 11, 23], "dst": 0, "float": [0, 5, 6, 7, 9, 14, 23], "int": [0, 2, 5, 6, 19, 20, 23], "len": 0, "cvt_fp32_to_bf16_kernel_impl": 0, "cvt_fp32_to_bf16_kernel_fn": 0, "cvt_fp32_to_bf16_kernel_stub": 0, "return": [0, 2, 5, 7, 13, 19, 23], "macro": 0, "cpu_capability_avx512": 0, "cpu_capability_avx512_bf16": 0, "mean": [0, 2, 11, 13, 20, 23], "hav": 0, "capabl": [0, 3], "becaus": [0, 7, 11, 14, 19, 22, 23], "than": [0, 2, 4, 6, 11, 13, 14, 15, 22, 23], "region": [0, 2, 7, 22], "cvtfp32tobf16krnl": 0, "vec512": 0, "els": [0, 11], "vec256": 0, "endif": 0, "immintrin": 0, "__m256i": 0, "_cvt_fp32_to_bf16": 0, "__m512": 0, "reinterpret_cast": 0, "_mm512_cvtneps_pbh": 0, "__m512i": 0, "valu": [0, 2, 10, 12, 13, 14, 19, 20, 22, 23], "_mm512_castps_si512": 0, "nan": [0, 23], "_mm512_set1_epi32": 0, "0xffff": 0, "auto": [0, 2, 5, 11, 19, 20, 22, 23], "mask_valu": 0, "_mm512_cmp_ps_mask": 0, "_cmp_ord_q": 0, "ones": [0, 5, 21], "0x1": 0, "vec_bia": 0, "0x7fff": 0, "uint32_t": 0, "lsb": 0, "input": [0, 2, 5, 6, 8, 9, 11, 17, 19, 21, 22, 23], "16": [0, 13, 14, 17, 20, 21], "1": [0, 3, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 19, 22], "t_valu": 0, "_mm512_and_si512": 0, "_mm512_srli_epi32": 0, "rounding_bia": 0, "_mm512_add_epi32": 0, "befor": [0, 2, 4, 8, 11, 13, 15, 20, 22, 23], "back": [0, 11, 14], "_mm512_mask_blend_epi32": 0, "_mm512_cvtusepi32_epi16": 0, "0": [0, 2, 4, 5, 6, 7, 8, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22], "15": [0, 17, 20, 21], "f32": [0, 11], "_mm512_loadu_p": 0, "_mm256_storeu_si256": 0, "mask": [0, 6], "_mm512_maskz_loadu_p": 0, "_mm256_mask_storeu_epi16": 0, "j": [0, 4], "show": [0, 7, 14, 17, 18, 21, 22], "how": [0, 2, 9, 11, 21, 22, 23], "get": [0, 2, 5, 6, 9, 13, 14, 19, 20, 22, 23], "data": [0, 2, 5, 6, 7, 11, 12, 13, 14, 17, 21, 23], "size": [0, 2, 5, 6, 9, 11, 17, 19, 21, 22, 23], "ha": [0, 1, 2, 6, 11, 13, 14, 15, 19, 22, 23], "getveclength": 0, "std": [0, 5, 12], "tupl": [0, 2, 13], "get_cpp_typesize_and_vecs": 0, "scalartyp": 0, "dtype": [0, 2, 5, 7, 8, 9, 19, 21, 23], "get_cpp_typesize_and_vecsize_kernel_impl": 0, "get_cpp_typesize_and_vecsize_kernel_fn": 0, "get_cpp_typesize_and_vecsize_kernel_stub": 0, "types": 0, "vectors": 0, "getveclengthkrnl": 0, "switch": [0, 20, 22], "case": [0, 2, 5, 11, 18, 19, 20, 21, 22, 23], "doubl": 0, "make_tupl": 0, "sizeof": 0, "vector": [0, 1, 2, 5, 11], "complexdoubl": 0, "c10": [0, 5], "complex": 0, "complexfloat": 0, "decltyp": 0, "impl": 0, "scalartypetocpptyp": 0, "half": [0, 6, 14], "torch_check": 0, "fals": [0, 2, 5, 7, 8, 9, 10, 13, 19, 20, 21, 23], "here": [0, 4, 6, 7, 8, 11, 13, 15, 19, 21, 22, 23], "three": [0, 6], "help": [0, 4, 15, 20, 22, 23], "queri": [0, 11], "max": [0, 19, 23], "binari": [0, 4, 5, 6, 7, 23], "built": [0, 6, 10, 13, 15, 23], "smaller": [0, 7], "python": [0, 1, 2, 5, 10, 13, 15, 20, 21, 22, 23], "7": [0, 13, 14, 15, 20, 21, 23], "sep": 0, "2021": [0, 20, 21], "13": [0, 17, 20, 21, 22, 23], "09": [0, 20], "58": [0, 20], "5": [0, 5, 11, 12, 13, 14, 15, 17, 19, 20, 21, 22, 23], "anaconda": 0, "inc": 0, "linux": [0, 4, 5, 15, 17, 20, 22], "copyright": [0, 16], "credit": 0, "licens": 0, "inform": [0, 1, 2, 5, 6, 11, 20, 21, 22, 23], "import": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 19, 21, 22, 23], "_c": [0, 10], "core": [0, 2, 6, 10, 15, 17, 21, 22, 23], "_get_current_isa_level": [0, 10], "_get_highest_cpu_support_isa_level": 0, "_get_highest_binary_support_isa_level": 0, "quit": 0, "By": [0, 10, 20, 22], "maximum": [0, 10], "underli": [0, 1, 10], "hardwar": [0, 1, 10, 18, 21, 23], "overridden": [0, 2, 10], "environ": [0, 2, 4, 5, 10, 13, 17, 20, 21, 22], "variabl": [0, 2, 4, 10, 17, 19, 20, 21, 22, 23], "aten_cpu_cap": [0, 10], "effect": [0, 10, 14, 21, 22], "would": [0, 4, 10, 11, 22, 23], "between": [0, 6, 7, 10, 13, 22, 23], "c": [0, 1, 6, 7, 10, 13, 20, 21, 22, 23], "print": [0, 5, 8, 10, 15, 20], "intern": [0, 10, 11, 13], "purpos": [0, 10, 22], "subject": [0, 6, 10, 13, 16, 23], "chang": [0, 2, 4, 6, 7, 9, 10, 11, 13, 19, 20], "addtion": [0, 10], "tool": [0, 10, 18, 22], "subfold": [0, 10], "test": [0, 5, 10, 23], "identif": [0, 5, 10], "gnu": [0, 5, 10, 21], "cxx": [0, 5, 10], "detect": [0, 1, 5, 10, 19, 22, 23], "abi": [0, 5, 10, 15, 23], "info": [0, 5, 10, 19, 20, 21, 23], "done": [0, 5, 10, 19, 22, 23], "work": [0, 2, 4, 5, 6, 9, 10, 13, 15, 19, 20, 22, 23], "opt": [0, 10], "rh": [0, 10], "toolset": [0, 10], "root": [0, 5, 10], "usr": [0, 5, 10, 20, 21], "bin": [0, 4, 5, 10, 20], "cc": [0, 4, 5, 10], "skip": [0, 4, 10, 11, 20], "configur": [0, 2, 5, 9, 10, 18, 20, 21, 23], "have": [0, 2, 4, 5, 6, 10, 11, 13, 14, 15, 16, 20, 21, 22, 23], "been": [0, 1, 5, 6, 10, 11, 22, 23], "written": [0, 4, 5, 10], "33": [0, 10, 20, 21], "cmakefil": [0, 10], "cpu_featur": [0, 10], "dir": [0, 10], "66": [0, 10, 20, 23], "cpu_feature_main": [0, 10], "100": [0, 10, 15, 17, 21], "link": [0, 1, 5, 10, 23], "target": [0, 4, 5, 10, 23], "xcr0": [0, 10], "00000000000602e7": [0, 10], "avx": [0, 1, 10, 15], "true": [0, 2, 5, 8, 9, 10, 20, 21, 22, 23], "mmx": [0, 10], "sse": [0, 10], "sse2": [0, 10], "sse3": [0, 10], "ssse3": [0, 10], "sse4_1": [0, 10], "sse4_2": [0, 10], "aes_ni": [0, 10], "sha": [0, 10], "xsave": [0, 10], "fma": [0, 10], "f16c": [0, 10], "avx_vnni": [0, 10], "avx512_f": [0, 10], "avx512_cd": [0, 10], "avx512_pf": [0, 10], "avx512_er": [0, 10], "avx512_vl": [0, 10], "avx512_bw": [0, 10], "avx512_dq": [0, 10], "avx512_ifma": [0, 10], "avx512_vbmi": [0, 10], "avx512_vpopcntdq": [0, 10], "avx512_4fmap": [0, 10], "avx512_4vnniw": [0, 10], "avx512_vbmi2": [0, 10], "avx512_vpclmul": [0, 10], "avx512_bitalg": [0, 10], "avx512_fp16": [0, 10], "avx512_vp2intersect": [0, 10], "amx_bf16": [0, 10], "amx_til": [0, 10], "amx_int8": [0, 10], "prefetchw": [0, 10], "prefetchwt1": [0, 10], "intel optim": 1, "intel\u00ae extension for pytorch*": 1, "extend": [1, 11, 22], "up": [1, 3, 13, 22, 23], "date": 1, "featur": [1, 4, 5, 7, 8, 11, 13, 19, 22, 23], "optim": [1, 2, 3, 5, 7, 11, 13, 14, 15, 19, 20, 21, 22, 23], "extra": [1, 2, 4, 13], "perform": [1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 14, 15, 19, 20], "boost": [1, 3, 5, 6, 14, 17, 20, 22, 23], "exampl": [1, 2, 4, 6, 7, 8, 11, 12, 14, 15, 19, 21, 22, 23], "512": [1, 5, 15, 20], "neural": [1, 6, 22], "network": [1, 6, 7, 13, 22], "advanc": [1, 6], "matrix": [1, 6, 15], "over": [1, 4, 7, 11, 23], "most": [1, 6, 8, 14, 17, 21, 22, 23], "directli": [1, 2, 5, 20, 22, 23], "stock": [1, 8, 17, 19, 23], "provid": [1, 2, 4, 5, 6, 7, 8, 13, 20, 21, 22, 23], "both": [1, 2, 5, 6, 11, 12, 14, 20, 21, 22, 23], "eager": [1, 6, 21], "mode": [1, 2, 4, 6, 11, 13, 19, 21, 23], "graph": [1, 2, 5, 7, 15, 19, 23], "howev": [1, 2, 4, 7, 13, 15, 19, 20, 22, 23], "compar": [1, 2, 6, 8, 11, 14, 19, 20, 22, 23], "normal": [1, 5, 6, 13, 15, 22, 23], "yield": [1, 6, 18, 22], "better": [1, 2, 6, 9, 11, 13, 20, 21, 22, 23], "techniqu": [1, 2], "oper": [1, 2, 7, 8, 9, 14, 15, 21, 22, 23], "fusion": [1, 2, 6, 14, 23], "amplifi": 1, "them": [1, 4, 6, 11, 12, 20, 22], "comprehens": 1, "therefor": [1, 22], "recommend": [1, 4, 5, 6, 9, 13, 15, 17, 22, 23], "take": [1, 2, 5, 6, 7, 8, 11, 14, 20, 22], "advantag": [1, 2, 5, 6, 11, 14, 20, 22], "torchscript": [1, 4, 6, 12, 21], "whenev": 1, "your": [1, 4, 5, 6, 7, 9, 13, 15, 16, 19, 23], "workload": [1, 5, 6, 7, 14, 17, 22, 23], "could": [1, 5, 6, 8, 11, 19, 22, 23], "choos": [1, 7, 13, 22, 23], "run": [1, 2, 4, 5, 6, 7, 13, 15, 17, 19, 20, 21, 22, 23], "torch": [1, 2, 5, 6, 7, 8, 9, 11, 13, 15, 19, 21, 22, 23], "jit": [1, 2, 4, 5, 6, 7, 8, 9, 11, 13, 19, 21, 23], "trace": [1, 5, 6, 7, 8, 9, 13, 19, 21, 23], "our": [1, 4, 12, 22], "evalu": [1, 2, 23], "first": [1, 2, 4, 6, 8, 12, 13, 14, 20, 21, 22], "choic": [1, 14], "found": [1, 5, 6, 11, 20, 21, 22], "org": [1, 6, 15, 23], "websit": [1, 6], "program": [1, 4, 6, 13, 20, 22, 23], "user": [1, 2, 6, 8, 9, 11, 13, 18, 19, 20, 21, 22, 23], "enabl": [1, 2, 5, 6, 7, 8, 11, 13, 20, 21, 22, 23], "dynam": [1, 13, 19, 22, 23], "intel_extension_for_pytorch": [1, 2, 4, 5, 6, 8, 9, 10, 13, 15, 20, 21, 23], "structur": [1, 11, 20], "shown": [1, 5, 11, 20, 21], "figur": [1, 14, 22], "compon": [1, 9, 16], "depict": 1, "white": 1, "box": [1, 5, 22], "while": [1, 2, 7, 11, 14, 19, 21, 22, 23], "blue": 1, "deliv": [1, 6, 23], "via": [1, 2, 4, 6, 11, 13, 17, 20, 22], "custom": [1, 6, 19, 23], "addon": 1, "overrid": [1, 9], "exist": [1, 4, 8, 15, 20, 22], "frontend": [1, 2, 6, 13], "quantiz": [1, 8, 19, 21, 23], "api": [1, 3, 9, 13, 22, 23], "further": [1, 2, 4, 5, 6, 11, 13, 18, 22, 23], "model": [1, 2, 3, 6, 7, 17, 19, 22, 23], "dispatch": [1, 23], "kernel": [1, 2, 10, 13, 17, 22, 23], "automat": [1, 2, 5, 6, 8, 9, 11, 22, 23], "isa": [1, 23], "leverag": 1, "acceler": [1, 2, 3, 5, 6, 8, 23], "unit": [1, 22], "much": [1, 9, 11, 14, 22], "possibl": [1, 2, 9, 12, 22], "comput": [1, 2, 5, 6, 8, 9, 11, 13, 14, 17, 21, 22, 23], "intens": 1, "bring": [1, 5, 6, 9, 14, 20, 22, 23], "effici": [1, 5, 12, 13, 22, 23], "finer": [1, 6, 13], "grain": [1, 6, 13], "thread": [1, 2, 5, 6, 13, 17, 19, 20, 21, 22, 23], "control": [1, 2, 6, 13, 19, 20, 22, 23], "weight": [1, 2, 5, 6, 9, 11, 13, 23], "share": [1, 4, 13, 15, 21, 22, 23], "open": [1, 22], "project": [1, 5], "github": [1, 4, 5, 6, 7, 15, 23], "none": [2, 20], "level": [2, 8, 11, 13, 14, 19, 22, 23], "o1": [2, 19, 23], "inplac": [2, 5, 8, 9, 11], "conv_bn_fold": [2, 19, 23], "weights_prepack": 2, "replace_dropout_with_ident": 2, "optimize_lstm": 2, "split_master_weight_for_bf16": 2, "fuse_update_step": 2, "auto_kernel_select": [2, 17], "sample_input": [2, 23], "appli": [2, 5, 7, 8, 11, 12, 14, 15, 19, 23], "given": [2, 8], "nn": [2, 5, 6, 7, 8, 9, 11, 13, 19, 23], "well": [2, 4, 5, 13, 14, 18, 22, 23], "option": [2, 4, 5, 9, 20, 21, 23], "train": [2, 6, 9, 11, 14, 19, 20, 21, 23], "otherwis": [2, 13, 20], "infer": [2, 3, 6, 9, 11, 13, 14, 17, 19, 21, 22, 23], "conv": [2, 7, 8, 9, 13, 19, 23], "bn": [2, 9, 19, 23], "fold": [2, 9, 19, 23], "prepack": [2, 11], "achiev": [2, 22, 23], "cach": [2, 4, 12, 13, 17, 23], "reus": [2, 22], "specif": [2, 4, 5, 6, 11, 13, 15, 19, 22, 23], "memori": [2, 5, 6, 7, 8, 12, 13, 14, 17, 19, 21, 23], "layout": [2, 5, 19, 23], "block": [2, 4, 13, 22, 23], "although": [2, 22], "calcul": [2, 7, 14], "itself": [2, 4, 11], "fast": [2, 4, 22], "enough": [2, 12], "usag": [2, 5, 7, 15, 18, 21, 22], "perspect": [2, 8, 11, 14, 20, 22], "drawback": [2, 14], "one": [2, 4, 6, 8, 11, 12, 13, 15, 19, 20, 22, 23], "sever": [2, 6, 12, 17, 18, 20, 23], "dimens": [2, 11], "fix": [2, 4, 6, 19, 23], "about": [2, 4, 8, 22, 23], "mermori": 2, "format": [2, 4, 5, 6, 22], "manual": [2, 11, 13, 15, 23], "reduc": [2, 6, 9, 12, 13, 14, 22, 23], "overhead": [2, 12, 13, 19, 22, 23], "predefin": 2, "shape": [2, 5, 6, 13, 17, 19, 22, 23], "prior": 2, "requir": [2, 4, 5, 7, 11, 14, 19, 23], "convers": [2, 7, 8, 21, 23], "go": [2, 4, 7], "through": [2, 6, 7, 15, 22, 23], "methodologi": [2, 5, 6, 12, 22], "avoid": [2, 13, 14, 19, 20, 21, 22, 23], "thu": [2, 7, 11, 13, 14, 20, 21, 22], "increas": [2, 14, 19, 22, 23], "cast": [2, 7, 14], "do": [2, 4, 7, 11, 13, 14, 19, 20, 21, 22, 23], "noth": 2, "conv2d": [2, 6, 7, 8, 11, 13, 19, 23], "linear": [2, 6, 7, 8, 9, 11, 19, 22, 23], "convtranspose2d": [2, 8], "embed": [2, 23], "lstm": [2, 9, 23], "sgd": [2, 5, 6, 7, 12], "string": 2, "o0": [2, 19, 23], "No": [2, 5, 11], "just": [2, 20], "With": [2, 6, 13, 23], "dropout": 2, "remov": [2, 4, 14, 23], "inferenc": 2, "master": [2, 6, 14], "fuse": [2, 8, 12, 21, 23], "updat": [2, 4, 12, 14, 15, 23], "step": [2, 4, 5, 7, 12, 14, 21], "explicitli": [2, 7, 13, 19, 20, 23], "bool": 2, "whether": [2, 7, 11, 20, 22], "conv_bn": 2, "knob": [2, 20], "overwrit": [2, 20], "convolut": [2, 6, 8, 13, 22, 23], "reorder": [2, 11], "replac": [2, 4, 6, 23], "ident": [2, 11], "aten": [2, 6, 23], "opportunit": 2, "save": [2, 4, 5, 8, 9, 11, 14, 20, 21, 23], "solut": 2, "doesn": [2, 9, 11, 19, 23], "param": [2, 12], "feed": [2, 11], "impact": [2, 13], "pack": [2, 13, 23], "intel": [2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 16, 17, 18, 19, 23], "extens": [2, 3, 5, 8, 10, 15, 16, 17, 18, 19, 20, 22, 23], "pytorch": [2, 3, 5, 6, 7, 8, 10, 13, 16, 17, 18, 19, 20, 22, 23], "per": [2, 9, 13, 17, 19, 20, 21, 22, 23], "heurist": [2, 13, 23], "real": [2, 9, 17], "try": [2, 4, 5, 19, 20, 22], "select": [2, 4, 5, 8, 23], "might": [2, 11, 19, 22, 23], "cost": [2, 22], "modifi": [2, 4], "accord": [2, 8, 15, 22, 23], "place": [2, 7, 22, 23], "scenario": [2, 11, 15, 22, 23], "convolutuon": 2, "counterpart": [2, 6, 11], "good": [2, 4, 6, 11, 12, 22], "pleas": [2, 5, 15, 19, 23], "invok": [2, 5, 7, 8, 13, 19, 23], "after": [2, 4, 8, 13, 14, 21, 22, 23], "load_state_dict": [2, 23], "path": [2, 11, 13, 19, 20, 22, 23], "ddp": [2, 5], "distribut": [2, 22], "deepcopi": 2, "rather": [2, 11, 15], "like": [2, 3, 4, 6, 7, 11, 12, 14, 19, 20, 22, 23], "allreduc": 2, "caus": [2, 14, 22, 23], "unpredict": 2, "accuraci": [2, 6, 7, 9, 14, 23], "loss": [2, 4, 5, 7, 11, 14], "eval": [2, 5, 7, 8, 9, 13, 19, 21, 23], "optimized_model": [2, 23], "optimized_optim": 2, "enable_onednn_fus": [2, 8], "disabl": [2, 8, 19, 20, 22, 23], "when": [2, 4, 5, 6, 7, 11, 12, 13, 14, 17, 19, 20, 21, 22, 23], "class": [2, 4, 6, 7, 13, 19, 23], "verbos": 2, "On": [2, 6, 11, 22], "demand": 2, "easier": [2, 11, 14], "debug": [2, 10], "issu": [2, 4, 7, 14, 18, 22], "dump": [2, 20], "messag": [2, 11, 15, 20], "durat": [2, 14], "dnnl_verbos": 2, "those": [2, 9, 21, 22], "larg": [2, 5, 12, 17, 19, 22, 23], "amount": [2, 22], "moreov": 2, "investig": [2, 20], "singl": [2, 8, 12, 13, 17, 21, 23], "iter": [2, 14, 23], "scope": [2, 7, 14], "out": [2, 4, 5, 7, 12, 13, 15, 22, 23], "second": [2, 22], "verbose_on": 2, "verbose_off": 2, "verbose_on_cr": 2, "creation": 2, "prepar": [2, 5, 8, 19, 23], "example_input": [2, 5, 8, 9, 23], "calibr": [2, 17, 19, 21, 23], "qconfig": [2, 5, 8, 19, 23], "observ": [2, 8, 9, 23], "activ": [2, 5, 9, 13, 20, 21, 22], "init": [2, 4, 9, 15], "state": [2, 9, 12], "insert": 2, "fake": 2, "quant": 2, "is_runtime_ext_en": 2, "helper": 2, "check": [2, 4, 5, 6, 8, 11, 15, 20, 23], "exetens": 2, "openmp": [2, 6, 13, 17, 19, 21, 23], "preload": [2, 20, 22], "cpupool": [2, 13, 23], "core_id": [2, 13, 20], "list": [2, 4, 7, 8, 11, 20, 21, 22], "node_id": [2, 13, 20, 21, 23], "abstract": [2, 13], "pool": [2, 13, 23], "intra": 2, "op": [2, 4, 9], "parallel": [2, 4, 5, 22], "id": [2, 20, 21], "numa": [2, 13, 20, 21], "node": [2, 13, 17, 21, 22, 23], "pin": [2, 13, 21], "cpu_pool": [2, 13, 23], "code": [2, 4, 6, 8, 11, 12, 14, 15, 16, 19, 22, 23], "method": [2, 7, 9, 11, 19, 22, 23], "def": [2, 7, 8, 13, 19, 23], "design": [2, 4, 7, 11, 14, 23], "context": [2, 4, 7, 13, 22], "decor": 2, "multistreammodulehint": [2, 13, 23], "arg": [2, 5, 6, 8, 12, 20, 21], "kwarg": 2, "hint": [2, 13], "multistreammodul": [2, 6, 13, 19, 23], "concat": [2, 13, 19, 23], "output": [2, 5, 6, 7, 8, 11, 19, 23], "argument": 2, "should": [2, 4, 5, 7, 9, 13, 18, 20, 22], "along": [2, 4, 14, 22, 23], "dim": [2, 11], "length": [2, 4, 14, 19, 23], "arbitrari": 2, "keyword": 2, "num_stream": [2, 13, 23], "union": 2, "str": [2, 20], "concat_output": 2, "input_split_hint": [2, 13], "multi_stream": 2, "output_concat_hint": [2, 13], "multi": [2, 6, 13, 19, 20, 21, 22, 23], "stream": [2, 6, 13, 19, 23], "throughput": [2, 11, 13, 17, 19, 23], "number": [2, 4, 6, 12, 13, 14, 19, 21, 23], "insid": [2, 4, 13], "divis": [2, 13], "alloc": [2, 13, 17, 21, 23], "equal": [2, 9, 13, 22], "remaind": [2, 13], "n": [2, 5, 6, 11, 12, 13, 19, 21, 22, 23], "suggest": [2, 9, 11, 13, 22, 23], "divisor": [2, 13], "batchsiz": [2, 13], "larger": [2, 13, 22], "piec": [2, 13], "less": [2, 7, 11, 13], "": [2, 3, 4, 7, 9, 11, 12, 13, 14, 15, 19, 21, 22], "mini": [2, 13, 19, 23], "batch": [2, 6, 11, 13, 17, 19, 21, 23], "tune": [2, 7, 9, 13, 20, 21, 23], "num": [2, 13, 19, 21, 22, 23], "leav": [2, 13, 22], "scriptmodul": [2, 8, 13], "instanc": [2, 6, 21, 23], "usual": [2, 11, 13, 21, 22], "reason": [2, 11, 13, 23], "still": [2, 4, 6, 7, 8, 11, 14, 15, 18, 19, 23], "indic": [2, 11], "concaten": [2, 14], "raw": 2, "task": [2, 6, 19, 22, 23], "schedul": [2, 8, 13, 22], "asynchron": [2, 6], "get_core_list_of_node_id": 2, "facebook": 3, "3rd": [3, 6, 14, 17, 23], "gen": [3, 23], "xeon": [3, 6, 14, 15, 17, 21, 22, 23], "processor": [3, 6, 12, 14, 15, 17, 22, 23], "deep": [3, 7, 8, 14, 22], "learn": [3, 7, 8, 14, 20, 22], "technologi": 3, "mention": [3, 13, 14, 23], "deprec": 3, "scale": [3, 9], "bert": [3, 17, 23], "modern": 3, "cpu": [3, 4, 5, 6, 7, 9, 12, 13, 15, 17, 20, 21, 23], "part": [3, 4, 6, 7, 11, 14, 19, 22, 23], "launcher": [3, 8, 20, 22, 23], "kt": 3, "person": 3, "text": [3, 17, 22], "speech": [3, 22], "thank": 4, "interest": 4, "begin": 4, "intent": 4, "team": 4, "propos": [4, 11, 14], "implement": [4, 6, 12, 19, 22, 23], "post": [4, 9, 23], "intend": 4, "shall": [4, 11], "discuss": [4, 6, 11, 22], "agre": 4, "plan": 4, "look": [4, 5, 11], "ahead": 4, "bug": [4, 23], "outstand": 4, "search": [4, 20], "pick": 4, "d": [4, 5, 6, 7, 19, 23], "particular": [4, 7, 23], "ask": 4, "submit": [4, 6, 13], "pull": [4, 15], "request": [4, 13, 21], "http": [4, 15, 23], "com": [4, 15, 23], "full": [4, 11, 15, 21, 22, 23], "instal": [4, 5, 22, 23], "uninstal": 4, "pip": [4, 15, 23], "ll": [4, 22], "know": 4, "see": [4, 7, 15, 23], "warn": [4, 20, 21], "few": [4, 5, 6, 8, 11], "alwai": [4, 7, 11, 20, 22], "timeout": [4, 14], "loop": [4, 14], "re": [4, 7, 22], "feel": [4, 11, 23], "lazi": 4, "ye": 4, "clone": [4, 15], "git": [4, 15], "cd": [4, 15], "alreadi": [4, 5, 11, 22], "rebas": [4, 23], "submodul": [4, 15], "sync": [4, 13, 15], "recurs": [4, 15], "job": 4, "increment": 4, "rebuild": 4, "section": [4, 7, 13, 21, 22, 23], "below": [4, 5, 7, 12, 13, 14, 15, 19, 20, 21, 22, 23], "titl": 4, "setup": [4, 15, 23], "py": [4, 13, 15, 20, 21], "symlink": 4, "tree": 4, "reinstal": 4, "again": [4, 12], "especi": 4, "__init__": [4, 7, 13, 19, 23], "repeatedli": 4, "interfac": [4, 5, 11], "pyi": 4, "non": [4, 7, 8, 11, 21, 23], "cpp": [4, 5, 10, 22], "cu": 4, "h": [4, 5, 6, 11, 21], "sure": [4, 5, 9, 15, 21], "until": [4, 13, 14, 22], "next": [4, 6, 23], "clean": 4, "maco": 4, "homebrew": 4, "brew": 4, "6": [4, 6, 13, 15, 20, 21, 22, 23], "error": [4, 5, 11, 14, 19, 23], "printf": 4, "stdio": 4, "nint": 4, "main": [4, 5, 13, 20], "hello": 4, "world": 4, "clang": 4, "compil": [4, 5, 19, 22, 23], "simpl": [4, 6, 7, 11, 19, 22, 23], "without": [4, 7, 13, 14, 21, 23], "directori": [4, 20, 21], "folder": 4, "mani": [4, 20, 22], "wai": [4, 11], "rm": [4, 15], "rf": 4, "toplevel": 4, "start": [4, 5, 13, 15], "made": [4, 23], "edit": [4, 19, 23], "repo": [4, 5, 6], "commit": 4, "keep": [4, 11, 14, 22], "command": [4, 5, 15, 20, 21, 22], "realli": 4, "untrack": 4, "deinit": 4, "f": [4, 15, 23], "xdf": 4, "veri": [4, 9, 11], "within": [4, 14, 22], "experi": [4, 11, 22, 23], "env_key1": 4, "env_val1": 4, "env_key2": 4, "env_val2": 4, "suit": 4, "test_": 4, "individu": 4, "filenam": 4, "where": [4, 6, 14, 22], "repres": [4, 6, 14], "wish": [4, 6], "test_jit": 4, "narrow": 4, "down": [4, 19, 23], "what": [4, 7], "even": [4, 22], "specifi": [4, 13, 20, 21, 22, 23], "testclassnam": 4, "testnam": 4, "let": [4, 11, 12, 13, 14], "sai": 4, "test_sequenti": 4, "testjit": 4, "expecttest": 4, "hypothesi": 4, "mypi": 4, "packag": [4, 6, 15, 21, 22, 23], "conda": [4, 15, 22], "offici": [4, 15, 21, 22, 23], "unittest": 4, "offer": [4, 22], "substr": 4, "k": 4, "test_nn": 4, "v": 4, "abov": [4, 12, 15, 20, 21], "testnn": 4, "test_bceloss": 4, "test_mseloss": 4, "keystrok": 4, "ci": 4, "quicklint": 4, "These": [4, 6, 7, 8], "aren": 4, "setup_lint": 4, "makefil": 4, "complet": [4, 11, 22], "tab": 4, "trail": [4, 14], "newlin": 4, "quick_check": 4, "flake8": 4, "cmakelint": 4, "tidi": 4, "add": [4, 7, 8, 10, 12, 14, 19, 20, 21, 23], "changed_onli": 4, "googl": [4, 5], "framework": 4, "runner": 4, "gtest_filt": 4, "testsuit": 4, "maycontainalia": 4, "containeraliasingtest": 4, "test_alias_analysi": 4, "style": 4, "docstr": 4, "line": [4, 5, 8, 11, 20, 21, 22], "limit": [4, 5, 7, 13, 19, 21, 22, 23], "80": [4, 17, 20], "charact": 4, "fit": [4, 22], "jupyt": 4, "popup": 4, "prerequisit": 4, "doc": 4, "r": [4, 6, 17, 21, 22], "txt": [4, 5, 21], "html": 4, "_build": 4, "rst": 4, "live": 4, "tutori": [4, 5, 9, 18, 23], "autofunct": 4, "autoclass": 4, "direct": [4, 8], "shorten": 4, "index": [4, 11, 22], "sphinx": 4, "produc": [4, 7], "miss": 4, "There": [5, 13, 22], "channels_last": [5, 6, 11, 21, 22], "rais": 5, "resourc": [5, 8, 13, 18, 21, 22], "against": 5, "memory_format": [5, 11, 21], "criterion": [5, 7], "improv": [5, 6, 7, 8, 13, 17, 21, 22], "4d": 5, "zero_grad": 5, "torchvis": [5, 8, 11, 21, 23], "lr": [5, 7, 12], "001": [5, 7], "download": [5, 15], "dataset": [5, 17, 22, 23], "cifar10": 5, "transform": [5, 11, 21, 22, 23], "compos": 5, "resiz": 5, "224": [5, 7, 8, 17, 21, 23], "totensor": 5, "train_dataset": 5, "train_load": [5, 7], "util": [5, 6, 9, 11, 14, 19, 22, 23], "dataload": [5, 13], "batch_siz": [5, 8, 11], "128": [5, 7, 13, 17, 23], "crossentropyloss": 5, "momentum": [5, 14], "batch_idx": 5, "enumer": 5, "backward": [5, 7, 14, 23], "model_state_dict": 5, "state_dict": 5, "optimizer_state_dict": 5, "checkpoint": 5, "pth": 5, "amp": [5, 19, 23], "autocast": [5, 23], "oneapi": [5, 22], "collect": [5, 21, 22, 23], "commun": [5, 21, 22, 23], "bind": [5, 6, 22, 23], "oneccl": [5, 23], "dist": 5, "oneccl_bindings_for_pytorch": 5, "torch_ccl": 5, "master_addr": 5, "127": [5, 23], "master_port": 5, "29500": 5, "rank": 5, "pmi_rank": 5, "world_siz": 5, "pmi_siz": 5, "init_process_group": 5, "ccl": [5, 23], "init_method": 5, "env": 5, "distributeddataparallel": 5, "batch_id": 5, "channel": [5, 9, 15, 23], "last": [5, 14, 23], "friendli": [5, 22], "architectur": [5, 17, 22], "vision": [5, 17], "nlp": [5, 6, 17, 19, 23], "pretrain": [5, 8, 21, 23], "rand": [5, 7, 13, 19, 23], "no_grad": [5, 8, 9, 13, 19, 21, 23], "bertmodel": 5, "from_pretrain": [5, 21], "model_nam": 5, "vocab_s": 5, "config": [5, 21], "seq_length": 5, "randint": 5, "freez": [5, 7, 8, 9, 13, 19, 23], "check_trac": [5, 8], "strict": 5, "also": [5, 6, 8, 11, 12, 15, 22, 23], "mix": [5, 8, 19, 23], "precis": [5, 8, 14, 17, 19, 23], "12": [5, 10, 15, 17, 20, 21], "instanti": 5, "ao": [5, 9], "dure": [5, 8, 14, 22], "pt": [5, 8, 9, 15, 21, 23], "default_static_qconfig": [5, 8, 9, 23], "altern": [5, 11, 15], "own": [5, 9], "minmaxobserv": [5, 9], "perchannelminmaxobserv": [5, 9], "with_arg": [5, 9], "qscheme": [5, 9, 21, 23], "per_tensor_affin": [5, 9, 21, 23], "quint8": [5, 9], "qint8": [5, 9], "per_channel_symmetr": [5, 9], "prepared_model": [5, 8, 9, 19, 23], "calibration_data_load": [5, 8], "converted_model": [5, 19, 23], "traced_model": [5, 8, 9, 19, 23], "quantized_model": [5, 8, 9, 23], "dynamic_qconfig": [5, 9], "default_dynamic_qconfig": [5, 9], "placeholderobserv": [5, 9], "compute_dtyp": [5, 9], "local": [5, 13, 15, 20, 21, 22], "quantization_model": 5, "prototyp": [5, 19, 23], "topologi": [5, 6, 11, 12, 17, 19, 20, 22, 23], "verifi": 5, "roberta": [5, 23], "xlm": 5, "electra": 5, "discrimin": 5, "libtorch": [5, 15, 23], "suppos": [5, 22], "handl": [5, 11, 22], "servic": [5, 22], "regular": [5, 14], "develop": [5, 15, 22, 23], "unlik": 5, "except": [5, 20], "app": [5, 23], "iostream": 5, "argc": 5, "char": 5, "argv": 5, "catch": 5, "cerr": 5, "ivalu": 5, "push_back": 5, "memoryformat": 5, "channelslast": 5, "forward": [5, 7, 8, 13, 14, 19, 21, 22, 23], "cmakelist": 5, "cmake_minimum_requir": 5, "fatal_error": 5, "find_packag": 5, "intel_ext_pt_cpu": 5, "add_execut": 5, "target_link_librari": 5, "torch_librari": 5, "set_properti": 5, "properti": [5, 21], "cxx_standard": 5, "14": [5, 20, 21, 23], "dcmake_prefix_path": 5, "libpytorch_path": 5, "ext": [5, 15, 23], "had": [5, 22], "ldd": 5, "workspac": 5, "pthread": [5, 13], "cmake_have_libc_pthread": 5, "fail": [5, 23], "pthread_creat": 5, "lib": [5, 20, 21], "build": [5, 22, 23], "0x00007f3cf98e0000": 5, "libc10": 5, "0x00007f3cf985a000": 5, "libintel": [5, 15, 23], "0x00007f3cf70fc000": 5, "libtorch_cpu": 5, "0x00007f3ce16ac000": 5, "libdnnl_graph": 5, "0x00007f3cde954000": 5, "engin": [5, 11, 22], "bunch": 5, "benchmark": [5, 19, 23], "page": [5, 8, 13, 17, 18, 22, 23], "benefit": [5, 7, 13, 14, 21, 22, 23], "simpli": 5, "scipt": 5, "two": [6, 13, 14, 21, 22, 23], "claus": [6, 12], "ad": [6, 22, 23], "intel_pytorch_extens": [6, 19, 23], "later": [6, 21, 22], "correct": [6, 11, 15], "topic": 6, "summar": 6, "rest": [6, 21], "adapt": 6, "nchw": [6, 22], "nhwc": [6, 22, 23], "kei": [6, 23], "though": 6, "accept": [6, 23], "merg": [6, 19, 23], "branch": 6, "yet": [6, 19, 23], "low": [6, 14, 19, 22, 23], "scalabl": [6, 14, 15, 17, 22, 23], "aka": [6, 11], "cooper": [6, 17, 23], "lake": [6, 17, 23], "partial": 6, "upstream": [6, 11, 23], "land": 6, "pr": [6, 11, 19, 23], "being": [6, 22], "review": [6, 19, 23], "conduct": 6, "platform": [6, 11, 21, 22, 23], "transpar": [6, 22], "frequent": 6, "pattern": [6, 11, 23], "relu": [6, 8, 11, 19, 23], "sinc": [6, 11, 12, 13, 14, 19, 22, 23], "registr": 6, "popular": [6, 17], "roialign": [6, 23], "nm": [6, 23], "cnn": [6, 11, 17, 22, 23], "frozenbatchnorm2d": 6, "num_featur": 6, "ep": [6, 12], "1e": 6, "05": [6, 17, 20], "batchnorm2d": [6, 19, 23], "statist": 6, "affin": [6, 9, 13, 20, 21, 22], "expect": [6, 17, 23], "w": [6, 11, 14, 17, 21], "interact": [6, 23], "beyond": 6, "kind": 6, "gender": 6, "hobbi": 6, "dlrm": [6, 17, 19, 23], "now": [6, 9, 11, 22, 23], "dot": [6, 11], "product": [6, 17, 23], "man": [6, 22], "plai": [6, 22], "footbal": 6, "b": [6, 7], "splitsgd": [6, 14], "footprint": [6, 14, 23], "spawn": [6, 13], "experiment": [6, 8, 13, 21, 23], "stage": [6, 12, 13, 22, 23], "descript": [6, 11, 13, 22, 23], "recip": [6, 8, 9, 23], "dl": 6, "conveni": [7, 23], "point": [7, 9, 14, 22, 23], "float16": 7, "lighter": 7, "sacrif": 7, "trade": [7, 17], "off": [7, 14, 17], "slower": [7, 22, 23], "accur": 7, "faster": [7, 17, 22], "autom": [7, 20, 21, 23], "primarili": [7, 23], "speedup": [7, 23], "simplenet": [7, 23], "self": [7, 13, 19, 23], "super": [7, 13, 19, 23], "64": [7, 13, 17, 20, 23], "stride": [7, 13, 23], "pad": [7, 13, 23], "bia": [7, 13, 23], "y": [7, 9, 13, 14, 23], "manag": [7, 8, 13], "allow": [7, 22], "maintain": 7, "categori": [7, 15], "under": [7, 11, 13, 16, 20, 23], "circumst": 7, "imag": [7, 8, 11, 15, 19, 22, 23], "label": 7, "float64": 7, "variant": 7, "suppli": 7, "addmm": 7, "addmm_": 7, "cannot": [7, 12, 19, 23], "stabil": [7, 23], "describ": [7, 8, 11, 14, 22], "thei": [7, 20, 22], "expos": 7, "regardless": [7, 23], "unlist": 7, "downstream": 7, "assum": [7, 22, 23], "numer": [7, 22], "stabl": [7, 15, 23], "believ": [7, 11], "unstabl": 7, "conv1d": [7, 8], "conv3d": [7, 8, 23], "bmm": [7, 23], "mm": 7, "baddbmm": 7, "addbmm": 7, "matmul": [7, 8, 19, 23], "conv_tbc": 7, "group_norm": 7, "_native_multi_head_attent": 7, "conv_transpose1d": 7, "conv_transpose2d": 7, "conv_transpose3d": 7, "mish": [7, 8], "avg_pool3d": 7, "binary_cross_entropi": 7, "grid_sampl": 7, "polar": 7, "prod": 7, "quantil": 7, "nanquantil": 7, "stft": 7, "cdist": 7, "view_as_complex": 7, "choleski": 7, "cholesky_invers": 7, "cholesky_solv": 7, "invers": 7, "lu_solv": 7, "matrix_rank": 7, "orgqr": 7, "ormqr": 7, "pinvers": 7, "max_pool3d": 7, "max_unpool2d": 7, "max_unpool3d": 7, "adaptive_avg_pool3d": 7, "reflection_pad1d": 7, "reflection_pad2d": 7, "replication_pad1d": 7, "replication_pad2d": 7, "replication_pad3d": 7, "mse_loss": 7, "ctc_loss": 7, "kl_div": 7, "multilabel_margin_loss": 7, "fft_fft": 7, "fft_ifft": 7, "fft_fft2": 7, "fft_ifft2": 7, "fft_fftn": 7, "fft_ifftn": 7, "fft_rfft": 7, "fft_irfft": 7, "fft_rfft2": 7, "fft_irfft2": 7, "fft_rfftn": 7, "fft_irfftn": 7, "fft_hfft": 7, "fft_ihfft": 7, "linalg_matrix_norm": 7, "linalg_cond": 7, "linalg_matrix_rank": 7, "linalg_solv": 7, "linalg_choleski": 7, "linalg_svdv": 7, "linalg_eigv": 7, "linalg_eigvalsh": 7, "linalg_inv": 7, "linalg_householder_product": 7, "linalg_tensorinv": 7, "linalg_tensorsolv": 7, "fake_quantize_per_tensor_affin": 7, "eig": 7, "geqrf": 7, "lstsq": 7, "_lu_with_info": 7, "qr": 7, "svd": 7, "symeig": 7, "triangular_solv": 7, "fractional_max_pool2d": 7, "fractional_max_pool3d": 7, "adaptive_max_pool3d": 7, "multilabel_margin_loss_forward": 7, "linalg_qr": 7, "linalg_cholesky_ex": 7, "linalg_svd": 7, "linalg_eig": 7, "linalg_eigh": 7, "linalg_lstsq": 7, "linalg_inv_ex": 7, "cat": [7, 20, 21, 23], "stack": 7, "index_copi": 7, "intervent": 7, "mixtur": [7, 23], "dag": 8, "acycl": 8, "straight": [8, 22], "algorithm": [8, 11, 17, 23], "cover": [8, 11, 20], "constant": 8, "focus": [8, 23], "__dict__": 8, "resnet50": [8, 11, 17, 20, 22, 23], "front": [8, 23], "end": [8, 13, 23], "float32": [8, 14, 17, 19, 23], "randn": [8, 11, 21, 23], "propag": [8, 14], "graph_for": 8, "regard": 8, "rn50": [8, 23], "sum": [8, 11, 12, 23], "convrelu": 8, "convsumrelu": 8, "flow": [8, 19], "mymodel": [8, 23], "construct": 8, "user_model": [8, 9], "convert_model": [8, 9], "deploy": [8, 15, 23], "convtranspose3d": 8, "ab": [8, 21], "clamp": 8, "elu": 8, "exp": 8, "gelu": [8, 23], "hardtanh": 8, "hardswish": [8, 23], "log": [8, 20, 21, 23], "sigmoid": [8, 23], "pow": 8, "round": [8, 14], "sqrt": [8, 12], "squar": 8, "tanh": [8, 23], "leaki": 8, "silu": 8, "mul": 8, "layernorm": [8, 23], "div": 8, "softmax": [8, 23], "view": [8, 11, 13, 14], "transpos": [8, 23], "contigu": [8, 11, 21, 22], "conf": [8, 20, 21, 23], "dequant": 8, "partit": [8, 22], "leaky_relu": 8, "___": 8, "divid": [8, 19, 22, 23], "maxpool2d": 8, "_____": 8, "owner": 8, "doe": [8, 11, 13, 23], "otheriws": 8, "compuat": 8, "wikipedia": [8, 22], "introduc": [9, 11, 14, 20, 22, 23], "side": [9, 22], "abl": 9, "easili": 9, "decid": [9, 13], "satisfi": [9, 18], "tradeoff": 9, "histogramobserv": 9, "reduce_rang": 9, "methond": 9, "obsev": 9, "prefer": 9, "symmetr": 9, "devic": [9, 23], "sete": 9, "rang": [9, 12, 14, 19, 21, 23], "skylak": 9, "quant_stat": 9, "calibration_data_set": [9, 23], "qparam": 9, "json": [9, 21, 23], "zero": 9, "And": [9, 13], "achang": 9, "save_qconf_summari": 9, "qconf_summari": 9, "load_qconf_summari": 9, "per_tensor_symmetr": [9, 21], "seet": 9, "gru": 9, "lstmcell": 9, "rnncell": 9, "grucel": 9, "avx2_vnni": 10, "impli": 10, "csrc": 10, "represent": 11, "multidimension": 11, "arrai": 11, "nd": 11, "1d": 11, "address": [11, 22], "space": [11, 22], "semant": 11, "dens": 11, "spars": [11, 19, 23], "attribut": 11, "coo": 11, "canon": 11, "assign": [11, 22], "2d": 11, "height": 11, "illustr": [11, 12, 14, 20, 22], "actual": [11, 14], "bmp": 11, "contiguous_format": [11, 22], "tensorflow": 11, "ih": 11, "close": [11, 22], "to_mkldnn": 11, "difficult": 11, "manipul": 11, "to_dens": 11, "natur": [11, 14], "Will": 11, "hold": [11, 22], "secret": 11, "ingredi": 11, "almost": 11, "foundat": [11, 22], "upper": [11, 22], "One": [11, 12, 20, 22], "fact": [11, 22], "expens": 11, "sequenc": [11, 14, 19, 23], "benefici": 11, "nb": 11, "me": 11, "roughli": 11, "50": [11, 20, 21], "perf": 11, "32": [11, 14, 20, 21], "20": [11, 20, 21, 23], "map": [11, 15, 17], "mkldnn": 11, "mkldnn_util": 11, "subsequ": [11, 22], "concept": [11, 22], "diagram": [11, 22], "hard": 11, "conclus": 11, "necessari": 11, "minimum": 11, "neglig": 11, "move": [11, 22], "organ": 11, "focu": 11, "question": [11, 17], "reinterpret": 11, "access": [11, 12, 21], "element": [11, 12], "answer": [11, 17], "chw": 11, "hw": 11, "offset": 11, "stride_n": 11, "stride_c": 11, "stride_h": 11, "stride_w": 11, "merit": 11, "express": [11, 23], "noncontigu": 11, "slice": 11, "big": 11, "n1": 11, "n2": 11, "mind": 11, "someth": 11, "reli": [11, 13], "principl": 11, "rfc": 11, "logic": [11, 21, 22], "previou": [11, 22, 23], "hwc": 11, "wc": 11, "long": [11, 14, 19, 21, 23], "4": [11, 13, 17, 20, 22, 23], "chwn": 11, "hwn": 11, "wn": 11, "empti": 11, "outplac": [11, 23], "is_contigu": 11, "_appli": 11, "brief": [11, 23], "imagenet": [11, 17], "gpu": [11, 23], "spontan": 11, "tell": [11, 13, 22], "NOT": [11, 20], "compris": 11, "result": [11, 13, 14, 19, 20, 21, 22], "explicit": [11, 13, 22], "implicit": 11, "meta": 11, "tensoriter": 11, "guidelin": 11, "awar": [11, 13, 20, 21], "repeat": [11, 14], "my": 11, "recent": 11, "upsampl": [11, 23], "demonstr": 11, "eas": [11, 23], "cudnn": 11, "accommod": 11, "hidden": 11, "md": 11, "format_tag": 11, "src_md": 11, "desc": 11, "data_typ": 11, "src_mem": 11, "src_data_ptr": 11, "card": 11, "hwio": 11, "gemm": [11, 19], "resnext101": [11, 23], "detectron2": 11, "8x": 11, "latenc": [11, 21], "integr": [11, 19, 22, 23], "As": [12, 13, 20, 22, 23], "lamb": [12, 14], "adagrad": [12, 14], "weight_decai": 12, "grad": 12, "alpha": 12, "clr": 12, "lr_decai": 12, "state_sum": 12, "addcmul_": 12, "add_": 12, "addcdiv_": 12, "problem": [12, 22], "whole": [12, 13], "storag": 12, "onboard": [12, 22], "third": [12, 23], "read": 12, "instead": [12, 13, 22, 23], "high": [12, 14, 22], "speed": [12, 22, 23], "bound": [12, 13, 22], "bottl": 12, "neck": 12, "prevent": 12, "solv": [12, 22], "pseudo": [12, 14, 23], "wise": 12, "adagrad_fused_step": 12, "separ": [12, 16, 22], "group": [12, 13, 22], "ensur": [12, 13, 21], "small": [12, 22], "process": [12, 13, 14, 20, 22], "grad0": 12, "grad1": 12, "grad_n": 12, "param_n": 12, "state_sum_n": 12, "adagrad_step": 12, "grad_i": 12, "param_i": 12, "state_sum_i": 12, "other_arg": 12, "coupl": [13, 22], "omp": [13, 19, 21, 22, 23], "applic": [13, 22], "ld_preload": [13, 20, 21, 22], "libiomp5": [13, 20, 21, 22], "model_script": 13, "creat": [13, 22, 23], "examplenet": 13, "examplenet1": 13, "x1": 13, "flatten": 13, "start_dim": 13, "examplenet2": 13, "conv2": 13, "x2": 13, "y1": 13, "y2": 13, "model1": 13, "traced_model1": 13, "model2": 13, "traced_model2": 13, "multi_stream_model": [13, 23], "datatyp": 13, "receipt": 13, "steam": [13, 23], "input_hint": 13, "output_hint": 13, "motiv": 13, "finish": 13, "layer": 13, "async": [13, 23], "wake": 13, "synchron": [13, 19, 23], "receip": 13, "imper": [13, 23], "suffer": 13, "gil": 13, "togeth": [13, 22], "hurt": 13, "quick": 13, "primit": [13, 17, 23], "mitig": [13, 17], "omp_num_thread": [13, 19, 20, 21, 23], "phase": 13, "launch": [13, 18, 21, 23], "s1": 13, "c1": 13, "numactl": [13, 20, 21], "outsid": 13, "m": [13, 15, 19, 20, 22, 23], "superset": 13, "behavior": [13, 20, 22], "undefin": 13, "global": 13, "gb": 13, "simultan": 13, "correspond": [13, 15, 23], "cpu_pool1": 13, "cpu_pool2": 13, "task1": 13, "task2": 13, "y1_futur": 13, "y2_futur": 13, "physic": [13, 21, 22], "y_runtim": 13, "kmp_": 13, "fulfil": 13, "initi": 13, "worker": [13, 20], "serv": [13, 23], "sub": [13, 22], "wait": [13, 22], "futuretensor": 13, "fine": [13, 20, 21, 22], "didn": 13, "dlopen": 13, "symbol": 13, "top": [14, 23], "bottom": 14, "bit": 14, "sign": 14, "expon": 14, "mantissa": 14, "23": [14, 20, 21], "capac": [14, 17, 22], "digit": 14, "shorter": 14, "fewer": 14, "neg": 14, "disadvantag": 14, "shift": 14, "left": 14, "right": 14, "lose": 14, "decim": 14, "valid": [14, 23], "1234500000": 14, "0000012345": 14, "1234512345": 14, "sens": 14, "fraction": 14, "12345": 14, "00000": 14, "signific": 14, "bui": 14, "basic": [14, 22], "involv": 14, "ground": 14, "truth": 14, "chain": 14, "rule": [14, 23], "meet": [14, 22], "wide": [14, 23], "easi": [14, 18], "understand": [14, 22], "formula": 14, "\u03b1": 14, "gw": 14, "denot": 14, "receiv": 14, "rate": 14, "earlier": [14, 15], "inaccur": 14, "practic": [14, 22], "idea": [14, 22], "exactli": 14, "kept": 14, "halv": 14, "recov": 14, "fp32_w": 14, "concat_fp32_from_bf16": 14, "bf16_w": 14, "fp32_gw": 14, "bf16_gw": 14, "weight_dacai": 14, "split_bf16_from_fp32": 14, "content": 15, "cento": [15, 17], "rhel": 15, "8": [15, 17, 20, 21, 22], "rocki": 15, "ubuntu": [15, 17], "newer": [15, 22], "18": [15, 17, 20, 21], "04": [15, 17, 20], "prebuilt": 15, "famili": [15, 22], "formerli": [15, 17, 22, 23], "broadwel": 15, "highli": [15, 22], "properli": [15, 20], "relationship": 15, "v1": [15, 23], "rc3": [15, 23], "patch": [15, 23], "300": 15, "200": 15, "latest": 15, "whl": [15, 23], "pre": [15, 23], "dev": 15, "package_nam": 15, "version_nam": 15, "checkout": 15, "docker_buildkit": 15, "__version__": 15, "cxx11": [15, 23], "dep": [15, 23], "2bcpu": 15, "zip": [15, 23], "bash": 15, "libtorch_path": 15, "alon": 15, "unzip": 15, "apach": [16, 21], "softwar": [16, 23], "notic": [16, 21], "term": 16, "condit": 16, "workload1": 17, "inference2": 17, "realtim": 17, "inference3": 17, "tunabl": [17, 21], "ratio": [17, 23], "platinum": [17, 21, 22], "8380": 17, "30ghz": 17, "83x": 17, "44x": 17, "ssd": [17, 23], "resnet34": [17, 23], "16x": 17, "coco": 17, "1200": 17, "resnext": 17, "32x16d": 17, "81x": 17, "21x": 17, "vgg": 17, "75x": 17, "19x": 17, "shufflenetv2_x1": 17, "07x": 17, "47x": 17, "78x": 17, "04x": 17, "squad": 17, "max_seq_len": 17, "384task": 17, "jemalloc": [17, 21, 23], "05x": 17, "96x": 17, "mrpc": 17, "128task": 17, "classif": 17, "distilbert": 17, "12x": 17, "57x": 17, "zoo": 17, "socket": [17, 21, 22, 23], "measur": [17, 23], "dnnl": 17, "1024": [17, 22], "metric": 17, "base_text_classif": 17, "f1": 17, "81": [17, 20], "99": [17, 23], "79": [17, 20], "93": 17, "02": [17, 21], "85": [17, 20], "86": [17, 20], "84": [17, 20, 22], "19": [17, 20, 21, 23], "top1": 17, "76": [17, 20], "75": [17, 20], "98": 17, "78": [17, 20], "17": [17, 20, 21], "199": 17, "48": [17, 20, 21], "vgg11": 17, "69": [17, 20], "67": [17, 20, 23], "96": 17, "44": [17, 20, 21], "36": [17, 20, 21], "92": 17, "97": 17, "shufflenet": 17, "histogram": [17, 23], "40": [17, 20, 21, 23], "ucod": 17, "0xd0002a0": 17, "hyper": [17, 22], "ON": 17, "turboboost": 17, "bio": 17, "ddr": 17, "slot": 17, "16gb": 17, "frequenc": 17, "3200": 17, "total": [17, 22], "dcpmm": 17, "256gb": 17, "host": 17, "2105": 17, "305": 17, "el8_4": 17, "x86_64": 17, "docker": [17, 23], "lt": 17, "spectr": 17, "meltdown": 17, "24x": 17, "31x": 17, "15x": 17, "30x": 17, "mobilenet": 17, "v2": 17, "08x": 17, "03x": 17, "seq_len": 17, "exce": [17, 19, 22, 23], "09x": 17, "39x": 17, "35x": 17, "160": 17, "55x": 17, "06x": 17, "fpn": 17, "71x": 17, "20x": 17, "13x": 17, "32x": 17, "48x": 17, "11x": 17, "terabyt": 17, "14x": 17, "02x": 17, "10x": 17, "33x": 17, "8380h": 17, "90ghz": 17, "56": [17, 20, 21, 22], "67x": 17, "45x": 17, "112": [17, 19, 22, 23], "77x": 17, "18x": 17, "28": [17, 20, 21, 22, 23], "0x700001c": 17, "wlydcrb1": 17, "sy": 17, "0016": 17, "p29": 17, "2006080250": 17, "64gb": 17, "768gb": 17, "squeez": 18, "introduct": [18, 22], "torchserv": 18, "known": 18, "embeddingbag": [19, 23], "bag": [19, 23], "progress": [19, 23], "illeg": 19, "runtimeerror": [19, 23], "overflow": [19, 23], "unpack": [19, 23], "min": [19, 23], "gain": [19, 23], "incorrect": [19, 23], "find": [19, 20, 23], "pseudocod": [19, 23], "workaround": [19, 23], "threa": [19, 23], "regress": [19, 23], "set_num_thread": [19, 23], "freezed_model": [19, 23], "run_benchmark": [19, 23], "abnorm": [19, 23], "poor": [19, 23], "rnnt": [19, 23], "joint": [19, 23], "net": [19, 23], "joint_net": [19, 23], "caller": [19, 23], "slow": [19, 23], "equival": [19, 23], "pend": [19, 23], "__name__": [19, 23], "__main__": [19, 20, 21, 23], "fx": [19, 21, 23], "factor": 20, "influenc": [20, 22], "contribut": 20, "unifi": 20, "combin": [20, 23], "themselv": 20, "free": [20, 23], "complic": [20, 22], "mainli": 20, "around": 20, "your_pytorch_script": 20, "interpret": 20, "no_python": 20, "prepend": 20, "exec": 20, "ninstanc": [20, 21], "give": [20, 21], "instance_idx": [20, 21], "among": [20, 21, 22], "independ": [20, 21], "ncore_per_inst": 20, "skip_cross_node_cor": 20, "cross": [20, 21, 22], "latency_mod": 20, "throughput_mod": 20, "use_logical_cor": [20, 21], "disable_numactl": [20, 21], "disable_taskset": 20, "taskset": 20, "core_list": 20, "log_path": 20, "log_file_prefix": 20, "prefix": 20, "disable_iomp": [20, 21], "enable_tcmalloc": [20, 21], "enable_jemalloc": [20, 21], "use_default_alloc": [20, 21], "exclus": 20, "either": 20, "mutual": 20, "respect": [20, 23], "ld": [20, 22], "favorit": 20, "certain": [20, 22], "kmp": [20, 22], "granular": [20, 21, 22], "compact": [20, 21, 22], "export": [20, 22], "stdout": 20, "afterward": [20, 22], "undesir": 20, "absolut": 20, "rel": 20, "_timestamp_inst": 20, "wa": [20, 21, 22, 23], "anoth": [20, 22, 23], "_timestamp_instance_n_cor": 20, "run_20210712212258_inst": 20, "run_20210712212258_instance_0_cores_0": 20, "43": [20, 21], "gif": 20, "were": [20, 21, 22], "07": 20, "21": [20, 21], "22": [20, 21], "764": 20, "conda_prefix": [20, 21], "virtual_env": [20, 21], "lib64": [20, 21], "home": [20, 21], "drop": [20, 21], "kmp_affin": [20, 21, 22], "kmp_blocktim": [20, 21, 22], "24": [20, 21], "25": [20, 21], "26": [20, 21], "27": [20, 21, 22], "29": [20, 21], "30": [20, 21], "31": [20, 21], "34": [20, 21], "35": [20, 21], "37": [20, 21, 23], "38": [20, 21], "39": [20, 21, 23], "41": [20, 21], "42": [20, 21], "tee": 20, "run_20210712223308_inst": 20, "run_20210712223308_instance_0_cores_0": 20, "87": 20, "08": 20, "117": 20, "88": 20, "118": 20, "45": [20, 21], "46": [20, 21], "47": [20, 21], "49": [20, 21], "51": [20, 21], "52": [20, 21], "53": [20, 21], "54": [20, 21], "55": [20, 21, 22], "57": 20, "59": 20, "60": 20, "61": 20, "62": 20, "63": [20, 23], "65": 20, "68": [20, 23], "70": 20, "71": 20, "72": 20, "73": 20, "74": 20, "77": 20, "82": 20, "83": [20, 22], "run_20210712214504_inst": 20, "run_20210712214504_instance_0_cores_22": 20, "513": 20, "run_20210712220928_inst": 20, "run_20210712220928_instance_0_cores_0": 20, "355": 20, "356": 20, "run_20210712221150_inst": 20, "run_20210712221150_instance_0_cores_0": 20, "run_20210712221150_instance_1_cores_22": 20, "233": 20, "236": 20, "run_20210712221415_inst": 20, "run_20210712221415_instance_0_cores_0": 20, "run_20210712221415_instance_1_cores_4": 20, "run_20210712221415_instance_2_cores_8": 20, "run_20210712221415_instance_3_cores_12": 20, "run_20210712221415_instance_4_cores_16": 20, "run_20210712221415_instance_5_cores_20": 20, "run_20210712221415_instance_6_cores_24": 20, "run_20210712221415_instance_7_cores_28": 20, "run_20210712221415_instance_8_cores_32": 20, "run_20210712221415_instance_9_cores_36": 20, "run_20210712221415_instance_10_cores_40": 20, "140": 20, "143": 20, "146": 20, "149": 20, "151": 20, "154": 20, "157": 20, "159": 20, "162": 20, "164": 20, "167": 20, "run_20210712221305_inst": 20, "run_20210712221305_instance_0_cores_0": 20, "run_20210712221305_instance_1_cores_11": 20, "run_20210712221305_instance_2_cores_22": 20, "run_20210712221305_instance_3_cores_33": 20, "470": 20, "471": 20, "473": 20, "476": 20, "479": 20, "confirm": 20, "2022": 20, "01": [20, 21, 23], "06": [20, 21], "175": 20, "176": 20, "177": 20, "run_20220106130151_instance_0_cores_0": 20, "sometim": [20, 22], "desir": 20, "malloc": [20, 22], "235": 20, "jemallocl": 20, "malloc_conf": [20, 22], "oversize_threshold": [20, 22], "background_thread": [20, 22], "metadata_thp": [20, 22], "dirty_decay_m": [20, 22], "9000000000": [20, 22], "muzzy_decay_m": [20, 22], "libjemalloc": 20, "run_20210713153048_instance_0_cores_0": 20, "654": 20, "libtcmalloc": 20, "655": 20, "run_20210713153333_instance_0_cores_0": 20, "784": 20, "run_20210713153659_instance_0_cores_0": 20, "blocktim": [20, 22], "00": [20, 23], "760": 20, "761": 20, "run_20210713152500_instance_0_cores_0": 20, "ipex_en": 21, "procedur": 21, "dramat": [21, 22], "cpu_launcher_en": 21, "cpu_launcher_arg": 21, "hyperthread": 21, "ptmalloc": 21, "tcmalloc": 21, "nth": [21, 22], "uniform": 21, "notabl": 21, "automodelforsequenceclassif": 21, "autoconfig": 21, "uncas": 21, "return_dict": 21, "num_label": 21, "dummi": 21, "record": 21, "max_length": 21, "384": 21, "dummy_tensor": 21, "scheme": 21, "quantconf": [21, 23], "n_iter": 21, "model_conf": 21, "jit_input": 21, "bert_int8_jit": 21, "rn50_int8_jit": 21, "rn50_ipex_int8": 21, "handler": 21, "image_classifi": 21, "nc": 21, "model_stor": 21, "server": [21, 22], "model_log": 21, "8180": 21, "096": 21, "8375c": 21, "03": 21, "981": 21, "982": 21, "bench": 21, "amazon": 21, "ec2": 21, "m6i": 21, "24xlarg": 21, "reproduc": 21, "overlap": 21, "url": [21, 23], "modelurl": 21, "inputpath": 21, "concurr": [21, 22], "mar": 21, "bert_ipex_int8": 21, "huggingface_transform": 21, "seq_classification_artifact": 21, "sample_text_captum_input": 21, "power": 22, "graphic": 22, "xe": 22, "thing": 22, "articl": 22, "briefli": 22, "background": 22, "knowledg": 22, "c620": 22, "seri": 22, "chipset": 22, "purlei": 22, "chip": 22, "inclus": 22, "1mb": 22, "l2": 22, "2666": 22, "mhz": 22, "ddr4": 22, "six": 22, "ultra": 22, "interconnect": 22, "upi": 22, "microarchitectur": 22, "consist": 22, "connect": 22, "meanwhil": [22, 23], "transfer": 22, "gt": 22, "typic": [22, 23], "equip": 22, "motherboard": 22, "attach": 22, "remot": 22, "asu": 22, "z11pa": 22, "d8": 22, "competit": 22, "stall": 22, "busi": 22, "visit": 22, "uma": 22, "becom": 22, "lscpu": 22, "retriev": 22, "8180m": 22, "111": 22, "50ghz": 22, "node0": 22, "node1": 22, "sophist": 22, "strategi": [22, 23], "brought": [22, 23], "polici": 22, "aim": 22, "put": 22, "huge": 22, "sysctl": 22, "balanc": 22, "variou": [22, 23], "great": 22, "placement": 22, "cpunodebind": 22, "membind": 22, "multithread": 22, "primari": 22, "consecut": 22, "join": 22, "besid": [22, 23], "libgomp": 22, "libiomp": 22, "commonli": 22, "gomp": 22, "comma": 22, "proc": 22, "gomp_cpu_affin": 22, "omp_proc_bind": 22, "omp_schedul": 22, "static": [22, 23], "invalid": 22, "thrash": 22, "did": [22, 23], "compet": 22, "unus": 22, "proclist": 22, "millisecond": 22, "sleep": 22, "200m": 22, "period": 22, "elaps": 22, "stop": 22, "overal": 22, "appropri": 22, "reserv": 22, "sole": 22, "penal": 22, "role": 22, "unnecessari": 22, "destruct": 22, "emphas": 22, "fragment": 22, "mmuzzy_decay_m": 22, "crash": [22, 23], "forg": 22, "dealloc": 22, "costli": 22, "gpertool": 22, "plu": 22, "pretti": 22, "nifti": 22, "analysi": 22, "gperftool": 22, "extrem": 22, "remark": 22, "set_flush_denorm": 22, "warm": 22, "threshold": 22, "usuali": 22, "come": 22, "maskrcnn": [22, 23], "wav2vec2": 22, "recognit": 22, "onednn_primitive_cache_capac": 22, "65536": 22, "voic": 22, "4096": 22, "mha": 23, "992": 23, "64byte": 23, "constraint": 23, "addlayernorm": 23, "retinanet": 23, "1032": 23, "1053": 23, "1074": 23, "changelog": 23, "excit": 23, "tightli": 23, "matur": 23, "offlin": 23, "enhanc": 23, "posit": 23, "broad": 23, "becam": 23, "bake": 23, "wave2vec": 23, "t5": 23, "albert": 23, "facilit": 23, "minmax": 23, "movingaverageminmax": 23, "polish": 23, "flexibl": 23, "model_to_be_calibr": 23, "calibrated_model": 23, "multi_stream_input_hint": 23, "multi_stream_output_hint": 23, "conclud": 23, "adam": 23, "822": 23, "3d": 23, "642": 23, "deconv3d": 23, "692": 23, "787": 23, "swish": 23, "fsi": 23, "risk": 23, "551": 23, "leakyrelu": 23, "589": 23, "407": 23, "647": 23, "convolution1d": 23, "657": 23, "einsum": 23, "alphafold2": 23, "674": 23, "711": 23, "648": 23, "684": 23, "685": 23, "dockerhub": 23, "wheel": 23, "earli": 23, "reach": 23, "announc": 23, "continu": 23, "oob": 23, "sdk": 23, "2x": 23, "5x": 23, "reduct": 23, "center": 23, "deploi": 23, "u8": 23, "s8": 23, "satur": 23, "occur": 23, "u7": 23, "unsign": 23, "s7": 23, "worth": 23, "upload": 23, "pypi": 23, "pip3": 23, "dedic": 23, "220mb": 23, "5mb": 23, "220m": 23, "224m": 23, "7m": 23, "5m": 23, "qkv": 23, "encod": 23, "278": 23, "head": 23, "attent": 23, "531": 23, "432": 23, "438": 23, "602": 23, "sliu": 23, "hardsigmoid": 23, "relu6": 23, "selu": 23, "524": 23, "452": 23, "425": 23, "100mb": 23, "40mb": 23, "meant": 23, "resolv": 23, "te": 23, "wrap": 23, "bactchnorm": 23, "break": 23, "205": 23, "straightforward": 23, "underhood": 23, "xpu": 23, "simplifi": 23, "torchvison": 23, "hugginfac": 23, "zone": 23, "potenti": 23, "legal": 23, "standard": 23, "resnet18": 23, "resnet18_xpu": 23, "enable_auto_mixed_precis": 23, "mixed_dtyp": 23, "xx_c": 23, "xx_v": 23, "clibrat": 23, "ampconf": 23, "automixprecis": 23, "running_mod": 23, "cali_dataset": 23, "trace_model": 23, "omp_set_num_thread": 23, "model_execut": 23, "same_model_execution_again": 23, "descriptor": 23, "parti": 23, "49786": 23, "anymor": 23, "upgrad": 23, "rc": 23, "readm": 23, "blog": 23, "stakehold": 23, "5rc3": 23, "dpcpp": 23, "futur": 23, "heterogen": 23, "refin": 23, "bfp16": 23, "proper": 23, "tacotron2": 23, "rnn": 23, "frozenbatchnorm": 23, "embeddingbad": 23, "daili": 23, "huggingfac": 23, "resnext3d": 23, "maskrnn": 23, "codenam": 23, "encount": 23, "hang": 23, "mlp": 23, "eltwis": 23, "7x": 23, "enable_auto_optim": 23, "significantli": 23, "streamlin": 23, "enable_auto_mix_precis": 23, "baselin": 23, "inject": 23, "resnet3d": 23, "fb": 23, "yolov3": 23, "maxpool": 23}, "objects": {"intel_extension_for_pytorch.cpu": [[2, 0, 0, "-", "runtime"]], "intel_extension_for_pytorch.cpu.runtime": [[2, 1, 1, "", "CPUPool"], [2, 1, 1, "", "MultiStreamModule"], [2, 1, 1, "", "MultiStreamModuleHint"], [2, 1, 1, "", "Task"], [2, 2, 1, "", "get_core_list_of_node_id"], [2, 2, 1, "", "is_runtime_ext_enabled"], [2, 1, 1, "", "pin"]], "intel_extension_for_pytorch": [[2, 2, 1, "", "enable_onednn_fusion"], [2, 2, 1, "", "optimize"], [2, 0, 0, "-", "quantization"], [2, 1, 1, "", "verbose"]], "intel_extension_for_pytorch.nn": [[6, 1, 1, "", "FrozenBatchNorm2d"]], "intel_extension_for_pytorch.nn.functional": [[6, 2, 1, "", "interaction"]], "intel_extension_for_pytorch.quantization": [[2, 2, 1, "", "convert"], [2, 2, 1, "", "prepare"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "function", "Python function"]}, "titleterms": {"intel": [0, 1, 4, 9, 20, 21, 22], "extens": [0, 1, 4, 6, 9, 13, 21], "pytorch": [0, 1, 4, 9, 11, 15, 21], "cpu": [0, 2, 10, 11, 22], "isa": [0, 6, 10], "dynam": [0, 5, 6, 9, 10], "dispatch": [0, 6, 10], "design": [0, 13, 20], "doc": 0, "overview": [0, 10, 17, 20, 22], "build": [0, 4, 10, 15], "compil": [0, 10, 15], "requir": [0, 10, 13, 15], "code": [0, 5], "folder": 0, "struct": 0, "kernel": [0, 11], "implement": [0, 13], "intel_extension_for_pytorch": 0, "csrc": 0, "aten": [0, 11], "xyzkrnl": 0, "cpp": 0, "stub": 0, "xyz": 0, "h": 0, "dyndisp": 0, "dispatchstub": 0, "codegen": 0, "process": 0, "add": 0, "custom": 0, "intrin": 0, "specif": [0, 7], "exampl": [0, 5, 10, 13, 20], "vec": 0, "privat": 0, "debug": [0, 4], "api": [0, 2, 6, 8, 11], "select": [0, 10], "level": [0, 10], "manual": 0, "featur": [0, 6, 10], "check": [0, 10], "welcom": 1, "document": [1, 2, 4, 21, 22], "gener": 2, "quantiz": [2, 5, 6, 9], "runtim": [2, 6, 13], "blog": 3, "public": 3, "contribut": 4, "develop": 4, "tip": 4, "unit": 4, "test": 4, "python": [4, 6], "better": 4, "local": 4, "pytest": 4, "lint": 4, "c": [4, 5, 11, 15], "write": [4, 11], "train": [5, 7], "singl": [5, 20], "instanc": [5, 17, 20], "chang": [5, 23], "highlight": [5, 23], "complet": 5, "float32": [5, 7], "bfloat16": [5, 7, 14, 17], "distribut": 5, "infer": [5, 7, 20], "imper": [5, 7], "mode": [5, 20], "resnet50": [5, 21], "bert": [5, 21], "torchscript": [5, 7], "int8": [5, 6, 8, 17, 21], "calibr": [5, 9], "static": [5, 9], "deploy": 5, "model": [5, 8, 9, 11, 13, 21], "zoo": 5, "eas": [6, 8], "us": [6, 7, 8, 13, 20], "channel": [6, 11, 22], "last": [6, 11, 22], "auto": [6, 7, 13], "mix": [6, 7], "precis": [6, 7], "amp": [6, 7], "graph": [6, 8], "optim": [6, 8, 9, 12], "oper": [6, 11, 12], "introduct": [7, 12], "case": [7, 13], "default": [7, 11, 20], "path": 7, "support": 7, "autocast": 7, "op": 7, "refer": 7, "elig": 7, "behavior": 7, "can": 7, "promot": 7, "widest": 7, "input": [7, 13], "type": 7, "fp32": [8, 17], "bf16": 8, "methodologi": 8, "fusion": [8, 12], "pattern": 8, "fold": 8, "defin": 9, "qconfig": 9, "prepar": 9, "do": 9, "convert": 9, "deploi": [9, 21], "what": [11, 23], "i": [11, 13, 20], "memori": [11, 20, 22], "format": 11, "all": [11, 20], "That": 11, "matter": 11, "nchw": 11, "b": 11, "nhwc": 11, "wip": 11, "block": 11, "nchw16c": 11, "stride": 11, "layout": 11, "tensor": 11, "creation": 11, "convers": 11, "d": 11, "coverag": 11, "statu": 11, "regist": [11, 21], "nativ": 11, "manner": 11, "onednn": [11, 22], "creat": [11, 21], "convolut": 11, "primit": [11, 22], "target": 11, "multistream": 13, "modul": 13, "examples1": 13, "basic": 13, "usag": [13, 20], "examples2": 13, "set": 13, "examples3": 13, "structur": [13, 22], "output": 13, "perform": [13, 17, 18, 21, 22, 23], "recip": 13, "known": [13, 19, 23], "issu": [13, 19, 23], "asynchron": 13, "task": 13, "configur": [13, 17, 22], "core": [13, 20], "bind": 13, "detail": 13, "how": 13, "iomp": 13, "preload": 13, "load": 13, "dure": 13, "split": 14, "sgd": 14, "stochast": 14, "gradient": 14, "descent": 14, "instal": [15, 21], "guid": [15, 18, 20, 22], "system": 15, "via": 15, "wheel": 15, "file": [15, 21], "sourc": 15, "docker": 15, "contain": 15, "from": 15, "dockerfil": 15, "get": 15, "dockerhub": 15, "sdk": 15, "licens": 16, "v1": 17, "11": [17, 23], "number": [17, 20, 22], "accuraci": 17, "softwar": [17, 22], "version": 17, "hardwar": [17, 22], "200": [17, 23], "an": 17, "aw": 17, "ec2": 17, "c6i": 17, "2xlarg": 17, "10": [17, 23], "tune": [18, 22], "launch": 20, "script": 20, "physic": 20, "ii": 20, "includ": 20, "logic": 20, "iii": 20, "1": [20, 21, 23], "node": 20, "iv": 20, "your": 20, "multipl": 20, "v": 20, "throughput": 20, "vi": 20, "latenc": 20, "vii": 20, "viii": 20, "index": 20, "jemalloc": [20, 22], "tcmalloc": [20, 22], "alloc": [20, 22], "openmp": [20, 22], "librari": 20, "gnu": [20, 22], "torchserv": 21, "content": [21, 22], "thi": [21, 22], "serv": 21, "launcher": 21, "export": 21, "ipex": 21, "serial": 21, "2": [21, 23], "archiv": 21, "3": 21, "start": 21, "4": 21, "benchmark": 21, "boost": 21, "non": 22, "uniform": 22, "access": 22, "numa": 22, "numactl": 22, "omp_num_thread": 22, "denorm": 22, "cach": 22, "releas": 23, "12": 23, "300": 23, "100": 23, "0": 23, "": 23, "9": 23, "new": 23, "8": 23, "improv": 23, "other": 23, "alpha": 23, "result": 23, "note": 23}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})