From d9d6d5b62d14716bb7170b8d52aa228a60224b30 Mon Sep 17 00:00:00 2001
From: zhuyuhua-v <yuhua.zhu@intel.com>
Date: Thu, 18 Aug 2022 21:06:43 +0800
Subject: [PATCH 26/36] Add xpu path for GRUCell (#61)

Signed-off-by: zhuyuhuav <yuhua.zhu@intel.com>

Signed-off-by: zhuyuhuav <yuhua.zhu@intel.com>
---
 aten/src/ATen/native/RNN.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/aten/src/ATen/native/RNN.cpp b/aten/src/ATen/native/RNN.cpp
index c30bb6f3f4..e53e3f789b 100644
--- a/aten/src/ATen/native/RNN.cpp
+++ b/aten/src/ATen/native/RNN.cpp
@@ -800,7 +800,7 @@ struct GRUCell : Cell<Tensor, cell_params> {
       const hidden_type& hidden,
       const cell_params& params,
       bool pre_compute_input = false) const override {
-    if (input.is_cuda()) {
+    if (input.is_cuda() || input.is_xpu()) {
       TORCH_CHECK(!pre_compute_input);
       auto igates = params.matmul_ih(input);
       auto hgates = params.matmul_hh(hidden);
-- 
2.25.1

