From cf1d0d7fbb0123db56ca6f327913fc26175da0b2 Mon Sep 17 00:00:00 2001
From: Feng Yuan <feng1.yuan@intel.com>
Date: Tue, 14 Jun 2022 04:34:19 +0000
Subject: [PATCH 11/28] hook XPU device in _get_available_device_type (#76167)

Signed-off-by: Feng Yuan <feng1.yuan@intel.com>

Pull Request resolved: https://github.com/pytorch/pytorch/pull/76167
Approved by: https://github.com/ezyang
---
 torch/_utils.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/torch/_utils.py b/torch/_utils.py
index 4245c25b21..df51c14ba5 100644
--- a/torch/_utils.py
+++ b/torch/_utils.py
@@ -437,6 +437,8 @@ class ExceptionWrapper(object):
 def _get_available_device_type():
     if torch.cuda.is_available():
         return "cuda"
+    if hasattr(torch, "xpu") and torch.xpu.is_available():  # type: ignore[attr-defined]
+        return "xpu"
     # add more available device types here
     return None
 
@@ -445,6 +447,8 @@ def _get_device_attr(get_member):
     device_type = _get_available_device_type()
     if device_type and device_type.lower() == "cuda":
         return get_member(torch.cuda)
+    if device_type and device_type.lower() == "xpu":
+        return get_member(torch.xpu)  # type: ignore[attr-defined]
     # add more available device types here
     return None
 
-- 
2.25.1

