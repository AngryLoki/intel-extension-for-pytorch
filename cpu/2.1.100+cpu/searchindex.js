Search.setIndex({"docnames": ["design_doc/cpu/isa_dyndisp", "index", "tutorials/api_doc", "tutorials/blogs_publications", "tutorials/cheat_sheet", "tutorials/contribution", "tutorials/examples", "tutorials/features", "tutorials/features/amp", "tutorials/features/auto_channels_last", "tutorials/features/codeless_optimization", "tutorials/features/fast_bert", "tutorials/features/graph_capture", "tutorials/features/graph_optimization", "tutorials/features/hypertune", "tutorials/features/int8_overview", "tutorials/features/int8_recipe_tuning_api", "tutorials/features/isa_dynamic_dispatch", "tutorials/features/nhwc", "tutorials/features/optimizer_fusion", "tutorials/features/runtime_extension", "tutorials/features/split_sgd", "tutorials/getting_started", "tutorials/installation", "tutorials/introduction", "tutorials/known_issues", "tutorials/license", "tutorials/llm", "tutorials/llm/llm_optimize_transformers", "tutorials/performance", "tutorials/performance_tuning/launch_script", "tutorials/performance_tuning/torchserve", "tutorials/performance_tuning/tuning_guide", "tutorials/releases"], "filenames": ["design_doc/cpu/isa_dyndisp.md", "index.rst", "tutorials/api_doc.rst", "tutorials/blogs_publications.md", "tutorials/cheat_sheet.md", "tutorials/contribution.md", "tutorials/examples.md", "tutorials/features.rst", "tutorials/features/amp.md", "tutorials/features/auto_channels_last.md", "tutorials/features/codeless_optimization.md", "tutorials/features/fast_bert.md", "tutorials/features/graph_capture.md", "tutorials/features/graph_optimization.md", "tutorials/features/hypertune.md", "tutorials/features/int8_overview.md", "tutorials/features/int8_recipe_tuning_api.md", "tutorials/features/isa_dynamic_dispatch.md", "tutorials/features/nhwc.md", "tutorials/features/optimizer_fusion.md", "tutorials/features/runtime_extension.md", "tutorials/features/split_sgd.rst", "tutorials/getting_started.md", "tutorials/installation.md", "tutorials/introduction.rst", "tutorials/known_issues.md", "tutorials/license.md", "tutorials/llm.rst", "tutorials/llm/llm_optimize_transformers.md", "tutorials/performance.md", "tutorials/performance_tuning/launch_script.md", "tutorials/performance_tuning/torchserve.md", "tutorials/performance_tuning/tuning_guide.md", "tutorials/releases.md"], "titles": ["Intel\u00ae Extension for PyTorch* CPU ISA Dynamic Dispatch Design Doc", "Intel\u00ae Extension for PyTorch*", "API Documentation", "Blogs &amp; Publications", "Cheat Sheet", "Contribution", "Examples", "Features", "Auto Mixed Precision (AMP)", "Auto Channels Last", "Codeless Optimization (Experimental)", "Fast BERT (Experimental)", "Graph Capture (Experimental)", "Graph Optimization", "HyperTune (Experimental)", "Intel\u00ae Extension for PyTorch* optimizations for quantization", "INT8 Recipe Tuning API (Experimental)", "ISA Dynamic Dispatching", "Channels Last", "Optimizer Fusion", "Runtime Extension", "Split SGD", "Quick Start", "Installation", "Introduction", "Troubleshooting", "License", "Large Language Models (LLM) Optimizations Overview", "Transformers Optimization Frontend API", "Performance", "Launch Script Usage Guide", "TorchServe with Intel\u00ae Extension for PyTorch*", "Performance Tuning Guide", "Releases"], "terms": {"thi": [0, 2, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 25, 26, 27, 28, 29, 30, 33], "document": [0, 7, 17, 20, 28, 33], "explain": [0, 17, 18, 21], "mechan": [0, 1, 7, 17, 21, 33], "ipex": [0, 1, 2, 3, 4, 6, 7, 9, 11, 12, 13, 15, 16, 19, 20, 22, 25, 27, 28, 30, 31, 33], "base": [0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 17, 20, 21, 25, 27, 28, 29, 31, 32, 33], "It": [0, 2, 7, 8, 10, 13, 17, 18, 20, 21, 22, 25, 28, 30, 32, 33], "i": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 25, 26, 27, 28, 29, 31, 32, 33], "an": [0, 1, 2, 5, 6, 7, 8, 10, 11, 13, 14, 17, 18, 19, 20, 21, 25, 27, 30, 31, 32, 33], "similar": [0, 15, 17, 32], "fork": [0, 17, 32], "from": [0, 1, 2, 3, 4, 5, 8, 10, 11, 13, 15, 16, 17, 18, 19, 20, 21, 24, 27, 28, 30, 31, 32, 33], "nativ": [0, 1, 6, 7, 8, 19, 21, 25, 27, 33], "addit": [0, 2, 6, 7, 17, 21, 33], "support": [0, 2, 5, 6, 7, 13, 15, 16, 17, 18, 19, 20, 21, 24, 25, 27, 28, 30, 31, 32, 33], "avx512_vnni": [0, 17], "avx512_bf16": [0, 17], "amx": [0, 1, 3, 6, 7, 17, 24, 27, 29], "statement": [0, 14, 17], "default": [0, 2, 4, 6, 7, 10, 12, 13, 15, 16, 17, 20, 25, 27, 29, 31, 32, 33], "avx2": [0, 17, 25, 33], "_": [0, 13, 15, 18, 20, 29, 30, 31, 32, 33], "vnni": [0, 1, 15, 24, 27], "avx512": [0, 7, 17, 18, 31, 33], "bf16": [0, 2, 3, 6, 7, 19, 21, 25, 27, 29, 33], "fp16": [0, 28], "1": [0, 1, 2, 3, 4, 6, 8, 10, 11, 12, 13, 16, 17, 18, 19, 20, 21, 24, 25, 27, 28, 29, 30, 32], "11": [0, 17, 30, 31], "12": [0, 6, 10, 14, 17, 29, 30, 31], "13": [0, 3, 10, 29, 30, 31, 32], "2": [0, 1, 3, 8, 10, 17, 18, 20, 21, 24, 25, 26, 27, 28, 29, 30, 32], "current": [0, 1, 5, 7, 13, 14, 15, 16, 17, 19, 20, 25, 27, 28, 33], "same": [0, 2, 5, 7, 10, 15, 17, 18, 20, 21, 27, 30, 31, 32, 33], "gcc": [0, 17], "ani": [0, 5, 8, 10, 17, 18, 31, 33], "9": [0, 6, 7, 14, 17, 24, 30, 31], "10": [0, 7, 14, 16, 17, 18, 21, 24, 25, 30, 31, 32], "3": [0, 5, 6, 7, 8, 10, 12, 13, 14, 16, 17, 18, 20, 21, 29, 30, 32, 33], "cmake": [0, 5, 6, 17, 33], "modul": [0, 1, 2, 6, 7, 8, 13, 16, 17, 25, 28, 30, 33], "findavx": [0, 17], "detail": [0, 2, 5, 6, 7, 8, 9, 11, 13, 17, 18, 23, 24, 25, 27, 29, 31, 32, 33], "copi": [0, 5, 18], "sourc": [0, 1, 5, 6, 26, 32, 33], "file": [0, 2, 4, 5, 6, 8, 14, 15, 16, 17, 18, 27, 30, 33], "multipl": [0, 2, 5, 7, 8, 18, 25, 27, 29, 31, 32], "each": [0, 2, 8, 14, 19, 20, 21, 30, 31, 32, 33], "us": [0, 1, 2, 3, 4, 5, 6, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 31, 32, 33], "its": [0, 2, 6, 7, 8, 14, 21, 27, 29, 30, 31, 32, 33], "paramet": [0, 2, 6, 7, 8, 10, 16, 19, 20, 21, 25, 27, 28, 29, 30, 32, 33], "gener": [0, 1, 5, 6, 7, 10, 12, 16, 17, 18, 21, 27, 28, 29, 30, 31, 32, 33], "object": [0, 2, 6, 7, 14, 17, 20, 32, 33], "contain": [0, 2, 5, 13, 25, 30, 31, 32, 33], "function": [0, 2, 5, 6, 7, 8, 10, 11, 12, 14, 15, 17, 20, 21, 22, 25, 27, 28, 30, 32, 33], "bodi": 0, "anonym": 0, "namespac": [0, 8], "so": [0, 2, 5, 6, 7, 8, 15, 18, 20, 29, 30, 31, 32, 33], "differ": [0, 1, 2, 6, 7, 15, 18, 20, 27, 30, 31, 32, 33], "version": [0, 6, 7, 24, 25, 26, 31, 32, 33], "won": [0, 2, 7, 8, 25], "t": [0, 2, 5, 7, 8, 14, 15, 16, 18, 20, 25, 31, 33], "conflict": [0, 7], "virtual": 0, "polymorph": 0, "pertain": 0, "At": [0, 7], "runtim": [0, 1, 8, 13, 30, 32, 33], "cpuid": 0, "o": [0, 6, 17, 29], "statu": 0, "determin": [0, 21, 32], "which": [0, 1, 2, 5, 7, 8, 10, 14, 15, 18, 20, 25, 27, 29, 30, 31, 32, 33], "pointer": 0, "best": [0, 2, 7, 8, 14, 23, 27, 32, 33], "match": [0, 2, 8, 30], "system": [0, 32], "specifii": 0, "complier": 0, "The": [0, 1, 2, 5, 6, 7, 8, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 29, 30, 31, 32, 33], "script": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 14, 20, 23, 25, 27, 28, 29, 31, 32, 33], "locat": [0, 5, 33], "isacodegen": 0, "new": [0, 3, 5, 11, 12, 16, 18, 20, 25, 28, 32], "suffix": 0, "sampl": [0, 2, 9, 14, 28, 32], "origin": [0, 2, 7, 12, 13, 15, 20, 28, 33], "adaptiveaveragepoolingkrnl": 0, "releas": [0, 1, 18, 25, 29, 32], "isa_codegen": 0, "o3": 0, "d__avx__": 0, "dcpu_capability_avx2": 0, "mavx2": 0, "mfma": 0, "mno": 0, "avx256": 0, "split": [0, 2, 7, 19, 20, 25, 33], "unalign": [0, 33], "load": [0, 1, 2, 6, 7, 13, 15, 28, 31, 33], "store": [0, 2, 18, 19, 21, 27, 30, 31, 32, 33], "dcpu_cap": 0, "dcpu_capability_default": 0, "d__avx512f__": 0, "mavx512f": 0, "mavx512bw": 0, "mavx512vl": 0, "mavx512dq": 0, "dcpu_capability_avx512": 0, "mavx512vnni": 0, "dcpu_capability_avx512_vnni": 0, "mavx512bf16": 0, "dcpu_capability_avx512_bf16": 0, "mamx": 0, "tile": 0, "int8": [0, 1, 2, 3, 4, 18, 20, 27, 28, 33], "dcpu_capability_amx": 0, "avx512_fp16": [0, 17], "mavx512fp16": 0, "dcpu_capability_avx512_fp16": 0, "note": [0, 2, 3, 5, 6, 15, 17, 18, 20, 23, 27, 29, 30, 31, 32], "fulli": [0, 5, 15, 21, 32, 33], "In": [0, 1, 2, 6, 7, 8, 12, 16, 18, 19, 21, 22, 27, 30, 31, 32, 33], "order": [0, 2, 18, 21, 30, 32], "align": [0, 18, 21, 33], "we": [0, 1, 2, 5, 6, 7, 8, 9, 10, 14, 15, 16, 18, 19, 20, 21, 27, 29, 31, 32, 33], "stead": 0, "minim": [0, 7, 14, 17, 32], "execut": [0, 2, 4, 6, 7, 8, 10, 11, 12, 13, 14, 16, 17, 19, 20, 25, 30, 31, 32, 33], "machin": [0, 3, 5, 6, 7, 14, 25, 30, 31, 32, 33], "defin": [0, 2, 5, 6, 7, 8, 10, 16, 18, 31], "depend": [0, 5, 7, 18, 24, 25, 32, 33], "librari": [0, 1, 2, 5, 6, 7, 20, 31, 32, 33], "sleef": 0, "ar": [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 29, 30, 31, 32, 33], "must": [0, 5, 14, 19], "src": 0, "regist": [0, 1, 7, 10, 33], "width": [0, 18], "isa_nam": 0, "inlin": 0, "name": [0, 2, 5, 7, 14, 24, 27, 30, 31, 32, 33], "higher": [0, 2, 7, 13, 18, 27], "compat": [0, 21], "lower": [0, 8, 21, 27, 33], "need": [0, 2, 5, 6, 7, 10, 13, 14, 16, 18, 19, 20, 21, 22, 25, 27, 28, 30, 31, 32, 33], "definit": [0, 21], "Such": 0, "But": [0, 18], "don": [0, 2, 5, 8, 14, 33], "due": [0, 1, 6, 8, 10, 20, 25], "If": [0, 2, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 20, 25, 30, 31, 32, 33], "you": [0, 1, 2, 5, 6, 7, 8, 13, 14, 15, 18, 20, 22, 24, 25, 27, 28, 30, 32, 33], "want": [0, 2, 5, 7, 14, 15, 20, 30], "instruct": [0, 1, 5, 6, 7, 8, 21, 22, 23, 24, 27, 29, 32, 33], "refer": [0, 1, 7, 9, 13, 14, 16, 18, 20, 22, 23, 24, 31, 33], "tip": 0, "relat": [0, 6, 13, 30, 32, 33], "newkernelkrnl": 0, "newkernel": 0, "includ": [0, 1, 2, 5, 6, 7, 10, 14, 15, 22, 25, 26, 27, 29, 33], "header": 0, "comment": [0, 5, 14, 33], "set": [0, 1, 2, 4, 5, 6, 7, 8, 14, 15, 21, 23, 25, 27, 29, 30, 31, 32, 33], "mai": [0, 1, 2, 3, 5, 7, 8, 9, 18, 20, 25, 30, 31, 32, 33], "make": [0, 2, 5, 6, 7, 14, 15, 17, 21, 22, 27, 31, 32], "special": [0, 18, 27], "e": [0, 1, 6, 7, 8, 12, 18, 27, 30, 32, 33], "g": [0, 7, 8, 18, 27, 33], "time": [0, 2, 5, 7, 14, 18, 19, 25, 27, 29, 32, 33], "flag": [0, 2, 5, 7, 20, 30, 33], "A": [0, 2, 5, 6, 7, 10, 11, 25, 27, 30, 32, 33], "tabl": [0, 7, 29, 33], "fastest": 0, "avail": [0, 1, 2, 6, 7, 11, 17, 20, 22, 28, 30, 32, 33], "chosen": [0, 8, 14], "report": [0, 1], "cpuinfo": 0, "mykernel": 0, "fn_type": 0, "void": 0, "const": [0, 6], "tensor": [0, 2, 6, 7, 8, 11, 15, 20, 25, 27, 31, 33], "x": [0, 1, 5, 6, 8, 10, 13, 15, 16, 18, 20, 21, 25, 33], "declare_dispatch": 0, "define_dispatch": 0, "register_dispatch": 0, "To": [0, 2, 5, 6, 7, 10, 13, 15, 18, 20, 21, 22, 27, 31, 32, 33], "call": [0, 2, 6, 8, 13, 18, 21, 25, 31, 32, 33], "kcpu": 0, "write": [0, 7], "follow": [0, 1, 2, 4, 5, 6, 7, 8, 11, 14, 15, 18, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33], "guid": [0, 3, 6, 7, 31, 33], "declar": 0, "type": [0, 2, 4, 5, 6, 7, 10, 16, 18, 20, 21, 22, 29, 30, 31, 33], "etc": [0, 2, 5, 33], "some": [0, 2, 5, 7, 8, 13, 16, 18, 20, 25, 30, 31, 32, 33], "onli": [0, 1, 2, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18, 20, 21, 25, 27, 30, 31, 33], "onednn": [0, 2, 3, 6, 13, 25, 27, 33], "ideep": [0, 18], "other": [0, 2, 7, 8, 14, 18, 19, 22, 27, 30, 32], "backend": [0, 1, 2, 3, 6, 7, 12, 13, 16, 22, 25, 27, 30, 32, 33], "batchnorm": [0, 13, 18, 25, 33], "can": [0, 1, 2, 5, 6, 7, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 27, 28, 29, 30, 31, 32, 33], "common": [0, 21, 27, 30, 32], "all": [0, 2, 5, 6, 8, 13, 14, 19, 20, 27, 28, 31, 32, 33], "pass": [0, 1, 2, 5, 10, 20, 25, 27, 31, 33], "For": [0, 1, 2, 5, 6, 7, 8, 9, 10, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24, 25, 27, 30, 31, 32, 33], "more": [0, 1, 2, 5, 6, 7, 8, 10, 11, 13, 16, 19, 20, 21, 22, 25, 27, 31, 32, 33], "intrins": 0, "fp32": [0, 2, 4, 6, 19, 21, 25, 27, 33], "convert": [0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 16, 18, 20, 22, 25, 31, 33], "cvtfp32tobf16": 0, "pragma": 0, "onc": [0, 2, 5, 6, 14, 18, 20, 21, 31, 32], "torch_ipex": [0, 33], "cvt_fp32_to_bf16": 0, "bfloat16": [0, 2, 3, 4, 7, 10, 11, 18, 22, 28, 30, 33], "dst": 0, "float": [0, 2, 6, 7, 8, 14, 15, 16, 21, 28, 33], "int": [0, 2, 6, 7, 14, 25, 28, 30, 33], "len": [0, 6, 7, 13, 16], "cvt_fp32_to_bf16_kernel_impl": 0, "cvt_fp32_to_bf16_kernel_fn": 0, "cvt_fp32_to_bf16_kernel_stub": 0, "return": [0, 2, 6, 7, 8, 10, 16, 20, 25, 33], "macro": 0, "cpu_capability_avx512": 0, "cpu_capability_avx512_bf16": 0, "mean": [0, 2, 18, 20, 27, 33], "hav": 0, "capabl": [0, 3, 33], "becaus": [0, 8, 18, 21, 27, 32, 33], "than": [0, 2, 5, 7, 18, 20, 21, 25, 32, 33], "region": [0, 2, 8, 32], "cvtfp32tobf16krnl": 0, "vec512": 0, "els": [0, 14, 18], "vec256": 0, "endif": 0, "immintrin": 0, "__m256i": 0, "_cvt_fp32_to_bf16": 0, "__m512": 0, "reinterpret_cast": 0, "_mm512_cvtneps_pbh": 0, "__m512i": 0, "valu": [0, 2, 10, 14, 17, 19, 20, 21, 25, 27, 30, 31, 32, 33], "_mm512_castps_si512": 0, "nan": [0, 33], "_mm512_set1_epi32": 0, "0xffff": 0, "auto": [0, 2, 6, 10, 18, 25, 27, 30, 32, 33], "mask_valu": 0, "_mm512_cmp_ps_mask": 0, "_cmp_ord_q": 0, "ones": 0, "0x1": 0, "vec_bia": 0, "0x7fff": 0, "uint32_t": 0, "lsb": 0, "input": [0, 2, 6, 7, 9, 10, 13, 15, 18, 25, 28, 29, 31, 32, 33], "16": [0, 20, 21, 29, 30, 31], "t_valu": 0, "_mm512_and_si512": 0, "_mm512_srli_epi32": 0, "rounding_bia": 0, "_mm512_add_epi32": 0, "befor": [0, 1, 2, 5, 6, 13, 14, 18, 20, 30, 32, 33], "back": [0, 12, 18, 21, 25], "_mm512_mask_blend_epi32": 0, "_mm512_cvtusepi32_epi16": 0, "0": [0, 1, 2, 4, 5, 8, 10, 11, 13, 16, 18, 19, 20, 21, 24, 25, 26, 29, 30, 31, 32], "15": [0, 14, 29, 30, 31], "f32": [0, 18], "_mm512_loadu_p": 0, "_mm256_storeu_si256": 0, "mask": [0, 7, 25], "_mm512_maskz_loadu_p": 0, "_mm256_mask_storeu_epi16": 0, "j": [0, 2, 5, 27, 29], "show": [0, 8, 21, 27, 28, 29, 30, 31, 32], "how": [0, 1, 2, 6, 10, 15, 18, 22, 31, 32, 33], "get": [0, 1, 2, 3, 4, 6, 7, 10, 15, 20, 21, 25, 27, 28, 29, 30, 32, 33], "data": [0, 2, 4, 6, 7, 8, 9, 10, 11, 12, 13, 16, 18, 19, 20, 21, 22, 25, 30, 31, 33], "size": [0, 2, 6, 7, 11, 15, 16, 18, 25, 27, 29, 31, 32, 33], "ha": [0, 1, 2, 7, 10, 14, 18, 20, 21, 25, 29, 30, 32, 33], "getveclength": 0, "std": [0, 6, 19], "tupl": [0, 2, 20], "get_cpp_typesize_and_vecs": 0, "scalartyp": 0, "dtype": [0, 2, 4, 6, 7, 8, 10, 11, 13, 15, 16, 22, 25, 28, 30, 33], "get_cpp_typesize_and_vecsize_kernel_impl": 0, "get_cpp_typesize_and_vecsize_kernel_fn": 0, "get_cpp_typesize_and_vecsize_kernel_stub": 0, "types": 0, "vectors": 0, "getveclengthkrnl": 0, "switch": [0, 7, 30, 32], "case": [0, 2, 6, 7, 9, 12, 18, 27, 30, 32, 33], "doubl": 0, "make_tupl": 0, "sizeof": 0, "vector": [0, 1, 2, 6, 18, 24, 27], "complexdoubl": 0, "c10": [0, 6], "complex": 0, "complexfloat": 0, "decltyp": 0, "impl": 0, "scalartypetocpptyp": 0, "half": [0, 2, 7, 21], "torch_check": 0, "fals": [0, 2, 4, 6, 7, 8, 13, 14, 15, 16, 17, 20, 22, 25, 30, 31, 33], "here": [0, 5, 8, 10, 13, 18, 20, 25, 31, 32, 33], "three": [0, 7, 27], "help": [0, 2, 5, 22, 27, 30, 32, 33], "queri": [0, 18], "max": [0, 2, 25, 33], "binari": [0, 5, 6, 7, 8, 33], "built": [0, 7, 17, 20, 33], "smaller": [0, 8], "python": [0, 1, 2, 4, 10, 14, 17, 20, 25, 27, 28, 30, 31, 32, 33], "7": [0, 10, 14, 20, 21, 30, 31, 33], "sep": [0, 3], "2021": [0, 3, 30, 31], "09": [0, 30], "58": [0, 30], "5": [0, 2, 6, 10, 13, 14, 16, 18, 19, 20, 21, 25, 29, 30, 31, 32, 33], "anaconda": 0, "inc": [0, 16], "linux": [0, 5, 6, 29, 30, 32], "copyright": [0, 26], "credit": 0, "licens": 0, "inform": [0, 1, 2, 6, 7, 14, 18, 27, 30, 31, 32, 33], "import": [0, 1, 2, 4, 5, 6, 7, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 24, 25, 27, 28, 31, 32, 33], "intel_extension_for_pytorch": [0, 1, 2, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17, 20, 22, 24, 28, 31, 33], "_c": [0, 17, 25], "core": [0, 2, 7, 14, 17, 29, 32, 33], "_get_current_isa_level": [0, 17], "_get_highest_cpu_support_isa_level": 0, "_get_highest_binary_support_isa_level": 0, "quit": [0, 33], "By": [0, 17, 30, 32], "maximum": [0, 2, 17], "underli": [0, 1, 17, 27], "hardwar": [0, 1, 3, 17, 24, 27, 31, 33], "overridden": [0, 2, 17], "environ": [0, 2, 5, 6, 17, 20, 23, 27, 29, 30, 31, 32], "variabl": [0, 2, 5, 17, 29, 30, 31, 32, 33], "aten_cpu_cap": [0, 17], "effect": [0, 17, 21, 25, 31, 32], "would": [0, 2, 5, 14, 17, 18, 29, 30, 31, 32, 33], "between": [0, 7, 8, 17, 20, 32, 33], "c": [0, 1, 7, 8, 16, 17, 20, 25, 27, 30, 31, 32, 33], "print": [0, 6, 11, 12, 13, 14, 16, 17, 30], "intern": [0, 17, 18, 20, 31], "purpos": [0, 17, 30, 31, 32], "subject": [0, 7, 17, 20, 26, 33], "chang": [0, 2, 5, 6, 7, 8, 10, 11, 12, 15, 17, 18, 20, 22, 24, 25, 28, 30], "addtion": [0, 17], "tool": [0, 17, 32, 33], "subfold": [0, 17], "test": [0, 7, 16, 17, 29, 33], "identif": [0, 6, 17], "gnu": [0, 6, 17, 31], "cxx": [0, 6, 17], "detect": [0, 1, 6, 12, 17, 25, 32, 33], "abi": [0, 6, 17, 33], "info": [0, 6, 17, 25, 30, 31, 33], "done": [0, 6, 7, 10, 16, 17, 25, 32, 33], "work": [0, 2, 5, 6, 7, 14, 15, 17, 20, 25, 27, 28, 30, 32, 33], "opt": [0, 2, 17, 27], "rh": [0, 17], "toolset": [0, 17], "root": [0, 6, 13, 16, 17, 27], "usr": [0, 6, 17, 30, 31], "bin": [0, 5, 6, 17, 30, 31], "cc": [0, 5, 6, 17], "skip": [0, 5, 6, 17, 18, 27, 30], "configur": [0, 2, 4, 6, 7, 14, 15, 17, 27, 30, 31, 33], "have": [0, 1, 2, 5, 6, 7, 9, 14, 17, 18, 20, 21, 22, 25, 26, 27, 29, 30, 31, 32, 33], "been": [0, 1, 6, 7, 10, 17, 18, 30, 32, 33], "written": [0, 5, 6, 17], "33": [0, 17, 30, 31], "cmakefil": [0, 17], "cpu_featur": [0, 17], "dir": [0, 17, 30], "66": [0, 17, 30, 33], "cpu_feature_main": [0, 17], "100": [0, 2, 4, 14, 16, 17, 29, 31], "link": [0, 1, 6, 17, 33], "target": [0, 5, 6, 10, 13, 14, 17, 33], "xcr0": [0, 17], "00000000000602e7": [0, 17], "avx": [0, 1, 6, 17, 24, 27], "true": [0, 2, 4, 6, 10, 12, 13, 14, 15, 16, 17, 30, 31, 32, 33], "mmx": [0, 17], "sse": [0, 17], "sse2": [0, 17], "sse3": [0, 17], "ssse3": [0, 17], "sse4_1": [0, 17], "sse4_2": [0, 17], "aes_ni": [0, 17], "sha": [0, 17], "xsave": [0, 17], "fma": [0, 17], "f16c": [0, 17], "avx_vnni": [0, 17], "avx512_f": [0, 17], "avx512_cd": [0, 17], "avx512_pf": [0, 17], "avx512_er": [0, 17], "avx512_vl": [0, 17], "avx512_bw": [0, 17], "avx512_dq": [0, 17], "avx512_ifma": [0, 17], "avx512_vbmi": [0, 17], "avx512_vpopcntdq": [0, 17], "avx512_4fmap": [0, 17], "avx512_4vnniw": [0, 17], "avx512_vbmi2": [0, 17], "avx512_vpclmul": [0, 17], "avx512_bitalg": [0, 17], "avx512_vp2intersect": [0, 17], "amx_bf16": [0, 17], "amx_til": [0, 17], "amx_int8": [0, 17], "prefetchw": [0, 17], "prefetchwt1": [0, 17], "intel optim": 1, "intel\u00ae extension for pytorch*": 1, "gpu": [1, 3, 18, 33], "discrete gpu": 1, "intel discrete gpu": 1, "extend": [1, 18, 24, 32], "latest": [1, 24, 27, 29, 33], "perform": [1, 2, 3, 4, 6, 7, 8, 9, 10, 13, 14, 15, 18, 19, 21, 24, 27, 28, 30], "optim": [1, 3, 4, 6, 8, 9, 11, 12, 14, 16, 18, 20, 21, 22, 24, 25, 30, 31, 32, 33], "take": [1, 2, 7, 8, 10, 12, 13, 14, 18, 21, 24, 25, 29, 30, 32], "advantag": [1, 2, 7, 9, 12, 18, 21, 24, 29, 30, 32], "advanc": [1, 2, 6, 7, 16, 24, 27], "512": [1, 6, 11, 16, 24, 27, 30], "neural": [1, 3, 7, 16, 24, 27, 32, 33], "network": [1, 3, 7, 8, 20, 24, 27, 32], "matrix": [1, 6, 7, 24, 27], "cpu": [1, 3, 4, 5, 6, 7, 8, 10, 14, 15, 16, 19, 20, 22, 24, 25, 27, 29, 30, 31, 33], "well": [1, 2, 5, 6, 7, 20, 21, 23, 27, 31, 32, 33], "xmx": 1, "ai": [1, 3, 7, 27], "engin": [1, 6, 18, 32], "discret": 1, "moreov": [1, 2, 27], "provid": [1, 2, 5, 6, 7, 8, 11, 12, 13, 14, 16, 20, 23, 25, 27, 28, 30, 31, 32, 33], "easi": [1, 3, 21], "acceler": [1, 2, 3, 6, 7, 13, 27, 28, 29, 33], "through": [1, 2, 6, 7, 8, 12, 24, 32, 33], "xpu": [1, 2, 3, 33], "devic": [1, 2, 15, 28, 30, 33], "technolog": [1, 7, 27], "landscap": [1, 7, 27], "genai": [1, 7, 27], "workload": [1, 6, 7, 8, 10, 11, 12, 21, 25, 27, 28, 29, 30, 32, 33], "model": [1, 2, 3, 4, 8, 9, 10, 11, 12, 14, 16, 22, 23, 24, 25, 28, 29, 32, 33], "gain": [1, 7, 25, 27, 33], "widespread": [1, 7, 27], "attent": [1, 7, 27, 33], "popular": [1, 7, 27, 29], "larg": [1, 2, 6, 19, 23, 24, 25, 28, 29, 32, 33], "languag": [1, 2, 23, 24, 25, 28, 33], "llm": [1, 2, 23, 24, 28, 33], "emerg": [1, 7, 27], "domin": [1, 7, 27], "drive": [1, 7, 27], "applic": [1, 7, 20, 27, 31, 32], "start": [1, 3, 4, 5, 6, 7, 10, 20, 23, 33], "specif": [1, 2, 5, 6, 7, 12, 18, 20, 25, 27, 30, 32, 33], "certain": [1, 7, 25, 28, 30, 32], "introduc": [1, 3, 7, 15, 18, 21, 30, 32, 33], "section": [1, 6, 7, 8, 14, 20, 22, 23, 24, 27, 28, 31, 32, 33], "program": [1, 5, 7, 11, 20, 30, 32, 33], "user": [1, 2, 7, 9, 10, 12, 13, 15, 16, 18, 20, 25, 30, 31, 32, 33], "enabl": [1, 2, 3, 4, 6, 7, 8, 10, 13, 18, 20, 27, 30, 31, 32, 33], "dynam": [1, 4, 20, 27, 31, 32, 33], "featur": [1, 2, 3, 5, 8, 10, 13, 14, 18, 20, 22, 24, 25, 27, 29, 30, 31, 32, 33], "packag": [1, 5, 6, 7, 10, 22, 24, 25, 31, 32, 33], "newer": [1, 27, 32], "code": [1, 2, 5, 6, 7, 10, 11, 12, 13, 18, 19, 21, 22, 23, 25, 26, 28, 32, 33], "develop": [1, 3, 6, 29, 32, 33], "schedul": [1, 2, 13, 20, 30, 32], "open": [1, 16, 32], "project": [1, 6], "github": [1, 5, 6, 7, 8, 33], "find": [1, 2, 6, 7, 14, 22, 25, 29, 30, 33], "main": [1, 5, 6, 14, 20, 30, 31], "branch": [1, 7, 29], "quick": [1, 20, 23, 24], "about": [1, 2, 5, 7, 13, 16, 31, 32, 33], "product": [1, 7, 14, 27, 33], "structur": [1, 18, 30], "shown": [1, 6, 18, 27, 30, 31], "figur": [1, 21, 27, 32], "eager": [1, 7, 12, 31, 33], "mode": [1, 2, 5, 7, 10, 12, 18, 20, 25, 31, 33], "frontend": [1, 2, 7, 20, 27, 33], "custom": [1, 2, 7, 25, 27, 33], "fusion": [1, 2, 7, 10, 21, 27, 33], "quantiz": [1, 3, 4, 13, 16, 25, 27, 29, 31, 33], "api": [1, 3, 6, 10, 11, 15, 20, 25, 27, 32, 33], "further": [1, 2, 5, 6, 7, 18, 20, 27, 32, 33], "improv": [1, 3, 7, 8, 13, 20, 27, 29, 31, 32], "achiev": [1, 2, 6, 7, 27, 32, 33], "graph": [1, 4, 6, 8, 10, 22, 25, 30, 33], "reduc": [1, 2, 7, 15, 19, 20, 21, 25, 27, 32, 33], "oper": [1, 2, 6, 8, 13, 15, 21, 31, 32, 33], "kernel": [1, 2, 7, 17, 20, 25, 27, 29, 32, 33], "invoc": [1, 7], "overhead": [1, 2, 7, 10, 19, 20, 25, 27, 32, 33], "result": [1, 10, 12, 14, 18, 20, 21, 29, 30, 31, 32], "compar": [1, 2, 7, 13, 18, 21, 25, 27, 29, 30, 32, 33], "normal": [1, 6, 7, 13, 20, 27, 32, 33], "yield": [1, 7, 32], "better": [1, 2, 7, 15, 18, 20, 27, 30, 31, 32, 33], "techniqu": [1, 2, 7, 11, 12, 27, 33], "like": [1, 2, 3, 5, 6, 7, 8, 14, 18, 19, 21, 25, 27, 30, 32, 33], "amplifi": 1, "them": [1, 5, 7, 18, 19, 27, 30, 32], "comprehens": 1, "both": [1, 2, 6, 7, 11, 18, 19, 21, 27, 28, 30, 31, 32, 33], "torchscript": [1, 2, 5, 7, 10, 12, 19, 22, 25, 31, 33], "torchdynamo": [1, 7, 12, 22, 33], "With": [1, 2, 7, 10, 20, 30, 33], "recommend": [1, 5, 6, 7, 9, 10, 15, 16, 20, 22, 29, 30, 32, 33], "torch": [1, 2, 4, 6, 8, 10, 11, 12, 13, 15, 16, 18, 20, 22, 25, 28, 31, 32, 33], "jit": [1, 2, 5, 6, 7, 8, 13, 15, 16, 18, 20, 22, 25, 31, 33], "trace": [1, 6, 7, 8, 12, 13, 15, 16, 20, 22, 25, 31, 33], "your": [1, 5, 6, 7, 8, 10, 14, 15, 20, 22, 23, 25, 26, 28, 33], "prefer": [1, 7, 8, 15, 23], "option": [1, 2, 5, 7, 10, 14, 15, 27, 28, 30, 33], "wider": 1, "rang": [1, 7, 15, 16, 19, 21, 25, 30, 31, 33], "good": [1, 2, 5, 7, 12, 18, 19, 27, 32, 33], "On": [1, 2, 7, 18, 27, 32], "automat": [1, 2, 6, 7, 9, 10, 12, 13, 15, 18, 27, 30, 31, 32, 33], "dispatch": [1, 33], "isa": [1, 33], "leverag": [1, 7, 11, 27, 31, 33], "unit": [1, 32], "offer": [1, 5, 32], "finer": [1, 7, 20], "grain": [1, 3, 7, 20], "thread": [1, 2, 7, 20, 25, 29, 30, 31, 32, 33], "control": [1, 2, 7, 20, 25, 30, 32, 33], "weight": [1, 2, 6, 7, 10, 12, 13, 15, 18, 20, 27, 33], "share": [1, 5, 6, 20, 31, 32, 33], "increas": [1, 2, 3, 21, 25, 27, 29, 32, 33], "effici": [1, 7, 11, 19, 20, 27, 30, 32, 33], "implement": [1, 5, 7, 11, 19, 25, 32, 33], "These": [1, 5, 6, 7, 8, 13, 27], "calcul": [1, 2, 8, 21], "util": [1, 6, 7, 10, 13, 15, 16, 18, 21, 27, 30, 32, 33], "dpc": 1, "compil": [1, 5, 6, 22, 25, 32, 33], "sycl": 1, "standard": [1, 33], "also": [1, 2, 6, 7, 10, 13, 14, 18, 19, 27, 29, 30, 32, 33], "number": [1, 2, 5, 6, 7, 14, 19, 20, 21, 25, 31, 33], "found": [1, 6, 7, 14, 18, 28, 30, 31, 32, 33], "doc": [1, 5, 11, 28, 33], "directori": [1, 5, 6, 14, 28, 30, 31], "team": [1, 5], "track": 1, "bug": [1, 5, 33], "enhanc": [1, 3, 27, 33], "request": [1, 5, 20, 31], "issu": [1, 2, 5, 8, 21, 25, 32], "submit": [1, 5, 7, 20], "suggest": [1, 2, 15, 18, 20, 32, 33], "search": [1, 4, 5, 7, 27, 30], "exist": [1, 5, 7, 13, 25, 30, 32], "see": [1, 2, 5, 7, 8, 14, 33], "alreadi": [1, 5, 6, 18, 27, 32], "none": [2, 28, 30], "level": [2, 7, 10, 13, 18, 20, 21, 25, 27, 32, 33], "o1": [2, 25, 33], "inplac": [2, 4, 6, 13, 15, 16, 18, 31], "conv_bn_fold": [2, 25, 33], "linear_bn_fold": 2, "weights_prepack": [2, 6, 7, 22, 25], "replace_dropout_with_ident": 2, "optimize_lstm": 2, "split_master_weight_for_bf16": 2, "fuse_update_step": 2, "auto_kernel_select": [2, 7, 29], "sample_input": [2, 9, 33], "graph_mod": [2, 4, 7, 12, 33], "concat_linear": 2, "appli": [2, 6, 7, 8, 12, 13, 18, 19, 21, 22, 25, 27, 28, 30, 33], "given": [2, 13, 14, 27], "nn": [2, 6, 7, 8, 10, 13, 15, 16, 18, 20, 25, 33], "train": [2, 3, 4, 7, 11, 13, 15, 16, 18, 21, 22, 27, 28, 30, 33], "otherwis": [2, 7, 20], "infer": [2, 3, 4, 7, 10, 11, 12, 15, 18, 20, 21, 25, 29, 32, 33], "conv": [2, 8, 10, 13, 15, 16, 20, 25, 33], "bn": [2, 10, 15, 16, 25, 33], "fold": [2, 10, 15, 16, 25, 33], "prepack": [2, 6, 10, 18, 27, 33], "cach": [2, 5, 7, 19, 20, 29, 33], "reus": [2, 32], "memori": [2, 6, 7, 8, 9, 10, 13, 19, 20, 21, 25, 27, 29, 31, 33], "layout": [2, 25, 33], "block": [2, 5, 20, 27, 32, 33], "although": [2, 32], "itself": [2, 5, 18], "enough": [2, 7, 19], "usag": [2, 6, 7, 8, 22, 24, 31, 32, 33], "perspect": [2, 13, 18, 21, 27, 30, 32], "drawback": [2, 21], "run": [2, 4, 5, 6, 7, 8, 10, 12, 14, 16, 20, 25, 29, 30, 31, 32, 33], "one": [2, 5, 7, 12, 13, 14, 18, 19, 20, 25, 28, 30, 32, 33], "sever": [2, 7, 10, 19, 29, 30, 33], "dimens": [2, 18], "fix": [2, 5, 7, 25, 33], "mermori": 2, "format": [2, 5, 6, 7, 9, 14, 25, 27, 30, 32, 33], "manual": [2, 7, 10, 14, 18, 20, 33], "predefin": 2, "shape": [2, 7, 16, 20, 29, 32, 33], "prior": [2, 22], "requir": [2, 5, 6, 8, 10, 16, 18, 21, 25, 27, 28, 30, 31, 33], "convers": [2, 8, 13, 33], "directli": [2, 6, 32, 33], "go": [2, 5, 8], "methodologi": [2, 6, 7, 19, 32], "possibl": [2, 14, 15, 19, 27, 32, 33], "avoid": [2, 10, 20, 21, 25, 30, 31, 32, 33], "thu": [2, 7, 8, 10, 18, 20, 21, 27, 30, 31, 32], "k": [2, 5], "float16": [2, 8], "cast": [2, 8, 21, 27], "accord": [2, 13, 27, 32, 33], "do": [2, 5, 8, 16, 18, 20, 21, 25, 27, 29, 30, 31, 32, 33], "noth": 2, "conv2d": [2, 7, 8, 10, 13, 18, 20, 25, 33], "linear": [2, 6, 7, 8, 13, 15, 16, 18, 25, 32, 33], "convtranspose2d": [2, 13], "embed": [2, 7, 27, 33], "lstm": [2, 10, 15, 33], "sgd": [2, 6, 7, 8, 16, 19], "string": [2, 30], "o0": [2, 25, 33], "No": [2, 6, 18, 33], "just": [2, 14, 28, 33], "dropout": [2, 10], "remov": [2, 5, 21, 33], "inferenc": 2, "master": [2, 7, 21, 30], "fuse": [2, 7, 13, 19, 27, 33], "updat": [2, 5, 7, 19, 21, 33], "step": [2, 5, 6, 7, 8, 14, 16, 19, 21, 31], "explicitli": [2, 8, 20, 25, 30, 33], "bool": [2, 14], "whether": [2, 8, 18, 32], "conv_bn": 2, "knob": [2, 4, 12, 30], "overwrit": [2, 30], "linear_bn": 2, "convolut": [2, 6, 7, 13, 20, 32, 33], "reorder": [2, 18, 27], "now": [2, 7, 15, 18, 31, 32, 33], "doesn": [2, 15, 16, 18, 25, 33], "replac": [2, 5, 7, 10, 25, 33], "ident": [2, 10, 18], "aten": [2, 6, 7, 33], "opportunit": 2, "save": [2, 5, 6, 7, 13, 14, 15, 16, 18, 21, 27, 31, 33], "solut": [2, 25, 27, 33], "param": [2, 19, 30], "feed": [2, 9, 18], "impact": [2, 7, 20], "pack": [2, 20, 33], "intel": [2, 3, 4, 7, 8, 9, 10, 11, 13, 14, 16, 17, 20, 21, 22, 24, 25, 26, 27, 28, 33], "extens": [2, 3, 4, 6, 9, 10, 11, 13, 14, 16, 17, 22, 23, 24, 26, 27, 28, 29, 30, 32, 33], "pytorch": [2, 3, 4, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33], "per": [2, 10, 15, 20, 29, 30, 31, 32, 33], "heurist": [2, 20, 33], "real": [2, 7, 14, 15, 29, 33], "try": [2, 5, 6, 7, 12, 14, 16, 25, 30, 32, 33], "select": [2, 5, 6, 7, 13, 23, 33], "might": [2, 7, 18, 25, 32, 33], "cost": [2, 27, 29, 32], "extra": [2, 5, 10, 20, 27, 30, 31], "combin": [2, 12, 14, 30, 33], "method": [2, 8, 15, 18, 25, 32, 33], "subgraph": 2, "modifi": [2, 5, 27], "place": [2, 8, 27, 32, 33], "scenario": [2, 7, 18, 32, 33], "convolutuon": 2, "counterpart": [2, 7, 18, 33], "pleas": [2, 6, 25, 30, 32, 33], "invok": [2, 6, 8, 10, 13, 20, 22, 25, 28, 33], "ddp": [2, 6], "distribut": [2, 3, 7, 30, 31, 32], "deepcopi": 2, "rather": [2, 18], "allreduc": 2, "caus": [2, 21, 25, 27, 30, 32, 33], "unpredict": 2, "accuraci": [2, 3, 7, 8, 15, 16, 21, 25, 27, 33], "loss": [2, 5, 6, 8, 16, 18, 21, 25], "exampl": [2, 5, 7, 8, 13, 18, 19, 21, 22, 23, 24, 27, 28, 31, 32, 33], "load_state_dict": [2, 33], "path": [2, 6, 7, 14, 18, 20, 30, 32, 33], "eval": [2, 4, 6, 8, 10, 11, 12, 13, 15, 16, 20, 22, 25, 28, 31, 33], "optimized_model": [2, 33], "evalu": [2, 16, 33], "optimized_optim": 2, "altern": [2, 6, 18], "motiv": [2, 20], "ad": [2, 7, 10, 32, 33], "alia": 2, "unifi": [2, 30], "style": [2, 5], "modular": 2, "optimize_transform": [2, 27, 28, 33], "float32": [2, 13, 21, 29, 30, 33], "quantization_config": [2, 28], "qconfig_summary_fil": [2, 28], "low_precision_checkpoint": [2, 28], "deployment_mod": 2, "transform": [2, 3, 4, 6, 10, 11, 13, 16, 18, 27, 31, 32, 33], "focu": [2, 10, 18, 28, 33], "especi": [2, 5, 27, 33], "task": [2, 7, 27, 30, 32, 33], "famili": [2, 27, 32], "llama": [2, 3, 27], "gpt": [2, 27, 29], "neox": [2, 27], "falcon": [2, 27], "codegen": [2, 33], "when": [2, 5, 6, 7, 8, 9, 14, 18, 19, 20, 21, 24, 25, 27, 29, 30, 31, 32, 33], "mix": [2, 6, 13, 25, 27, 33], "str": [2, 14, 30], "curentlti": 2, "recip": [2, 4, 7, 13, 15, 25, 27, 33], "quant": 2, "static": [2, 4, 25, 27, 30, 31, 32, 33], "quantizat": 2, "config": [2, 6, 11, 27, 30, 31], "json": [2, 15, 16, 27, 31, 33], "under": [2, 6, 8, 18, 20, 26, 30, 33], "calibr": [2, 13, 25, 28, 29, 31, 33], "dict": 2, "int4": [2, 27, 28, 33], "": [2, 3, 5, 8, 10, 14, 15, 18, 19, 20, 21, 25, 30, 31, 32], "should": [2, 5, 8, 15, 20, 27, 30, 32], "state_dict": [2, 6], "checkpoint": [2, 6, 28], "pt": [2, 6, 13, 14, 15, 31, 33], "gptq": 2, "where": [2, 5, 7, 21, 32], "specifi": [2, 5, 14, 20, 30, 32, 33], "kei": [2, 7, 27, 33], "scale": [2, 3, 15, 27], "zero": [2, 15, 33], "point": [2, 8, 15, 21, 32, 33], "bia": [2, 8, 20, 33], "weight_kei": 2, "packed_weight": 2, "scale_kei": 2, "zero_point_kei": 2, "packed_zp": 2, "bias_kei": 2, "n": [2, 6, 7, 16, 18, 19, 20, 25, 31, 32, 33], "thei": [2, 7, 8, 27, 30, 32], "uint4": 2, "compress": 2, "along": [2, 5, 21, 32, 33], "int32": 2, "state": [2, 15, 19, 27], "channel": [2, 3, 10, 15, 25, 33], "group": [2, 19, 20, 32], "automaticlli": 2, "deploy": [2, 7, 13, 33], "torchscirpt": 2, "workabl": 2, "forward": [2, 6, 8, 13, 16, 20, 21, 25, 31, 32, 33], "after": [2, 5, 7, 13, 20, 21, 22, 23, 31, 32, 33], "deepspe": [2, 27], "parallel": [2, 5, 6, 7, 27, 32, 33], "class": [2, 5, 7, 8, 10, 16, 20, 25, 33], "verbos": [2, 4, 30], "demand": [2, 7], "easier": [2, 18, 21], "debug": [2, 17, 30], "dump": [2, 30], "messag": [2, 6, 10, 12, 18, 30], "durat": [2, 21], "while": [2, 7, 8, 12, 18, 21, 25, 27, 31, 32, 33], "via": [2, 5, 7, 18, 20, 27, 29, 30, 32, 33], "dnnl_verbos": 2, "howev": [2, 5, 7, 8, 9, 20, 25, 27, 30, 32, 33], "those": [2, 15, 27, 32], "amount": [2, 25, 27, 32], "investig": [2, 30], "singl": [2, 7, 13, 14, 19, 20, 27, 29, 31, 33], "iter": [2, 21, 27, 33], "scope": [2, 7, 8, 21, 33], "out": [2, 5, 6, 7, 8, 10, 13, 16, 19, 20, 29, 30, 32, 33], "second": [2, 10, 27, 31, 32], "verbose_on": 2, "verbose_off": 2, "disabl": [2, 6, 7, 13, 25, 30, 32, 33], "verbose_on_cr": 2, "creation": 2, "fast_bert": [2, 4, 6, 7, 11, 33], "unpad": 2, "tpp": [2, 27], "speedup": [2, 8, 27, 29, 33], "still": [2, 5, 7, 8, 13, 16, 18, 21, 25, 33], "squenc": 2, "sparsiti": 2, "seed": 2, "libxsmm": 2, "tpp_bert": 2, "arg": [2, 4, 7, 14, 19, 30, 31, 33], "enable_onednn_fus": [2, 13], "get_smooth_quant_qconfig_map": [2, 28], "alpha": [2, 19], "act_observ": 2, "act_ic_observ": 2, "wei_observ": 2, "wei_ic_observ": 2, "share_weight_observ": 2, "smoothquant": [2, 27, 33], "http": [2, 5, 16, 33], "arxiv": 2, "org": [2, 7, 16, 25, 33], "pdf": 2, "2211": 2, "10438": 2, "hyper": [2, 29, 32, 33], "observ": [2, 9, 13, 15, 33], "activ": [2, 6, 15, 20, 27, 30, 32], "op": [2, 7, 15, 27, 33], "histogramobserv": [2, 15], "q": [2, 27], "min": [2, 25, 33], "affect": [2, 30], "argument": [2, 30], "ao": [2, 6, 15], "minmaxobserv": [2, 6, 15], "perchannelminmaxobserv": [2, 6, 15], "with_arg": [2, 6, 15], "ch_axi": 2, "factor": [2, 30], "qint8": [2, 6, 15, 28], "qscheme": [2, 6, 15, 33], "per_channel_symmetr": [2, 6, 15], "qconfig": [2, 4, 6, 13, 16, 25, 28, 31, 33], "prepar": [2, 4, 6, 13, 16, 25, 28, 31, 33], "example_input": [2, 4, 6, 13, 15, 16, 28, 31, 33], "bn_fold": 2, "example_kwarg_input": 2, "init": [2, 5, 15, 16], "insert": 2, "fake": 2, "introduct": [2, 7, 27, 32], "avaiabl": 2, "page": [2, 13, 20, 23, 28, 29, 32, 33], "autotun": [2, 4, 16, 33], "prepared_model": [2, 4, 6, 13, 15, 16, 25, 28, 33], "calib_dataload": [2, 33], "eval_func": [2, 33], "sampling_s": [2, 4, 16, 33], "accuracy_criterion": [2, 4, 16, 33], "tuning_tim": [2, 4, 16, 33], "driven": 2, "tune": [2, 3, 4, 7, 8, 15, 20, 25, 30, 31, 33], "quickli": 2, "dataload": [2, 6, 10, 13, 16, 20, 28, 33], "entir": [2, 27], "process": [2, 7, 11, 12, 14, 19, 20, 21, 27, 30, 31, 32], "self": [2, 8, 10, 16, 20, 25, 33], "metric": [2, 29], "scalar": 2, "list": [2, 5, 7, 8, 13, 14, 18, 24, 27, 28, 30, 31, 32], "algorithm": [2, 13, 18, 29, 33], "explor": 2, "accuracy_criterion_typ": 2, "rel": [2, 4, 16, 30, 33], "absolut": [2, 30], "accuracy_criterion_valu": 2, "allow": [2, 8, 14, 30, 32], "either": [2, 25, 30], "01": [2, 4, 7, 16, 30, 31, 33], "timeout": [2, 5, 21], "earli": [2, 33], "stop": [2, 32], "is_runtime_ext_en": 2, "helper": 2, "check": [2, 5, 6, 7, 13, 18, 27, 28, 30, 33], "exetens": 2, "openmp": [2, 7, 20, 25, 29, 31, 33], "preload": [2, 30], "cpupool": [2, 20, 33], "core_id": [2, 20, 30], "node_id": [2, 20, 30, 31, 33], "abstract": [2, 11, 20], "pool": [2, 20, 33], "intra": 2, "id": [2, 27, 30, 31], "numa": [2, 20, 30, 31, 33], "node": [2, 20, 29, 31, 32, 33], "pin": [2, 20], "cpu_pool": [2, 20, 33], "def": [2, 8, 10, 16, 20, 25, 33], "design": [2, 5, 8, 18, 21, 28, 33], "context": [2, 5, 8, 20, 27, 32], "decor": 2, "multistreammodulehint": [2, 20, 33], "kwarg": [2, 28], "hint": [2, 20], "multistreammodul": [2, 7, 20, 25, 33], "concat": [2, 20, 25, 27, 33], "output": [2, 6, 7, 8, 13, 14, 18, 25, 33], "dim": [2, 6, 18], "length": [2, 5, 14, 21, 25, 29, 33], "arbitrari": 2, "keyword": 2, "num_stream": [2, 20, 33], "concat_output": 2, "input_split_hint": [2, 20], "multi_stream": 2, "output_concat_hint": [2, 20], "multi": [2, 7, 14, 20, 30, 32, 33], "stream": [2, 7, 20, 33], "throughput": [2, 3, 18, 20, 25, 27, 29, 33], "insid": [2, 5, 20, 30], "divis": [2, 20], "alloc": [2, 10, 20, 27, 29, 31, 33], "equal": [2, 15, 20, 31, 32], "remaind": [2, 20], "first": [2, 3, 5, 6, 7, 9, 10, 12, 16, 19, 20, 21, 25, 30, 31, 32], "divisor": [2, 20], "batchsiz": [2, 20], "larger": [2, 20, 29, 32], "piec": [2, 20], "less": [2, 8, 18, 20, 25, 33], "mini": [2, 20, 33], "batch": [2, 6, 7, 13, 16, 18, 20, 25, 29, 31, 33], "num": [2, 20, 31, 32, 33], "leav": [2, 20, 32], "scriptmodul": [2, 13, 20], "union": 2, "instanc": [2, 7, 10, 14, 27, 31, 33], "usual": [2, 7, 18, 20, 32], "reason": [2, 10, 18, 20, 33], "indic": [2, 7, 18, 27], "concaten": [2, 21], "raw": 2, "comput": [2, 6, 7, 13, 15, 16, 18, 20, 21, 27, 29, 30, 31, 32, 33], "asynchron": [2, 7], "get_core_list_of_node_id": 2, "softwar": [3, 26, 33], "jul": 3, "2023": [3, 29], "deep": [3, 7, 8, 11, 13, 14, 21, 32], "learn": [3, 7, 8, 11, 13, 14, 21, 30, 32], "boost": [3, 6, 7, 9, 21, 29, 30, 32, 33], "dl": [3, 7, 33], "hug": 3, "face": 3, "bert": [3, 4, 10, 27, 29, 33], "googl": [3, 5, 6], "cloud": 3, "platform": [3, 7, 18, 31, 32, 33], "gcp": 3, "technologi": [3, 7], "apr": 3, "mar": [3, 31], "x86": 3, "sapphir": 3, "rapid": 3, "part": [3, 5, 7, 8, 18, 21, 25, 32, 33], "jan": 3, "secur": 3, "torchserv": 3, "confer": 3, "dec": 3, "2022": [3, 30, 31], "what": [3, 5, 8], "pyg": 3, "stabl": [3, 8, 33], "diffus": [3, 33], "arc": 3, "nov": 3, "potenti": [3, 7, 33], "fine": [3, 20, 30, 31, 32, 33], "fx": [3, 7, 10, 25, 33], "empow": 3, "xeon": [3, 7, 14, 21, 27, 29, 31, 32, 33], "scalabl": [3, 7, 21, 27, 29, 32, 33], "processor": [3, 7, 19, 21, 27, 29, 32, 33], "aug": [3, 29], "vision": [3, 6, 29], "last": [3, 10, 21, 25, 33], "One": [3, 18, 19, 30, 32], "click": 3, "compressor": [3, 7, 16, 33], "4x": 3, "jun": 3, "grokk": 3, "principl": [3, 18], "kt": 3, "person": 3, "text": [3, 25, 27, 29, 32], "speech": [3, 32], "up": [3, 7, 11, 20, 23, 27, 32, 33], "modern": 3, "naver": 3, "low": [3, 4, 7, 21, 22, 25, 30, 32, 33], "latenc": [3, 14, 18, 27, 29, 31, 33], "feb": 3, "dlrm": [3, 7, 25, 29, 33], "oneccl": [3, 6, 30, 33], "mention": [3, 10, 20, 21, 33], "deprec": [3, 25], "facebook": [3, 27], "3rd": [3, 7, 21, 29, 33], "gen": [3, 29, 33], "2020": 3, "collabor": 3, "2019": 3, "caff": 3, "2017": 3, "command": [4, 5, 6, 14, 22, 30, 31, 32, 33], "descript": [4, 7, 18, 20, 24, 32, 33], "basic": [4, 16, 21, 32], "instal": [4, 5, 6, 22, 24, 25, 27, 32, 33], "m": [4, 14, 20, 25, 30, 31, 32, 33], "pip": [4, 5, 33], "captur": [4, 33], "log": [4, 13, 30, 31, 33], "prompt": 4, "export": [4, 30, 32], "onednn_verbos": 4, "dure": [4, 6, 7, 10, 13, 21, 30, 32, 33], "precis": [4, 6, 13, 21, 22, 25, 29, 33], "no_grad": [4, 6, 10, 11, 12, 13, 15, 16, 20, 22, 25, 28, 31, 33], "amp": [4, 6, 10, 22, 25, 33], "autocast": [4, 6, 7, 10, 22, 33], "experiment": [4, 13, 20, 22, 25, 33], "fast": [4, 12, 27, 32, 33], "bertmodelmodel": 4, "bertmodel": [4, 6, 11, 31], "from_pretrain": [4, 6, 11, 28, 31], "uncas": [4, 6, 10, 11, 31, 33], "launch": [4, 20, 31, 33], "autom": [4, 7, 8, 14, 30, 31, 33], "ipexrun": [4, 10, 30, 33], "lt": [4, 29], "your_pytorch_script": [4, 30], "gt": [4, 14, 32], "hypertun": [4, 33], "hyperparamet": [4, 7], "conf": [4, 13, 14, 30, 33], "your_conf_fil": [4, 33], "your_python_script": [4, 33], "post": [4, 5, 15, 27, 33], "default_static_qconfigprepared_model": 4, "anyplac": 4, "d": [4, 5, 6, 7, 8, 13, 25, 27, 33], "calibration_data_load": [4, 6, 13], "converted_model": [4, 6, 25, 33], "default_dynamic_qconfigprepared_model": 4, "tuned_model": [4, 16, 33], "eval_funct": 4, "convert_model": [4, 13, 15, 16], "thank": 5, "interest": 5, "begin": 5, "intent": 5, "propos": [5, 7, 11, 18, 21], "intend": 5, "shall": [5, 18, 32], "discuss": [5, 18, 32], "agre": 5, "plan": [5, 7, 10], "look": [5, 14, 18], "ahead": 5, "outstand": 5, "pick": 5, "particular": [5, 6, 8, 28, 33], "ask": 5, "pull": 5, "com": [5, 33], "full": [5, 18, 31, 32, 33], "uninstal": 5, "ll": [5, 31, 32], "know": 5, "warn": [5, 6, 12, 30, 31], "few": [5, 7, 9, 13, 18, 31, 33], "alwai": [5, 7, 8, 18, 30, 32, 33], "loop": [5, 21, 28], "re": [5, 8, 31, 32], "feel": [5, 18, 33], "lazi": 5, "ye": 5, "clone": 5, "git": 5, "cd": [5, 6], "rebas": [5, 33], "submodul": 5, "sync": [5, 20], "recurs": 5, "job": 5, "setup": [5, 27, 33], "py": [5, 10, 14, 20, 27, 30, 31, 33], "symlink": 5, "tree": [5, 6], "reinstal": [5, 25], "again": [5, 19, 31], "__init__": [5, 8, 10, 16, 20, 25, 33], "repeatedli": 5, "interfac": [5, 6, 18, 25, 27], "pyi": 5, "non": [5, 8, 13, 18, 29, 31, 33], "cpp": [5, 6, 17, 32], "cu": 5, "h": [5, 6, 7, 16, 18, 25, 30, 31], "sure": [5, 14, 15, 31, 32], "until": [5, 20, 21, 32], "next": [5, 7, 33], "clean": 5, "maco": 5, "homebrew": 5, "brew": 5, "our": [5, 19, 27, 32, 33], "6": [5, 7, 11, 14, 20, 29, 30, 31, 32, 33], "error": [5, 6, 10, 16, 18, 21, 25, 33], "printf": 5, "stdio": [5, 30], "nint": 5, "hello": 5, "world": [5, 7], "clang": 5, "simpl": [5, 7, 8, 11, 18, 32, 33], "without": [5, 7, 8, 10, 16, 20, 21, 25, 31, 33], "folder": 5, "mani": [5, 14, 30, 32], "wai": [5, 10, 18, 27, 33], "rm": 5, "rf": 5, "toplevel": 5, "over": [5, 7, 8, 9, 18, 29, 30, 33], "made": [5, 33], "edit": [5, 25, 33], "repo": [5, 6, 7], "commit": 5, "keep": [5, 12, 18, 21, 27, 31, 32, 33], "realli": 5, "untrack": 5, "deinit": 5, "f": [5, 6, 13, 16, 27, 33], "xdf": 5, "veri": [5, 15, 18, 27], "within": [5, 21, 28, 32, 33], "experi": [5, 7, 10, 12, 18, 25, 32, 33], "env_key1": 5, "env_val1": 5, "env_key2": 5, "env_val2": 5, "suit": 5, "test_": 5, "individu": [5, 29], "filenam": 5, "repres": [5, 7, 21], "wish": [5, 7], "test_jit": 5, "narrow": 5, "down": [5, 31, 33], "even": [5, 7, 32], "testclassnam": 5, "testnam": 5, "let": [5, 10, 18, 19, 20, 21], "sai": 5, "test_sequenti": 5, "testjit": 5, "expecttest": 5, "hypothesi": 5, "mypi": 5, "conda": [5, 32], "offici": [5, 31, 32, 33], "unittest": 5, "substr": 5, "test_nn": 5, "v": 5, "abov": [5, 10, 19, 27, 29, 30, 31], "testnn": 5, "test_bceloss": 5, "test_mseloss": 5, "keystrok": 5, "ci": 5, "quicklint": 5, "aren": 5, "setup_lint": 5, "makefil": 5, "complet": [5, 6, 14, 18, 28, 32], "tab": 5, "trail": [5, 21], "newlin": 5, "quick_check": 5, "flake8": 5, "cmakelint": 5, "tidi": 5, "add": [5, 7, 8, 13, 14, 17, 19, 21, 25, 31, 33], "changed_onli": 5, "framework": 5, "runner": 5, "gtest_filt": 5, "testsuit": 5, "maycontainalia": 5, "containeraliasingtest": 5, "test_alias_analysi": 5, "docstr": 5, "line": [5, 10, 13, 18, 30, 31, 32], "limit": [5, 6, 8, 10, 20, 25, 31, 32, 33], "80": [5, 29, 30], "charact": 5, "fit": [5, 7, 32], "jupyt": 5, "popup": 5, "prerequisit": [5, 6], "r": [5, 7, 14, 29, 31, 32], "txt": [5, 6, 31], "html": [5, 16], "_build": 5, "rst": 5, "live": 5, "tutori": [5, 6, 15, 16, 33], "autofunct": 5, "autoclass": 5, "direct": [5, 13], "shorten": 5, "index": [5, 18, 27, 32], "sphinx": 5, "produc": [5, 8], "miss": 5, "demonstr": [6, 18, 25, 31], "box": [6, 10, 32], "benefit": [6, 7, 8, 10, 11, 20, 21, 27, 31, 32, 33], "torchvis": [6, 10, 12, 13, 16, 18, 31, 33], "against": 6, "below": [6, 8, 10, 14, 19, 20, 21, 22, 25, 27, 30, 31, 32, 33], "criterion": [6, 8], "zero_grad": [6, 7, 16], "lr": [6, 7, 8, 16, 19], "001": [6, 8], "download": [6, 13, 16], "dataset": [6, 13, 16, 28, 29, 32, 33], "cifar10": [6, 13], "compos": [6, 13], "resiz": [6, 13], "224": [6, 8, 10, 12, 13, 29, 31, 33], "totensor": [6, 13, 16], "train_dataset": [6, 13], "train_load": [6, 8], "batch_siz": [6, 11, 13, 16, 18, 31], "128": [6, 8, 10, 13, 20, 29, 33], "crossentropyloss": [6, 16], "momentum": [6, 10, 21], "uncom": 6, "batch_idx": [6, 13], "enumer": [6, 13, 16, 28], "backward": [6, 7, 8, 16, 21, 32, 33], "model_state_dict": 6, "optimizer_state_dict": 6, "pth": 6, "finish": [6, 11, 12, 13, 16, 20], "oneapi": [6, 32], "collect": [6, 31, 32, 33], "commun": [6, 30, 31, 32, 33], "bind": [6, 7, 30, 31, 32, 33], "dist": 6, "oneccl_bindings_for_pytorch": 6, "torch_ccl": 6, "master_addr": 6, "127": [6, 30, 33], "master_port": 6, "29500": [6, 30], "rank": [6, 30], "pmi_rank": 6, "world_siz": [6, 28], "pmi_siz": [6, 28], "init_process_group": 6, "ccl": [6, 30, 33], "init_method": 6, "env": [6, 28], "distributeddataparallel": 6, "batch_id": 6, "bring": [6, 7, 9, 15, 16, 21, 27, 30, 32, 33], "nlp": [6, 7, 25, 29, 33], "resnet50_weight": [6, 12, 13], "rand": [6, 8, 12, 13, 20, 25, 33], "noqa": [6, 11, 12, 13, 16, 28], "f401": [6, 11, 12, 13, 16, 28], "vocab_s": [6, 11, 31], "seq_length": [6, 11, 31], "randint": [6, 11, 31], "freez": [6, 8, 10, 13, 15, 16, 20, 22, 25, 31, 33], "check_trac": [6, 13, 31], "strict": [6, 31], "sinc": [6, 7, 18, 19, 20, 21, 25, 32, 33], "manual_se": [6, 11], "43": [6, 11, 30, 31], "instanti": 6, "qconfig_map": 6, "default_static_qconfig_map": 6, "own": [6, 15], "qconfigmap": 6, "per_tensor_affin": [6, 15, 33], "quint8": [6, 15], "set_glob": 6, "traced_model": [6, 10, 13, 15, 16, 25, 33], "quantized_model": [6, 13, 15, 33], "default_dynamic_qconfig_map": 6, "placeholderobserv": [6, 15], "is_dynam": 6, "local": [6, 20, 27, 30, 31, 32], "prototyp": [6, 25, 33], "could": [6, 7, 11, 13, 18, 25, 31, 32, 33], "topologi": [6, 7, 18, 19, 25, 29, 30, 32, 33], "verifi": [6, 7, 27], "roberta": [6, 25, 33], "xlm": [6, 25], "electra": 6, "discrimin": 6, "libtorch": [6, 33], "suppos": [6, 14, 32], "handl": [6, 18, 32], "servic": [6, 27, 29, 32], "regular": [6, 21], "unlik": 6, "app": [6, 33], "iostream": 6, "argc": 6, "char": 6, "argv": 6, "catch": 6, "cerr": 6, "ivalu": 6, "push_back": 6, "cout": 6, "slice": [6, 18], "end": [6, 13, 20, 33], "endl": 6, "cmakelist": 6, "cmake_minimum_requir": 6, "fatal_error": 6, "find_packag": 6, "add_execut": 6, "target_link_librari": 6, "torch_ipex_librari": 6, "set_properti": 6, "properti": [6, 31], "cxx_standard": 6, "17": [6, 29, 30, 31], "mkdir": 6, "build": [6, 32, 33], "dcmake_prefix_path": 6, "libpytorch_path": 6, "had": [6, 32], "ldd": 6, "workspac": 6, "xx": 6, "torchconfig": 6, "22": [6, 29, 30, 31], "kineto_librari": 6, "notfound": 6, "stack": [6, 8], "most": [6, 7, 13, 21, 27, 29, 31, 32, 33], "recent": [6, 18], "append_torchlib_if_found": 6, "ipexconfig": 6, "84": [6, 29, 30, 32], "4": [6, 11, 13, 14, 18, 20, 27, 29, 30, 32, 33], "lib": [6, 30, 31], "libintel": [6, 33], "ext": [6, 33], "0x00007f3cf98e0000": 6, "libc10": 6, "0x00007f3cf985a000": 6, "0x00007f3cf70fc000": 6, "libtorch_cpu": 6, "0x00007f3ce16ac000": 6, "libdnnl_graph": 6, "0x00007f3cde954000": 6, "former": 6, "zoo": [6, 29], "benchmark": [6, 25, 29, 30, 33], "simpli": [6, 7, 25, 30], "overview": [7, 24, 28, 33], "two": [7, 14, 20, 21, 27, 31, 32, 33], "claus": [7, 10, 19], "guidanc": 7, "intel_pytorch_extens": [7, 24, 25, 33], "later": [7, 24, 32], "correct": [7, 18, 24, 33], "speed": [7, 11, 19, 27, 32, 33], "faster": [7, 8, 29, 32], "happen": 7, "inductor": [7, 33], "migrat": 7, "pattern": [7, 11, 18, 27, 33], "peak": 7, "highli": [7, 22, 27, 32, 33], "adapt": 7, "nchw": [7, 32], "channels_last": [7, 18, 32, 33], "nhwc": [7, 32, 33], "memory_format": [7, 18], "anymor": [7, 33], "aka": [7, 18], "cooper": [7, 29, 33], "lake": [7, 29, 33], "partial": 7, "upstream": [7, 18, 33], "land": [7, 33], "pr": [7, 18, 25, 33], "being": [7, 32], "review": [7, 25, 33], "instead": [7, 8, 14, 19, 20, 28, 29, 30, 31, 32, 33], "device_nam": [7, 8], "conduct": 7, "transpar": [7, 28, 32, 33], "frequent": 7, "relu": [7, 13, 16, 18, 25, 33], "websit": 7, "registr": 7, "roialign": [7, 33], "nm": [7, 33], "cnn": [7, 18, 25, 29, 32, 33], "frozenbatchnorm2d": 7, "num_featur": 7, "ep": [7, 10, 19], "1e": [7, 10, 16], "05": [7, 10, 29, 30], "batchnorm2d": [7, 10, 25, 33], "statist": 7, "affin": [7, 10, 15, 20, 30, 31, 32], "expect": [7, 29, 33], "w": [7, 16, 18, 21, 29, 31], "interact": [7, 33], "beyond": 7, "kind": 7, "gender": 7, "hobbi": 7, "dot": [7, 18, 27], "man": [7, 32], "plai": [7, 32], "footbal": 7, "b": [7, 8, 27], "mergedembeddingbag": 7, "embedding_spec": 7, "embeddingspec": 7, "merg": [7, 25, 33], "embeddingbag": [7, 25, 33], "stage": [7, 10, 19, 20, 28, 32, 33], "assum": [7, 8, 22, 31, 32, 33], "construct": [7, 13], "spars": [7, 18, 25, 33], "dens": [7, 18], "gradient": 7, "mergedembeddingbagwithsgd": 7, "doe": [7, 13, 18, 20, 25, 33], "emblist": 7, "modulist": 7, "emb1": 7, "emb2": 7, "emb3": 7, "emb_m": 7, "in1": 7, "in2": 7, "in3": 7, "in_m": 7, "append": 7, "emb": 7, "in_i": 7, "merged_emb": 7, "from_embeddingbag_list": 7, "heavi": 7, "big": [7, 18], "read": [7, 19], "linearize_indices_and_offset": 7, "offset": [7, 18, 27], "togeth": [7, 14, 20, 32, 33], "consid": 7, "layer": [7, 20, 27, 33], "preprocess": 7, "offlin": [7, 33], "futur": [7, 33], "visit": [7, 32], "mergedembeddingbagwith": 7, "weight_decai": [7, 19], "grad": [7, 19], "creat": [7, 16, 20, 32, 33], "decai": 7, "to_bfloat16_train": 7, "merged_input": 7, "need_linearize_indices_and_offset": 7, "booltensor": 7, "becom": [7, 27, 32], "balanc": [7, 32], "embedingbag": 7, "often": 7, "categor": 7, "power": [7, 32, 33], "law": 7, "ag": 7, "video": 7, "game": 7, "19": [7, 29, 30, 31, 33], "20": [7, 18, 29, 30, 31, 33], "29": [7, 30, 31], "row": 7, "address": [7, 18, 30, 31, 32, 33], "solv": [7, 19, 32], "immedi": 7, "right": [7, 21, 22, 27], "access": [7, 18, 19, 31], "friendli": [7, 32], "gemm": [7, 18, 25, 27, 33], "aim": [7, 10, 32], "math": 7, "wa": [7, 30, 31, 32, 33], "broad": [7, 9, 33], "toggl": 7, "concern": 7, "footprint": [7, 21, 27, 33], "stick": 7, "splitsgd": [7, 21], "spawn": [7, 20], "deliv": [7, 27, 33], "separ": [7, 19, 26, 32], "hopefulli": 7, "eas": [7, 18, 33], "though": 7, "small": [7, 19, 32, 33], "turn": [7, 33], "boolean": [7, 33], "off": [7, 8, 21, 27, 29, 33], "variou": [7, 14, 32, 33], "area": [7, 14], "extrem": [7, 14, 32], "situat": [7, 14], "space": [7, 18, 32], "huge": [7, 14, 32], "impract": [7, 14], "consum": [7, 14], "launcher": [7, 13, 30, 32, 33], "integr": [7, 11, 18, 27, 32, 33], "conveni": [8, 33], "lighter": 8, "sacrif": 8, "trade": [8, 27, 29, 33], "slower": [8, 32, 33], "accur": 8, "primarili": [8, 33], "simplenet": [8, 33], "super": [8, 10, 16, 20, 25, 33], "64": [8, 10, 16, 20, 29, 30, 33], "stride": [8, 10, 20, 33], "pad": [8, 10, 20, 33], "y": [8, 15, 16, 20, 21, 33], "manag": [8, 13, 20, 27, 30], "maintain": 8, "categori": 8, "choos": [8, 20, 30, 32, 33], "circumst": 8, "imag": [8, 13, 18, 32, 33], "label": 8, "float64": 8, "variant": 8, "suppli": 8, "addmm": 8, "addmm_": 8, "cannot": [8, 19, 25, 33], "stabil": [8, 33], "describ": [8, 13, 18, 21, 31, 32], "expos": 8, "regardless": [8, 33], "unlist": 8, "downstream": 8, "numer": [8, 32], "believ": [8, 18], "unstabl": 8, "conv1d": [8, 13], "conv3d": [8, 13, 33], "conv_transpose1d": 8, "conv_transpose2d": 8, "conv_transpose3d": 8, "bmm": [8, 33], "mm": 8, "baddbmm": 8, "addbmm": 8, "matmul": [8, 13, 25, 33], "conv_tbc": 8, "group_norm": 8, "_native_multi_head_attent": 8, "avg_pool3d": 8, "binary_cross_entropi": 8, "grid_sampl": 8, "polar": 8, "prod": 8, "quantil": 8, "nanquantil": 8, "stft": 8, "cdist": 8, "view_as_complex": 8, "choleski": 8, "cholesky_invers": 8, "cholesky_solv": 8, "invers": 8, "lu_solv": 8, "matrix_rank": 8, "orgqr": 8, "ormqr": 8, "pinvers": 8, "max_unpool2d": 8, "max_unpool3d": 8, "adaptive_avg_pool3d": 8, "reflection_pad1d": 8, "reflection_pad2d": 8, "replication_pad1d": 8, "replication_pad2d": 8, "replication_pad3d": 8, "mse_loss": 8, "cosine_embedding_loss": 8, "nll_loss": 8, "nll_loss2d": 8, "hinge_embedding_loss": 8, "poisson_nll_loss": 8, "smooth_l1_loss": 8, "cross_entropy_loss": 8, "l1_loss": 8, "huber_loss": 8, "margin_ranking_loss": 8, "soft_margin_loss": 8, "triplet_margin_loss": 8, "multi_margin_loss": 8, "ctc_loss": 8, "kl_div": 8, "multilabel_margin_loss": 8, "binary_cross_entropy_with_logit": 8, "fft_fft": 8, "fft_ifft": 8, "fft_fft2": 8, "fft_ifft2": 8, "fft_fftn": 8, "fft_ifftn": 8, "fft_rfft": 8, "fft_irfft": 8, "fft_rfft2": 8, "fft_irfft2": 8, "fft_rfftn": 8, "fft_irfftn": 8, "fft_hfft": 8, "fft_ihfft": 8, "linalg_cond": 8, "linalg_matrix_rank": 8, "linalg_solv": 8, "linalg_choleski": 8, "linalg_svdv": 8, "linalg_eigv": 8, "linalg_eigvalsh": 8, "linalg_inv": 8, "linalg_householder_product": 8, "linalg_tensorinv": 8, "linalg_tensorsolv": 8, "fake_quantize_per_tensor_affin": 8, "eig": 8, "geqrf": 8, "lstsq": 8, "_lu_with_info": 8, "qr": 8, "svd": 8, "symeig": 8, "triangular_solv": 8, "fractional_max_pool2d": 8, "fractional_max_pool3d": 8, "adaptive_max_pool3d": 8, "multilabel_margin_loss_forward": 8, "linalg_qr": 8, "linalg_cholesky_ex": 8, "linalg_svd": 8, "linalg_eig": 8, "linalg_eigh": 8, "linalg_lstsq": 8, "linalg_inv_ex": 8, "cat": [8, 30, 31, 33], "index_copi": 8, "intervent": 8, "mixtur": [8, 33], "enable_auto_channels_last": 9, "disable_auto_channels_last": 9, "regress": [9, 33], "rais": 10, "oob": [10, 33], "easili": [10, 15], "who": 10, "known": [10, 27], "inevit": 10, "typic": [10, 27, 32, 33], "simplifi": [10, 33], "snippet": [10, 28], "optimum": 10, "monkei": 10, "patch": [10, 33], "embedding_bag": 10, "qa": [10, 33], "clear": 10, "ninstanc": [10, 14, 30, 33], "ncore": [10, 30], "28": [10, 14, 16, 29, 30, 31, 32, 33], "run_qa": [10, 33], "model_name_or_path": [10, 28, 33], "dataset_nam": [10, 33], "squad": [10, 29, 33], "do_ev": [10, 33], "per_device_train_batch_s": [10, 33], "learning_r": [10, 33], "3e": [10, 33], "num_train_epoch": [10, 33], "max_seq_length": [10, 33], "384": [10, 31, 33], "doc_strid": [10, 33], "output_dir": [10, 14, 33], "tmp": [10, 31, 33], "debug_squad": [10, 33], "dummymodul": 10, "input1": 10, "randn": [10, 13, 16, 18, 31, 33], "kernel_s": 10, "track_running_stat": 10, "customized_forward": 10, "method1": 10, "success": [10, 23], "method2": 10, "fail": [10, 25, 33], "top": [10, 21, 33], "unabl": 10, "hook": 10, "As": [10, 19, 20, 27, 30, 31, 32, 33], "behaviour": 10, "repeat": [10, 18, 21], "feasibl": 10, "idea": [11, 21, 32], "primit": [11, 20, 27, 29, 33], "portabl": 11, "hpc": 11, "31": [11, 30, 31], "tri": 12, "failur": [12, 33], "incorrect": [12, 25, 33], "trigger": 12, "meanwhil": [12, 32, 33], "fall": 12, "resnet50": [12, 13, 14, 18, 29, 30, 32, 33], "dag": 13, "acycl": 13, "straight": [13, 32], "cover": [13, 18, 27, 30], "constant": 13, "resourc": [13, 20, 27, 31, 32], "focus": [13, 33], "front": [13, 33], "propag": [13, 21, 32], "graph_for": 13, "regard": 13, "rn50": [13, 33], "sum": [13, 16, 18, 19, 33], "convrelu": 13, "convsumrelu": 13, "default_static_qconfig": [13, 15, 16, 31, 33], "244": 13, "convtranspose3d": 13, "ab": [13, 31], "clamp": 13, "elu": 13, "exp": 13, "gelu": [13, 33], "hardtanh": 13, "hardswish": [13, 33], "mish": 13, "sigmoid": [13, 33], "pow": 13, "round": [13, 21], "sqrt": [13, 19], "squar": [13, 27], "tanh": [13, 33], "leaki": 13, "silu": 13, "mul": 13, "layernorm": [13, 33], "div": 13, "softmax": [13, 33], "view": [13, 18, 20, 21], "transpos": [13, 33], "contigu": [13, 18, 32, 33], "dequant": 13, "partit": [13, 32], "leaky_relu": 13, "___": 13, "divid": [13, 31, 32, 33], "maxpool2d": 13, "_____": 13, "stock": [13, 29, 33], "owner": 13, "otheriws": 13, "compuat": 13, "wikipedia": [13, 32], "There": [14, 20, 27, 32], "thing": [14, 32], "yaml": 14, "strategi": [14, 32, 33], "grid": 14, "random": 14, "max_trial": 14, "trial": 14, "histori": [14, 27], "record": [14, 31], "csv": 14, "hyperparam": 14, "mandatori": 14, "hp": 14, "ncores_per_inst": 14, "all_physical_cor": 14, "ncore_per_inst": [14, 33], "all_logical_cor": 14, "use_all_nod": 14, "num_nod": 14, "use_logical_cor": [14, 31], "is_hyperthreading_en": 14, "disable_numactl": [14, 31], "disable_iomp": [14, 31], "malloc": [14, 30, 32], "tc": 14, "je": 14, "previou": [14, 18, 32, 33], "hyperparamt": 14, "8": [14, 29, 30, 31, 32], "respect": [14, 29, 30, 33], "maxim": 14, "higher_is_bett": 14, "target_v": 14, "inf": 14, "minimum": [14, 18], "platinum": [14, 29, 31, 32], "8180m": [14, 32], "socket": [14, 29, 31, 32, 33], "physic": [14, 20, 31, 32], "anoth": [14, 30, 32, 33], "logic": [14, 18, 31, 32], "conf_fil": [14, 33], "hypertune_directori": 14, "termin": 14, "339081764221191": 14, "gave": 14, "side": [15, 32], "compon": [15, 26, 27], "much": [15, 18, 21, 27, 32], "abl": 15, "decid": [15, 20, 27], "satisfi": [15, 25], "tradeoff": 15, "reduce_rang": 15, "methond": 15, "obsev": 15, "symmetr": 15, "sete": 15, "skylak": 15, "quant_stat": [15, 16], "user_model": 15, "calibration_data_set": [15, 33], "qparam": 15, "And": [15, 20, 31], "achang": 15, "overrid": 15, "save_qconf_summari": [15, 16, 28], "qconf_summari": [15, 16, 28], "load_qconf_summari": 15, "dynamic_qconfig": 15, "default_dynamic_qconfig": [15, 31], "compute_dtyp": 15, "per_tensor_symmetr": 15, "gru": 15, "lstmcell": 15, "rnncell": 15, "grucel": 15, "bother": 16, "desir": [16, 30], "receip": [16, 20], "portion": 16, "beginn": 16, "quickstart_tutori": 16, "training_data": 16, "fashionmnist": 16, "test_data": 16, "loader": 16, "train_dataload": 16, "test_dataload": 16, "break": [16, 33], "neuralnetwork": 16, "flatten": [16, 20], "linear_relu_stack": 16, "sequenti": 16, "logit": 16, "loss_fn": 16, "predict": 16, "pred": 16, "backpropag": 16, "item": 16, "7f": 16, "5d": 16, "epoch": 16, "argmax": 16, "accu": 16, "tuned_conf": 16, "avx2_vnni": 17, "impli": 17, "csrc": [17, 25], "represent": 18, "multidimension": 18, "arrai": 18, "nd": 18, "1d": 18, "semant": 18, "attribut": 18, "coo": 18, "canon": 18, "assign": [18, 31, 32], "2d": 18, "height": 18, "illustr": [18, 19, 21, 30, 32], "actual": [18, 21], "bmp": 18, "contiguous_format": [18, 32], "tensorflow": 18, "close": [18, 30, 32], "to_mkldnn": 18, "difficult": 18, "manipul": 18, "to_dens": 18, "natur": [18, 21, 27], "Will": 18, "hold": [18, 32], "secret": 18, "ingredi": 18, "almost": 18, "foundat": [18, 32], "upper": [18, 32], "fact": [18, 32], "expens": 18, "sequenc": [18, 21, 27, 33], "benefici": 18, "nb": 18, "me": 18, "roughli": 18, "50": [18, 30, 31], "perf": 18, "32": [18, 21, 29, 30, 31], "map": [18, 29], "mkldnn": 18, "mkldnn_util": 18, "subsequ": [18, 32], "concept": [18, 32], "diagram": [18, 32], "hard": [18, 25], "conclus": 18, "necessari": 18, "neglig": 18, "move": [18, 32], "organ": 18, "question": [18, 29], "reinterpret": 18, "element": [18, 19], "answer": [18, 29], "chw": 18, "hw": 18, "stride_n": 18, "stride_c": 18, "stride_h": 18, "stride_w": 18, "merit": 18, "express": [18, 33], "noncontigu": 18, "n1": 18, "n2": 18, "mind": [18, 31], "someth": 18, "reli": [18, 20], "rfc": 18, "hwc": 18, "wc": 18, "long": [18, 21, 25, 27, 33], "chwn": 18, "hwn": 18, "wn": 18, "empti": [18, 30], "outplac": [18, 33], "is_contigu": 18, "_appli": 18, "brief": [18, 27, 33], "imagenet": [18, 29], "spontan": 18, "tell": [18, 20, 32], "NOT": [18, 30], "compris": 18, "explicit": [18, 20, 32], "implicit": 18, "meta": [18, 27, 28], "tensoriter": 18, "guidelin": 18, "awar": [18, 20, 30, 31], "my": 18, "upsampl": [18, 33], "cudnn": 18, "accommod": 18, "hidden": [18, 27], "md": 18, "format_tag": 18, "src_md": 18, "desc": 18, "data_typ": 18, "src_mem": 18, "src_data_ptr": 18, "card": 18, "hwio": 18, "resnext101": [18, 33], "detectron2": 18, "8x": 18, "lamb": [19, 21], "adagrad": [19, 21], "clr": 19, "lr_decai": 19, "state_sum": 19, "addcmul_": 19, "add_": 19, "addcdiv_": 19, "problem": [19, 25, 31, 32], "whole": [19, 20, 32], "storag": 19, "onboard": [19, 32], "third": [19, 33], "high": [19, 21, 32], "bound": [19, 20, 27, 32], "bottl": 19, "neck": 19, "prevent": 19, "pseudo": [19, 21, 33], "wise": [19, 28, 33], "adagrad_fused_step": 19, "ensur": [19, 20, 31], "grad0": 19, "grad1": 19, "grad_n": 19, "param_n": 19, "state_sum_n": 19, "adagrad_step": 19, "grad_i": 19, "param_i": 19, "state_sum_i": 19, "other_arg": 19, "coupl": [20, 32, 33], "omp": [20, 25, 30, 31, 32, 33], "ld_preload": [20, 30, 31, 32], "libiomp5": [20, 30, 31, 32], "model_script": 20, "examplenet": 20, "examplenet1": 20, "x1": 20, "start_dim": 20, "examplenet2": 20, "conv2": 20, "x2": 20, "y1": 20, "y2": 20, "model1": 20, "traced_model1": 20, "model2": 20, "traced_model2": 20, "multi_stream_model": [20, 33], "datatyp": 20, "receipt": 20, "steam": [20, 33], "input_hint": 20, "output_hint": 20, "pthread": 20, "async": [20, 33], "wake": 20, "synchron": [20, 25, 33], "imper": [20, 22, 33], "suffer": 20, "gil": 20, "hurt": 20, "mitig": [20, 29], "omp_num_thread": [20, 25, 30, 31, 33], "phase": 20, "s1": 20, "c1": 20, "numactl": [20, 30, 31], "outsid": 20, "superset": 20, "behavior": [20, 30, 32], "undefin": [20, 32], "global": 20, "gb": 20, "simultan": 20, "correspond": [20, 30, 33], "cpu_pool1": 20, "cpu_pool2": 20, "task1": 20, "task2": 20, "y1_futur": 20, "y2_futur": 20, "y_runtim": 20, "kmp_": 20, "fulfil": 20, "initi": [20, 31], "worker": [20, 30], "serv": [20, 33], "sub": [20, 27, 32], "wait": [20, 32], "futuretensor": 20, "didn": 20, "dlopen": 20, "symbol": 20, "bottom": 21, "bit": [21, 27], "sign": 21, "expon": 21, "mantissa": 21, "23": [21, 30, 31], "capac": [21, 29], "digit": 21, "shorter": [21, 27], "fewer": 21, "neg": 21, "disadvantag": 21, "shift": 21, "left": [21, 27, 31], "lose": 21, "decim": 21, "valid": [21, 33], "1234500000": 21, "0000012345": 21, "1234512345": 21, "sens": 21, "fraction": 21, "12345": 21, "00000": 21, "signific": 21, "bui": 21, "involv": 21, "ground": 21, "truth": 21, "chain": 21, "rule": [21, 33], "meet": [21, 32, 33], "wide": [21, 33], "understand": [21, 32], "formula": 21, "\u03b1": 21, "gw": 21, "denot": 21, "receiv": 21, "rate": 21, "earlier": 21, "inaccur": 21, "practic": [21, 23, 27, 32], "choic": [21, 30], "exactli": 21, "kept": 21, "halv": 21, "recov": 21, "fp32_w": 21, "concat_fp32_from_bf16": 21, "bf16_w": 21, "fp32_gw": 21, "bf16_gw": 21, "weight_dacai": 21, "split_bf16_from_fp32": 21, "demostr": 22, "cheat": 22, "sheet": 22, "pypi": [25, 33], "occupi": 25, "remark": [25, 29, 32], "__name__": [25, 33], "__main__": [25, 30, 31, 33], "112": [25, 29, 32, 33], "nnc": 25, "poor": [25, 33], "huggingfac": [25, 27, 31, 33], "casual": 25, "gpt2": 25, "summar": 25, "t5": [25, 33], "classif": [25, 29], "allenai": 25, "longform": 25, "409": 25, "workaround": [25, 33], "_jit_set_texpr_fuser_en": 25, "tensorexpr_fus": 25, "settensorexprfuseren": 25, "longer": [25, 29], "complic": [25, 30, 32], "undergo": [25, 28], "runtimeerror": [25, 33], "overflow": [25, 33], "unpack": [25, 33], "exce": [25, 29, 32, 33], "quantize_per_tensor": 25, "pseudocod": [25, 33], "omp_num_threa": 25, "set_num_thread": [25, 33], "freezed_model": [25, 33], "run_benchmark": [25, 33], "flow": 25, "bag": [25, 33], "progress": [25, 27, 33], "abnorm": [25, 33], "tbd": 25, "rnnt": [25, 33], "joint_net": [25, 33], "caller": [25, 33], "yet": [25, 33], "pend": [25, 33], "apach": [26, 31], "notic": [26, 30, 31], "term": 26, "condit": 26, "architectur": [27, 29, 32], "consist": [27, 32], "decod": [27, 29], "multiheadattent": 27, "feedforward": 27, "everi": 27, "kv_cach": 27, "lot": [27, 33], "besid": [27, 32, 33], "adopt": [27, 33], "hub": 27, "7b": [27, 29], "hf": 27, "13b": [27, 29], "70b": 27, "eleutherai": 27, "6b": [27, 29], "20b": 27, "tiiuae": 27, "40b": 27, "30b": 27, "3b": 27, "quantzat": 27, "remot": [27, 32], "modeling_falcon": 27, "therefor": [27, 32], "model_config": 27, "tiiuae_falcon": 27, "40b_config": 27, "readi": 27, "coverag": 27, "codellama": 27, "approach": 27, "rope": 27, "expand": 27, "web": 27, "legend": 27, "autotp": 27, "obviou": 27, "hotspot": 27, "lead": 27, "significantli": [27, 33], "heavier": 27, "io": 27, "occurr": 27, "ship": 27, "2nd": 27, "4th": [27, 29], "except": [27, 30], "beeter": 27, "Its": 27, "seen": 27, "woq": 27, "integ": [27, 32], "bandwidth": 27, "token": [27, 29], "beam": 27, "idx": [27, 30], "reorder_cach": 27, "bottleneck": 27, "iakv": 27, "firstli": 27, "pre": [27, 33], "buffer": 27, "beam_width": 27, "timestamp": 27, "secondli": 27, "elimin": 27, "rotari": 27, "posit": [27, 32, 33], "rmsnorm": [27, 33], "furthli": 27, "soluct": 27, "shard": 27, "content": [28, 33], "automodelforcausallm": 28, "calib_dataset": 28, "your_calibration_dataset": 28, "calib_sampl": 28, "calibration_model": 28, "qconfig_summary_file_path": 28, "inference_mod": 28, "get_weight_only_quant_qconfig_map": 28, "weight_dtyp": 28, "quint4x2": 28, "lowp_mod": 28, "woqlowpmod": 28, "init_distribut": 28, "get_acceler": 28, "communication_backend_nam": 28, "var": 28, "ondevic": 28, "init_infer": 28, "mp_size": 28, "base_dir": 28, "repo_root": 28, "checkpoints_json": 28, "zone": [29, 33], "articl": [29, 32], "llama2": 29, "256": 29, "1024": [29, 32], "were": [29, 30, 31, 32], "carri": 29, "m7i": 29, "m6i": [29, 31], "ratio": [29, 33], "47x": 29, "62x": 29, "57x": 29, "58x": 29, "85x": 29, "27x": 29, "38x": 29, "29x": 29, "36x": 29, "conclud": [29, 33], "respons": 29, "session": 29, "exhibit": 29, "total": [29, 32], "wherea": 29, "p90": 29, "26x": 29, "sec": 29, "39": [29, 30, 31, 33], "26": [29, 30, 31], "49": [29, 30, 31], "170": 29, "21": [29, 30, 31], "measur": [29, 33], "17th": 29, "16xlarg": 29, "u": [29, 31], "west": 29, "ubuntu": 29, "04": [29, 30], "1009": 29, "sw": 29, "workload1": 29, "inference2": 29, "realtim": 29, "inference3": 29, "tunabl": [29, 31], "8380": 29, "30ghz": 29, "83x": 29, "44x": 29, "ssd": [29, 33], "resnet34": [29, 33], "16x": 29, "coco": 29, "1200": 29, "resnext": 29, "32x16d": 29, "81x": 29, "21x": 29, "vgg": 29, "75x": 29, "19x": 29, "shufflenetv2_x1": 29, "07x": 29, "78x": 29, "04x": 29, "max_seq_len": 29, "384task": 29, "jemalloc": [29, 31, 33], "05x": 29, "96x": 29, "mrpc": 29, "128task": 29, "distilbert": 29, "12x": 29, "dnnl": 29, "base_text_classif": 29, "f1": 29, "81": [29, 30], "99": [29, 33], "79": [29, 30], "93": 29, "02": [29, 31], "85": [29, 30], "86": [29, 30], "top1": 29, "76": [29, 30], "75": [29, 30], "98": 29, "78": [29, 30], "199": 29, "48": [29, 30, 31], "vgg11": 29, "69": [29, 30], "67": [29, 30, 33], "96": 29, "44": [29, 30, 31], "36": [29, 30, 31], "92": 29, "97": 29, "shufflenet": 29, "histogram": [29, 33], "40": [29, 30, 31, 33], "ucod": 29, "0xd0002a0": 29, "ON": 29, "turboboost": 29, "bio": 29, "ddr": 29, "slot": 29, "16gb": 29, "frequenc": 29, "3200": 29, "dcpmm": 29, "256gb": 29, "host": 29, "cento": 29, "2105": 29, "18": [29, 30, 31], "305": 29, "el8_4": 29, "x86_64": 29, "docker": [29, 33], "spectr": 29, "meltdown": 29, "24x": 29, "31x": 29, "15x": 29, "30x": 29, "mobilenet": 29, "v2": [29, 33], "08x": 29, "03x": 29, "seq_len": 29, "09x": 29, "39x": 29, "35x": 29, "160": 29, "55x": 29, "06x": 29, "fpn": 29, "71x": 29, "20x": 29, "13x": 29, "32x": 29, "48x": 29, "11x": 29, "terabyt": 29, "14x": 29, "02x": 29, "10x": 29, "33x": 29, "8380h": 29, "90ghz": 29, "56": [29, 30, 31, 32], "67x": 29, "45x": 29, "77x": 29, "18x": 29, "formerli": [29, 32, 33], "0x700001c": 29, "wlydcrb1": 29, "sy": 29, "0016": 29, "p29": 29, "2006080250": 29, "64gb": 29, "768gb": 29, "influenc": [30, 32], "properli": 30, "contribut": 30, "themselv": 30, "free": [30, 33], "mainli": [30, 33], "around": 30, "exit": 30, "interpret": 30, "silent": 30, "suppress": 30, "prefix": 30, "cross": [30, 31, 32], "across": 30, "taskset": 30, "malloc_conf": [30, 32], "crash": [30, 32, 33], "nnode": 30, "nproc": 30, "count": 30, "addr": 30, "ip": 30, "hostnam": 30, "proc": 30, "port": 30, "hostfil": 30, "mpi": 30, "mpiexec": 30, "hydra": 30, "np": 30, "ppn": 30, "genv": 30, "i_mpi_pin_domain": 30, "codeless": 30, "ut": 30, "exclus": 30, "mutual": 30, "ld": 30, "favorit": 30, "kmp": [30, 32], "granular": [30, 31, 32], "compact": [30, 31, 32], "stdout": 30, "afterward": [30, 32], "undesir": 30, "_timestamp_inst": 30, "_timestamp_instance_": 30, "_core": 30, "run_20210712212258_inst": 30, "run_20210712212258_instance_0_cores_0": 30, "gif": 30, "07": 30, "764": 30, "conda_prefix": [30, 31], "virtual_env": [30, 31], "lib64": [30, 31], "home": [30, 31], "drop": [30, 31], "kmp_affin": [30, 31, 32], "kmp_blocktim": [30, 31, 32], "14": [30, 31, 33], "24": [30, 31], "25": [30, 31], "27": [30, 31, 32], "30": [30, 31], "34": [30, 31], "35": [30, 31], "37": [30, 31, 33], "38": [30, 31], "41": [30, 31], "42": [30, 31], "tee": 30, "run_20210712223308_inst": 30, "run_20210712223308_instance_0_cores_0": 30, "87": 30, "08": 30, "117": 30, "88": 30, "118": 30, "45": [30, 31], "46": [30, 31], "47": [30, 31], "51": [30, 31], "52": [30, 31], "53": [30, 31], "54": [30, 31], "55": [30, 31, 32], "57": 30, "59": 30, "60": 30, "61": 30, "62": 30, "63": [30, 33], "65": 30, "68": [30, 33], "70": 30, "71": 30, "72": 30, "73": 30, "74": 30, "77": 30, "82": 30, "83": [30, 32], "run_20210712214504_inst": 30, "run_20210712214504_instance_0_cores_22": 30, "513": 30, "run_20210712220928_inst": 30, "run_20210712220928_instance_0_cores_0": 30, "355": 30, "356": 30, "deduct": 30, "run_20210712221615_inst": 30, "run_20210712221615_instance_0_cores_11": 30, "591": 30, "run_20210712221150_inst": 30, "run_20210712221150_instance_0_cores_0": 30, "run_20210712221150_instance_1_cores_22": 30, "233": 30, "236": 30, "run_20210712221415_inst": 30, "run_20210712221415_instance_0_cores_0": 30, "run_20210712221415_instance_1_cores_4": 30, "run_20210712221415_instance_2_cores_8": 30, "run_20210712221415_instance_3_cores_12": 30, "run_20210712221415_instance_4_cores_16": 30, "run_20210712221415_instance_5_cores_20": 30, "run_20210712221415_instance_6_cores_24": 30, "run_20210712221415_instance_7_cores_28": 30, "run_20210712221415_instance_8_cores_32": 30, "run_20210712221415_instance_9_cores_36": 30, "run_20210712221415_instance_10_cores_40": 30, "140": 30, "143": 30, "146": 30, "149": 30, "151": 30, "154": 30, "157": 30, "159": 30, "162": 30, "164": 30, "167": 30, "run_20210712221305_inst": 30, "run_20210712221305_instance_0_cores_0": 30, "run_20210712221305_instance_1_cores_11": 30, "run_20210712221305_instance_2_cores_22": 30, "run_20210712221305_instance_3_cores_33": 30, "470": 30, "471": 30, "473": 30, "476": 30, "479": 30, "instance_idx": 30, "independ": 30, "among": [30, 31, 32], "confirm": 30, "06": [30, 31], "175": 30, "176": 30, "177": 30, "run_20220106130151_instance_0_cores_0": 30, "sometim": [30, 32], "235": 30, "jemallocl": 30, "oversize_threshold": [30, 32], "background_thread": [30, 32], "metadata_thp": [30, 32], "dirty_decay_m": [30, 32], "9000000000": [30, 32], "muzzy_decay_m": [30, 32], "libjemalloc": 30, "run_20210713153048_instance_0_cores_0": 30, "654": 30, "libtcmalloc": [30, 31], "655": 30, "run_20210713153333_instance_0_cores_0": 30, "784": 30, "run_20210713153659_instance_0_cores_0": 30, "blocktim": 30, "00": [30, 33], "760": [30, 31], "761": [30, 31], "omp_schedul": [30, 32], "omp_proc_bind": [30, 32], "run_20210713152500_instance_0_cores_0": 30, "give": [31, 33], "ipex_en": 31, "procedur": 31, "tunin": 31, "dramat": [31, 32], "cpu_launcher_en": 31, "cpu_launcher_arg": 31, "hyperthread": 31, "present": 31, "ital": 31, "ptmalloc": 31, "use_default_alloc": [31, 33], "tcmalloc": 31, "enable_tcmalloc": 31, "enable_jemalloc": 31, "nth": [31, 32], "uniform": 31, "overlap": 31, "signficantli": 31, "8180": 31, "affinit": 31, "addition": 31, "kill": 31, "unutil": 31, "restart": 31, "remain": 31, "aliv": 31, "taken": 31, "care": 31, "worri": 31, "continu": [31, 33], "Then": 31, "interrupt": 31, "dummi": 31, "dummy_tensor": 31, "scheme": 31, "bert_int8_jit": 31, "pretrain": [31, 33], "n_iter": 31, "rn50_int8_jit": 31, "usus": 31, "rn50_ipex_int8": 31, "handler": 31, "image_classifi": 31, "similarli": 31, "bert_ipex_int8": 31, "transformer_handler_gener": 31, "setup_config": 31, "seq_classification_artifact": 31, "index_to_nam": 31, "nc": 31, "model_stor": 31, "server": [31, 32], "rest": 31, "model_log": 31, "096": 31, "8375c": 31, "03": 31, "981": 31, "982": 31, "previous": 31, "cases": 31, "223": 31, "site": 31, "model_service_work": 31, "sock": 31, "unix": 31, "9000": 31, "762": 31, "763": 31, "9001": 31, "274": 31, "9002": 31, "975": 31, "9003": 31, "bench": 31, "amazon": 31, "ec2": 31, "24xlarg": 31, "reproduc": 31, "url": [31, 33], "modelurl": 31, "inputpath": 31, "concurr": [31, 32], "huggingface_transform": 31, "sample_text_captum_input": 31, "graphic": 32, "xe": 32, "briefli": 32, "background": 32, "knowledg": 32, "c620": 32, "seri": 32, "chipset": 32, "purlei": 32, "chip": 32, "inclus": 32, "1mb": 32, "l2": 32, "2666": 32, "mhz": 32, "ddr4": 32, "six": 32, "ultra": 32, "interconnect": 32, "upi": 32, "microarchitectur": 32, "connect": 32, "transfer": 32, "equip": 32, "motherboard": 32, "attach": 32, "asu": 32, "z11pa": 32, "d8": 32, "competit": 32, "stall": 32, "busi": 32, "uma": 32, "lscpu": 32, "retriev": 32, "111": 32, "50ghz": 32, "node0": 32, "node1": 32, "sophist": 32, "brought": [32, 33], "polici": 32, "put": 32, "sysctl": 32, "great": 32, "placement": 32, "cpunodebind": 32, "membind": 32, "multithread": 32, "primari": 32, "consecut": 32, "join": 32, "libgomp": 32, "libiomp": 32, "hang": [32, 33], "commonli": 32, "gomp_cpu_affin": 32, "comma": 32, "invalid": 32, "thrash": 32, "did": [32, 33], "compet": 32, "unus": 32, "proclist": 32, "millisecond": 32, "sleep": 32, "200m": 32, "period": 32, "elaps": 32, "overal": 32, "appropri": 32, "reserv": 32, "sole": 32, "penal": 32, "role": 32, "unnecessari": 32, "destruct": 32, "emphas": 32, "fragment": 32, "mmuzzy_decay_m": 32, "forg": 32, "dealloc": 32, "costli": 32, "gpertool": 32, "plu": 32, "pretti": 32, "nifti": 32, "analysi": 32, "gperftool": 32, "set_flush_denorm": 32, "warm": 32, "threshold": 32, "usuali": 32, "come": 32, "maskrcnn": [32, 33], "wav2vec2": 32, "recognit": 32, "onednn_primitive_cache_capac": 32, "65536": 32, "voic": 32, "4096": 32, "2253": 33, "2251": 33, "2236": 33, "2278": 33, "2257": 33, "dockerfil": 33, "ux": 33, "2229": 33, "2195": 33, "2299": 33, "2315": 33, "2283": 33, "2280": 33, "2292": 33, "2275": 33, "2319": 33, "misc": 33, "2198": 33, "2264": 33, "2290": 33, "changelog": 33, "workflow": 33, "1563": 33, "excess": 33, "1677": 33, "1688": 33, "1664": 33, "lar": 33, "1695": 33, "dictionari": 33, "1682": 33, "v3": 33, "2137": 33, "1568": 33, "1585": 33, "1590": 33, "1587": 33, "1594": 33, "old": 33, "hypervisor": 33, "vm": 33, "1513": 33, "1593": 33, "padding_mod": 33, "1580": 33, "1566": 33, "transnetv2": 33, "1564": 33, "rnn": 33, "avx512_core_vnni": 33, "1592": 33, "1589": 33, "1517": 33, "announc": 33, "accompani": 33, "hero": 33, "mha": 33, "flash": 33, "inspir": 33, "stanford": 33, "paper": 33, "consumpt": 33, "ve": 33, "1341": 33, "instancenorm": 33, "1330": 33, "1414": 33, "1473": 33, "1419": 33, "1488": 33, "webpag": 33, "1318": 33, "1353": 33, "1328": 33, "1355": 33, "1367": 33, "1384": 33, "1295": 33, "1392": 33, "1376": 33, "1373": 33, "1338": 33, "1391": 33, "1322": 33, "v1": 33, "usabl": 33, "effort": 33, "summari": 33, "cv": 33, "refin": 33, "identifi": 33, "torchrun": 33, "shortcut": 33, "mkl": 33, "sgemm": 33, "geomean": 33, "auto_ipex": 33, "hood": 33, "calibrated_model": 33, "model_to_be_calibr": 33, "992": 33, "64byte": 33, "constraint": 33, "addlayernorm": 33, "retinanet": 33, "1032": 33, "1053": 33, "1074": 33, "excit": 33, "tightli": 33, "matur": 33, "becam": 33, "bake": 33, "wave2vec": 33, "albert": 33, "facilit": 33, "minmax": 33, "movingaverageminmax": 33, "polish": 33, "flexibl": 33, "quantconf": 33, "multi_stream_input_hint": 33, "multi_stream_output_hint": 33, "accept": 33, "adam": 33, "822": 33, "3d": 33, "642": 33, "deconv3d": 33, "692": 33, "787": 33, "swish": 33, "fsi": 33, "risk": 33, "551": 33, "leakyrelu": 33, "589": 33, "407": 33, "647": 33, "convolution1d": 33, "657": 33, "einsum": 33, "alphafold2": 33, "674": 33, "711": 33, "threa": 33, "slow": 33, "equival": 33, "joint": 33, "net": 33, "648": 33, "684": 33, "685": 33, "dockerhub": 33, "wheel": 33, "reach": 33, "sdk": 33, "2x": 33, "5x": 33, "reduct": 33, "center": 33, "deploi": 33, "u8": 33, "s8": 33, "satur": 33, "occur": 33, "u7": 33, "unsign": 33, "s7": 33, "worth": 33, "upload": 33, "pip3": 33, "whl": 33, "dedic": 33, "220mb": 33, "5mb": 33, "dep": 33, "zip": 33, "220m": 33, "cxx11": 33, "224m": 33, "7m": 33, "5m": 33, "qkv": 33, "encod": 33, "278": 33, "head": 33, "531": 33, "432": 33, "438": 33, "602": 33, "sliu": 33, "hardsigmoid": 33, "relu6": 33, "selu": 33, "524": 33, "452": 33, "425": 33, "100mb": 33, "40mb": 33, "meant": 33, "resolv": 33, "te": 33, "wrap": 33, "bactchnorm": 33, "205": 33, "straightforward": 33, "underhood": 33, "torchvison": 33, "hugginfac": 33, "legal": 33, "resnet18": 33, "resnet18_xpu": 33, "enable_auto_mixed_precis": 33, "mixed_dtyp": 33, "mymodel": 33, "xx_c": 33, "xx_v": 33, "clibrat": 33, "ampconf": 33, "automixprecis": 33, "running_mod": 33, "cali_dataset": 33, "trace_model": 33, "omp_set_num_thread": 33, "model_execut": 33, "same_model_execution_again": 33, "descriptor": 33, "rc3": 33, "parti": 33, "49786": 33, "upgrad": 33, "rc": 33, "readm": 33, "blog": 33, "stakehold": 33, "5rc3": 33, "dpcpp": 33, "heterogen": 33, "bfp16": 33, "proper": 33, "tacotron2": 33, "frozenbatchnorm": 33, "embeddingbad": 33, "daili": 33, "resnext3d": 33, "maskrnn": 33, "codenam": 33, "encount": 33, "mlp": 33, "eltwis": 33, "7x": 33, "enable_auto_optim": 33, "streamlin": 33, "enable_auto_mix_precis": 33, "baselin": 33, "inject": 33, "resnet3d": 33, "fb": 33, "yolov3": 33, "maxpool": 33}, "objects": {"intel_extension_for_pytorch.cpu": [[2, 0, 0, "-", "runtime"]], "intel_extension_for_pytorch.cpu.runtime": [[2, 1, 1, "", "CPUPool"], [2, 1, 1, "", "MultiStreamModule"], [2, 1, 1, "", "MultiStreamModuleHint"], [2, 1, 1, "", "Task"], [2, 2, 1, "", "get_core_list_of_node_id"], [2, 2, 1, "", "is_runtime_ext_enabled"], [2, 1, 1, "", "pin"]], "intel_extension_for_pytorch": [[2, 2, 1, "", "enable_onednn_fusion"], [2, 2, 1, "", "fast_bert"], [2, 2, 1, "", "optimize"], [2, 2, 1, "", "optimize_transformers"], [2, 0, 0, "-", "quantization"], [2, 1, 1, "", "verbose"]], "intel_extension_for_pytorch.nn": [[7, 1, 1, "", "FrozenBatchNorm2d"]], "intel_extension_for_pytorch.nn.functional": [[7, 2, 1, "", "interaction"]], "intel_extension_for_pytorch.nn.modules": [[7, 1, 1, "", "MergedEmbeddingBag"], [7, 1, 1, "", "MergedEmbeddingBagWithSGD"]], "intel_extension_for_pytorch.quantization": [[2, 2, 1, "", "autotune"], [2, 2, 1, "", "convert"], [2, 2, 1, "", "get_smooth_quant_qconfig_mapping"], [2, 2, 1, "", "prepare"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "function", "Python function"]}, "titleterms": {"intel": [0, 1, 5, 6, 15, 29, 30, 31, 32], "extens": [0, 1, 5, 7, 15, 20, 25, 31], "pytorch": [0, 1, 5, 15, 18, 31], "cpu": [0, 2, 17, 18, 32], "isa": [0, 7, 17], "dynam": [0, 6, 7, 15, 17, 25], "dispatch": [0, 7, 17], "design": [0, 20, 30], "doc": 0, "overview": [0, 17, 27, 29, 30, 32], "build": [0, 5, 17], "compil": [0, 7, 17], "requir": [0, 17, 20], "code": 0, "folder": 0, "struct": 0, "kernel": [0, 18], "implement": [0, 20], "csrc": 0, "aten": [0, 18], "xyzkrnl": 0, "cpp": 0, "stub": 0, "xyz": 0, "h": 0, "dyndisp": 0, "dispatchstub": 0, "codegen": 0, "process": 0, "add": 0, "custom": 0, "intrin": 0, "specif": [0, 8], "exampl": [0, 6, 10, 11, 12, 14, 16, 17, 20, 30], "vec": 0, "privat": 0, "debug": [0, 5], "api": [0, 2, 7, 9, 13, 16, 18, 24, 28], "select": [0, 17], "level": [0, 17], "manual": 0, "featur": [0, 6, 7, 11, 12, 17], "check": [0, 17], "architectur": 1, "support": [1, 8, 10], "document": [2, 5, 24, 31, 32], "gener": [2, 25], "fast": [2, 6, 7, 11], "bert": [2, 6, 7, 11, 31], "experiment": [2, 6, 7, 10, 11, 12, 14, 16], "graph": [2, 7, 12, 13, 27], "optim": [2, 7, 10, 13, 15, 19, 27, 28], "quantiz": [2, 6, 7, 15, 28], "runtim": [2, 7, 20, 25], "blog": 3, "public": 3, "cheat": 4, "sheet": 4, "contribut": 5, "develop": 5, "tip": 5, "unit": 5, "test": 5, "python": [5, 6, 7], "better": 5, "local": 5, "pytest": 5, "lint": 5, "c": [5, 6, 18], "write": [5, 18], "train": [6, 8, 25], "singl": [6, 30], "instanc": [6, 29, 30], "float32": [6, 8, 25], "bfloat16": [6, 8, 21, 25, 29], "distribut": [6, 27, 28], "infer": [6, 8, 27, 28, 30, 31], "imper": [6, 8], "mode": [6, 30], "resnet50": [6, 31], "torchscript": [6, 8], "torchdynamo": [6, 25], "new": [6, 7, 33], "from": [6, 7], "2": [6, 7, 14, 31, 33], "0": [6, 7, 33], "int8": [6, 7, 13, 16, 25, 29, 31], "calibr": [6, 15], "static": [6, 15], "deploy": 6, "ai": [6, 29], "refer": [6, 8], "model": [6, 7, 13, 15, 18, 20, 27, 31], "easi": 7, "us": [7, 8, 9, 10, 13, 20, 30], "larg": [7, 27], "languag": [7, 27], "llm": [7, 27, 29], "1": [7, 14, 31, 33], "torch": 7, "auto": [7, 8, 9, 20], "channel": [7, 9, 18, 32], "last": [7, 9, 18, 32], "mix": [7, 8], "precis": [7, 8, 27], "amp": [7, 8], "oper": [7, 18, 19, 27], "codeless": [7, 10], "13": [7, 33], "captur": [7, 12], "hypertun": [7, 14], "introduct": [8, 19, 24], "case": [8, 10, 20], "default": [8, 9, 14, 18, 30], "path": 8, "autocast": 8, "op": 8, "elig": 8, "behavior": 8, "can": 8, "promot": 8, "widest": 8, "input": [8, 20], "type": [8, 27], "eas": [9, 13], "enabl": 9, "disabl": 9, "known": [9, 20, 33], "issu": [9, 20, 33], "motiv": 10, "usag": [10, 11, 12, 14, 16, 20, 25, 28, 30], "huggingfac": 10, "The": 10, "origin": 10, "command": 10, "ipex": 10, "launch": [10, 30], "appli": 10, "fp32": [10, 13, 28, 29], "bf16": [10, 13, 28], "modul": [10, 20], "forward": 10, "method": 10, "explicitli": 10, "instead": 10, "__call__": 10, "attr": 10, "alreadi": 10, "jit": 10, "trace": 10, "descript": [11, 12], "prerequisit": 11, "methodologi": [13, 27], "fusion": [13, 19], "pattern": 13, "fold": 13, "your_conf_fil": 14, "hyperparamet": 14, "launcher": [14, 31], "defin": [14, 15], "search": 14, "space": 14, "tune": [14, 16, 32], "user": 14, "your_python_script": 14, "qconfig": 15, "prepar": 15, "do": 15, "convert": 15, "deploi": [15, 31], "recip": [16, 20], "what": [18, 33], "i": [18, 20, 30], "memori": [18, 30, 32], "format": 18, "all": [18, 30], "That": 18, "matter": 18, "nchw": 18, "b": 18, "nhwc": 18, "wip": 18, "block": 18, "nchw16c": 18, "stride": 18, "layout": 18, "tensor": 18, "creation": 18, "convers": 18, "d": 18, "coverag": 18, "statu": 18, "regist": [18, 31], "nativ": 18, "manner": 18, "onednn": [18, 32], "creat": [18, 31], "convolut": 18, "primit": [18, 32], "target": 18, "multistream": 20, "examples1": 20, "basic": 20, "examples2": 20, "set": 20, "examples3": 20, "structur": [20, 32], "output": 20, "perform": [20, 25, 29, 31, 32, 33], "asynchron": 20, "task": 20, "configur": [20, 29, 32], "core": [20, 30, 31], "bind": 20, "detail": 20, "how": 20, "iomp": 20, "preload": 20, "load": 20, "dure": 20, "split": 21, "sgd": 21, "stochast": 21, "gradient": 21, "descent": 21, "quick": 22, "start": [22, 24, 31], "instal": [23, 31], "get": 24, "troubleshoot": 25, "regress": 25, "shape": 25, "result": [25, 33], "correct": 25, "licens": 26, "demo": 27, "linear": 27, "low": 27, "data": [27, 29], "indirect": 27, "access": [27, 32], "kv": 27, "cach": [27, 32], "transform": 28, "frontend": 28, "pseudocod": 28, "common": 28, "scenario": 28, "smoothquant": 28, "weight": 28, "onli": 28, "woq": 28, "deepspe": 28, "center": 29, "product": 29, "v1": 29, "11": [29, 33], "number": [29, 30, 32], "accuraci": 29, "softwar": [29, 32], "version": 29, "hardwar": [29, 32], "200": [29, 33], "an": 29, "aw": 29, "ec2": 29, "c6i": 29, "2xlarg": 29, "10": [29, 33], "script": 30, "guid": [30, 32], "physic": 30, "ii": 30, "includ": 30, "logic": 30, "iii": 30, "node": 30, "iv": 30, "your": 30, "multipl": 30, "v": 30, "throughput": 30, "vi": 30, "latenc": 30, "vii": 30, "viii": 30, "index": 30, "jemalloc": [30, 32], "tcmalloc": [30, 32], "alloc": [30, 32], "openmp": [30, 32], "librari": 30, "gnu": [30, 32], "torchserv": 31, "content": [31, 32], "thi": [31, 32], "serv": 31, "pin": 31, "boost": 31, "multi": 31, "worker": 31, "scale": 31, "export": 31, "serial": 31, "file": 31, "archiv": 31, "3": 31, "4": 31, "benchmark": 31, "non": 32, "uniform": 32, "numa": 32, "numactl": 32, "omp_num_thread": 32, "omp_thread_limit": 32, "denorm": 32, "releas": 33, "100": 33, "highlight": 33, "12": 33, "300": 33, "": 33, "chang": 33, "9": 33, "8": 33, "improv": 33, "other": 33, "alpha": 33, "note": 33}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Intel\u00ae Extension for PyTorch* CPU ISA Dynamic Dispatch Design Doc": [[0, "intel-extension-for-pytorch-cpu-isa-dynamic-dispatch-design-doc"]], "Overview": [[0, "overview"], [17, "overview"], [29, "overview"], [30, "overview"], [32, "overview"]], "CPU ISA build compiler requirement": [[0, "cpu-isa-build-compiler-requirement"], [17, "cpu-isa-build-compiler-requirement"]], "Dynamic Dispatch Design": [[0, "dynamic-dispatch-design"]], "Code Folder Struct": [[0, "code-folder-struct"]], "Kernel implementation: csrc/cpu/aten/kernels/xyzKrnl.cpp": [[0, "kernel-implementation-csrc-cpu-aten-kernels-xyzkrnl-cpp"]], "Kernel Stub: csrc/cpu/aten/xyz.cpp and csrc/cpu/aten/xyz.h": [[0, "kernel-stub-csrc-cpu-aten-xyz-cpp-and-csrc-cpu-aten-xyz-h"]], "Dispatch Stub implementation: csrc/cpu/dyndisp/DispatchStub.cpp and csrc/cpu/dyndisp/DispatchStub.h": [[0, "dispatch-stub-implementation-csrc-cpu-dyndisp-dispatchstub-cpp-and-csrc-cpu-dyndisp-dispatchstub-h"]], "CodeGen Process": [[0, "codegen-process"]], "Add Custom Kernel": [[0, "add-custom-kernel"]], "ISA intrinics specific kernel example:": [[0, "isa-intrinics-specific-kernel-example"]], "Vec specific kernel example:": [[0, "vec-specific-kernel-example"]], "Private Debug APIs": [[0, "private-debug-apis"]], "Example:": [[0, "example"], [0, "id1"], [17, "example"]], "Select ISA level manually.": [[0, "select-isa-level-manually"]], "CPU feature check": [[0, "cpu-feature-check"], [17, "cpu-feature-check"]], "Intel\u00ae Extension for PyTorch*": [[1, "intel-extension-for-pytorch"]], "Architecture": [[1, "architecture"]], "Support": [[1, "support"]], "API Documentation": [[2, "api-documentation"], [24, "api-documentation"]], "General": [[2, "general"]], "Fast Bert (Experimental)": [[2, "fast-bert-experimental"], [6, "fast-bert-experimental"]], "Graph Optimization": [[2, "graph-optimization"], [7, "graph-optimization"], [13, "graph-optimization"], [27, "graph-optimization"]], "Quantization": [[2, "module-intel_extension_for_pytorch.quantization"]], "CPU Runtime": [[2, "module-intel_extension_for_pytorch.cpu.runtime"]], "Blogs & Publications": [[3, "blogs-publications"]], "Cheat Sheet": [[4, "cheat-sheet"]], "Contribution": [[5, "contribution"]], "Contributing to Intel\u00ae Extension for PyTorch*": [[5, "contributing-to-intel-extension-for-pytorch"]], "Developing Intel\u00ae Extension for PyTorch*": [[5, "developing-intel-extension-for-pytorch"]], "Tips and Debugging": [[5, "tips-and-debugging"]], "Unit testing": [[5, "unit-testing"]], "Python Unit Testing": [[5, "python-unit-testing"]], "Better local unit tests with pytest": [[5, "better-local-unit-tests-with-pytest"]], "Local linting": [[5, "local-linting"]], "C++ Unit Testing": [[5, "c-unit-testing"]], "Writing documentation": [[5, "writing-documentation"]], "Building documentation": [[5, "building-documentation"]], "Tips": [[5, "tips"]], "Examples": [[6, "examples"]], "Python": [[6, "python"]], "Training": [[6, "training"]], "Single-instance Training": [[6, "single-instance-training"]], "Float32": [[6, "float32"], [6, "id1"]], "BFloat16": [[6, "bfloat16"], [6, "id6"], [21, "bfloat16"], [25, "bfloat16"]], "Distributed Training": [[6, "distributed-training"]], "Inference": [[6, "inference"]], "Imperative Mode": [[6, "imperative-mode"], [6, "id7"]], "Resnet50": [[6, "resnet50"], [6, "id2"], [6, "id4"], [6, "id8"], [6, "id11"], [6, "id14"]], "BERT": [[6, "bert"], [6, "id3"], [6, "id5"], [6, "id9"], [6, "id12"], [6, "id15"], [31, "bert"]], "TorchScript Mode": [[6, "torchscript-mode"], [6, "id10"]], "TorchDynamo Mode (Experimental, NEW feature from 2.0.0)": [[6, "torchdynamo-mode-experimental-new-feature-from-2-0-0"], [6, "id13"]], "INT8": [[6, "int8"], [25, "int8"]], "Calibration": [[6, "calibration"]], "Static Quantization": [[6, "static-quantization"], [15, "static-quantization"]], "Dynamic Quantization": [[6, "dynamic-quantization"], [15, "dynamic-quantization"]], "Deployment": [[6, "deployment"]], "C++": [[6, "c"]], "Intel\u00ae AI Reference Models": [[6, "intel-ai-reference-models"]], "Features": [[7, "features"]], "Easy-to-use Python API": [[7, "easy-to-use-python-api"]], "Large Language Models (LLM, NEW feature from 2.1.0)": [[7, "large-language-models-llm-new-feature-from-2-1-0"]], "torch.compile (Experimental, NEW feature from 2.0.0)": [[7, "torch-compile-experimental-new-feature-from-2-0-0"]], "ISA Dynamic Dispatching": [[7, "isa-dynamic-dispatching"], [17, "isa-dynamic-dispatching"]], "Auto Channels Last": [[7, "auto-channels-last"], [9, "auto-channels-last"]], "Auto Mixed Precision (AMP)": [[7, "auto-mixed-precision-amp"], [8, "auto-mixed-precision-amp"]], "Operator Optimization": [[7, "operator-optimization"]], "Optimizer Optimization": [[7, "optimizer-optimization"]], "Runtime Extension": [[7, "runtime-extension"], [20, "runtime-extension"], [25, "runtime-extension"]], "INT8 Quantization": [[7, "int8-quantization"]], "Codeless Optimization (Experimental, NEW feature from 1.13.0)": [[7, "codeless-optimization-experimental-new-feature-from-1-13-0"]], "Graph Capture (Experimental, NEW feature from 1.13.0)": [[7, "graph-capture-experimental-new-feature-from-1-13-0"]], "HyperTune (Experimental, NEW feature from 1.13.0)": [[7, "hypertune-experimental-new-feature-from-1-13-0"]], "Fast BERT Optimization (Experimental, NEW feature from 2.0.0)": [[7, "fast-bert-optimization-experimental-new-feature-from-2-0-0"]], "Introduction": [[8, "introduction"], [19, "introduction"], [24, "introduction"]], "Use Case": [[8, "use-case"]], "Default Precision": [[8, "default-precision"]], "Inference with Imperative Path": [[8, "inference-with-imperative-path"]], "Inference with TorchScript Path": [[8, "inference-with-torchscript-path"]], "Training Support": [[8, "training-support"]], "Autocast Op Reference": [[8, "autocast-op-reference"]], "Op Eligibility": [[8, "op-eligibility"]], "Op-Specific Behavior": [[8, "op-specific-behavior"]], "Ops that can autocast to bfloat16": [[8, "ops-that-can-autocast-to-bfloat16"]], "Ops that can autocast to float32": [[8, "ops-that-can-autocast-to-float32"]], "Ops that promote to the widest input type": [[8, "ops-that-promote-to-the-widest-input-type"]], "Ease-of-use auto channels last API": [[9, "ease-of-use-auto-channels-last-api"]], "default": [[9, "default"]], "enable": [[9, "enable"]], "disable": [[9, "disable"]], "Known issue": [[9, "known-issue"], [33, "known-issue"], [33, "id39"]], "Codeless Optimization (Experimental)": [[10, "codeless-optimization-experimental"]], "Motivation": [[10, "motivation"]], "Example Usage with HuggingFace": [[10, "example-usage-with-huggingface"]], "The origin command with ipex launch": [[10, "the-origin-command-with-ipex-launch"]], "Command to apply ipex optimization for FP32": [[10, "command-to-apply-ipex-optimization-for-fp32"]], "Command to apply ipex optimization for BF16": [[10, "command-to-apply-ipex-optimization-for-bf16"]], "Use Case not supported": [[10, "use-case-not-supported"]], "Module uses forward method explicitly instead of the __call__ attr": [[10, "module-uses-forward-method-explicitly-instead-of-the-call-attr"]], "Already using ipex.optimize": [[10, "already-using-ipex-optimize"]], "Already using Jit Trace": [[10, "already-using-jit-trace"]], "Fast BERT (Experimental)": [[11, "fast-bert-experimental"]], "Feature Description": [[11, "feature-description"], [12, "feature-description"]], "Prerequisite": [[11, "prerequisite"]], "Usage Example": [[11, "usage-example"], [12, "usage-example"], [16, "usage-example"]], "Graph Capture (Experimental)": [[12, "graph-capture-experimental"]], "Ease-of-use graph optimization API": [[13, "ease-of-use-graph-optimization-api"]], "FP32 and BF16 models": [[13, "fp32-and-bf16-models"]], "INT8 models": [[13, "int8-models"]], "Methodology": [[13, "methodology"]], "Fusion": [[13, "fusion"]], "FP32 and BF16 fusion patterns": [[13, "fp32-and-bf16-fusion-patterns"]], "INT8 fusion patterns": [[13, "int8-fusion-patterns"]], "Folding": [[13, "folding"]], "HyperTune (Experimental)": [[14, "hypertune-experimental"]], "Usage of Hypertune": [[14, "usage-of-hypertune"]], "your_conf_file": [[14, "your-conf-file"]], "Hyperparameters": [[14, "hyperparameters"]], "Launcher Hyperparameters": [[14, "launcher-hyperparameters"]], "Defining hyperparameters and their search spaces": [[14, "defining-hyperparameters-and-their-search-spaces"]], "1. Defining hyperparameters to tune:": [[14, "defining-hyperparameters-to-tune"]], "2. Defining the search spaces of the hyperparameters:": [[14, "defining-the-search-spaces-of-the-hyperparameters"]], "Default search space": [[14, "default-search-space"]], "User defined search space": [[14, "user-defined-search-space"]], "<your_python_script>": [[14, "your-python-script"]], "Usage Examples": [[14, "usage-examples"], [30, "usage-examples"]], "Intel\u00ae Extension for PyTorch* optimizations for quantization": [[15, "intel-extension-for-pytorch-optimizations-for-quantization"]], "Define qconfig": [[15, "define-qconfig"]], "Prepare Model and Do Calibration": [[15, "prepare-model-and-do-calibration"]], "Convert to Static Quantized Model and Deploy": [[15, "convert-to-static-quantized-model-and-deploy"]], "Define QConfig": [[15, "id1"]], "Prepare Model": [[15, "prepare-model"]], "Convert to Dynamic Quantized Model and Deploy": [[15, "convert-to-dynamic-quantized-model-and-deploy"]], "INT8 Recipe Tuning API (Experimental)": [[16, "int8-recipe-tuning-api-experimental"]], "Select ISA Level": [[17, "select-isa-level"]], "Channels Last": [[18, "channels-last"], [32, "channels-last"]], "What is Channels Last": [[18, "what-is-channels-last"]], "Memory Format Is All That Matters": [[18, "memory-format-is-all-that-matters"]], "a. NCHW (default)": [[18, "a-nchw-default"]], "b. NHWC (WIP for CPU)": [[18, "b-nhwc-wip-for-cpu"]], "c. Blocked (nChw16c)": [[18, "c-blocked-nchw16c"]], "PyTorch Strided Layout": [[18, "pytorch-strided-layout"]], "PyTorch Channels Last Memory Format APIs": [[18, "pytorch-channels-last-memory-format-apis"]], "a. tensor creation": [[18, "a-tensor-creation"]], "b. tensor conversion": [[18, "b-tensor-conversion"]], "c. model conversion": [[18, "c-model-conversion"]], "d. operator coverage": [[18, "d-operator-coverage"]], "Writing Channels Last Kernels": [[18, "writing-channels-last-kernels"]], "a. Status on CPU": [[18, "a-status-on-cpu"]], "b. Register Channels Last Kernel in ATen Native Manner": [[18, "b-register-channels-last-kernel-in-aten-native-manner"]], "c. Register oneDNN Kernel on Channels Last": [[18, "c-register-onednn-kernel-on-channels-last"]], "oneDNN NHWC APIs": [[18, "onednn-nhwc-apis"]], "a. Create NHWC Memory": [[18, "a-create-nhwc-memory"]], "b. Create Convolution Primitive": [[18, "b-create-convolution-primitive"]], "CPU Channels Last Targets": [[18, "cpu-channels-last-targets"]], "Optimizer Fusion": [[19, "optimizer-fusion"]], "Operation Fusion": [[19, "operation-fusion"]], "Requirements": [[20, "requirements"]], "Use Cases": [[20, "use-cases"]], "Example of MultiStream Module": [[20, "example-of-multistream-module"]], "Examples1: Basic Usage": [[20, "examples1-basic-usage"]], "Examples2: Usage with \u201cAUTO\u201d setting": [[20, "examples2-usage-with-auto-setting"]], "Examples3: Usage for models with structure inputs/outputs": [[20, "examples3-usage-for-models-with-structure-inputs-outputs"]], "Performance recipes": [[20, "performance-recipes"]], "Known issues": [[20, "known-issues"], [33, "id33"]], "Example of asynchronous task": [[20, "example-of-asynchronous-task"]], "Example of configuring core binding": [[20, "example-of-configuring-core-binding"]], "Detail Design": [[20, "detail-design"]], "How the core binding is implemented": [[20, "how-the-core-binding-is-implemented"]], "Design of Task": [[20, "design-of-task"]], "IOMP preload or load during the runtime": [[20, "iomp-preload-or-load-during-the-runtime"]], "Split SGD": [[21, "split-sgd"], [21, "id2"]], "Stochastic Gradient Descent (SGD)": [[21, "stochastic-gradient-descent-sgd"]], "Quick Start": [[22, "quick-start"]], "Installation": [[23, "installation"]], "Get Started": [[24, "get-started"]], "Troubleshooting": [[25, "troubleshooting"]], "General Usage": [[25, "general-usage"]], "Performance Regression": [[25, "performance-regression"]], "TorchDynamo": [[25, "torchdynamo"]], "Dynamic Shape": [[25, "dynamic-shape"]], "Result Correctness": [[25, "result-correctness"]], "Float32 Training": [[25, "float32-training"]], "License": [[26, "license"]], "Large Language Models (LLM) Optimizations Overview": [[27, "large-language-models-llm-optimizations-overview"]], "Optimized Models": [[27, "optimized-models"]], "Demos": [[27, "demos"]], "Optimization Methodologies": [[27, "optimization-methodologies"]], "Linear Operator Optimization": [[27, "linear-operator-optimization"]], "Low Precision Data Types": [[27, "low-precision-data-types"]], "Indirect Access KV Cache": [[27, "indirect-access-kv-cache"]], "Distributed Inference": [[27, "distributed-inference"]], "Transformers Optimization Frontend API": [[28, "transformers-optimization-frontend-api"]], "Pseudocode of Common Usage Scenarios": [[28, "pseudocode-of-common-usage-scenarios"]], "FP32/BF16": [[28, "fp32-bf16"]], "SmoothQuant": [[28, "smoothquant"]], "Weight Only Quantization (WOQ)": [[28, "weight-only-quantization-woq"]], "Distributed Inference with DeepSpeed": [[28, "distributed-inference-with-deepspeed"]], "Performance": [[29, "performance"], [33, "performance"]], "Performance Data for Intel\u00ae AI Data Center Products": [[29, "performance-data-for-intel-ai-data-center-products"]], "LLM Performance": [[29, "llm-performance"]], "INT8 with v1.11": [[29, "int8-with-v1-11"]], "Performance Numbers": [[29, "performance-numbers"], [29, "id1"], [29, "id4"]], "Accuracy": [[29, "accuracy"]], "Configuration": [[29, "configuration"], [29, "id2"], [29, "id5"]], "Software Version": [[29, "software-version"], [29, "id3"], [29, "id6"]], "Hardware Configuration": [[29, "hardware-configuration"], [29, "id7"], [32, "hardware-configuration"]], "FP32 with v1.11.200 on an AWS EC2 C6i.2xlarge instance": [[29, "fp32-with-v1-11-200-on-an-aws-ec2-c6i-2xlarge-instance"]], "FP32 and BFloat16 with v1.10": [[29, "fp32-and-bfloat16-with-v1-10"]], "Launch Script Usage Guide": [[30, "launch-script-usage-guide"]], "Usage of launch script": [[30, "usage-of-launch-script"]], "Single instance for inference": [[30, "single-instance-for-inference"]], "I. Use all physical cores": [[30, "i-use-all-physical-cores"]], "II. Use all cores including logical cores": [[30, "ii-use-all-cores-including-logical-cores"]], "III. Use physical cores on designated nodes": [[30, "iii-use-physical-cores-on-designated-nodes"]], "IV. Use your designated number of cores": [[30, "iv-use-your-designated-number-of-cores"]], "Multiple instances for inference": [[30, "multiple-instances-for-inference"]], "V. Throughput mode": [[30, "v-throughput-mode"]], "VI. Latency mode": [[30, "vi-latency-mode"]], "VII. Your designated number of instances": [[30, "vii-your-designated-number-of-instances"]], "VIII. Your designated number of instances and instance index": [[30, "viii-your-designated-number-of-instances-and-instance-index"]], "Usage of Jemalloc/TCMalloc/Default memory allocator": [[30, "usage-of-jemalloc-tcmalloc-default-memory-allocator"]], "Jemalloc": [[30, "jemalloc"], [32, "jemalloc"]], "TCMalloc": [[30, "tcmalloc"], [32, "tcmalloc"]], "Default memory allocator": [[30, "default-memory-allocator"]], "Usage of OpenMP library": [[30, "usage-of-openmp-library"]], "Intel OpenMP Library": [[30, "intel-openmp-library"]], "GNU OpenMP Library": [[30, "gnu-openmp-library"]], "TorchServe with Intel\u00ae Extension for PyTorch*": [[31, "torchserve-with-intel-extension-for-pytorch"]], "Contents of this Document": [[31, "contents-of-this-document"], [32, "contents-of-this-document"]], "Install Intel\u00ae Extension for PyTorch*": [[31, "install-intel-extension-for-pytorch"]], "Serving model with Intel\u00ae Extension for PyTorch*": [[31, "serving-model-with-intel-extension-for-pytorch"]], "TorchServe with Launcher": [[31, "torchserve-with-launcher"]], "Launcher Core Pinning to Boost Performance of TorchServe Multi Worker Inference": [[31, "launcher-core-pinning-to-boost-performance-of-torchserve-multi-worker-inference"]], "Scaling workers": [[31, "scaling-workers"]], "Creating and Exporting INT8 model for Intel\u00ae Extension for PyTorch*": [[31, "creating-and-exporting-int8-model-for-intel-extension-for-pytorch"]], "1. Creating a serialized file": [[31, "creating-a-serialized-file"]], "ResNet50": [[31, "resnet50"]], "2. Creating a Model Archive": [[31, "creating-a-model-archive"]], "3. Start TorchServe to serve the model": [[31, "start-torchserve-to-serve-the-model"]], "4. Registering and Deploying model": [[31, "registering-and-deploying-model"]], "Benchmarking with Launcher": [[31, "benchmarking-with-launcher"]], "Benchmarking with Launcher Core Pinning": [[31, "benchmarking-with-launcher-core-pinning"]], "Performance Boost with Intel\u00ae Extension for PyTorch* and Launcher": [[31, "performance-boost-with-intel-extension-for-pytorch-and-launcher"]], "Performance Tuning Guide": [[32, "performance-tuning-guide"]], "Intel CPU Structure": [[32, "intel-cpu-structure"]], "Non-Uniform Memory Access (NUMA)": [[32, "non-uniform-memory-access-numa"]], "Software Configuration": [[32, "software-configuration"]], "Numactl": [[32, "numactl"]], "OpenMP": [[32, "openmp"]], "OMP_NUM_THREADS": [[32, "omp-num-threads"]], "OMP_THREAD_LIMIT": [[32, "omp-thread-limit"]], "GNU OpenMP": [[32, "gnu-openmp"]], "Intel OpenMP": [[32, "intel-openmp"]], "Memory Allocator": [[32, "memory-allocator"]], "Denormal Number": [[32, "denormal-number"]], "OneDNN primitive cache": [[32, "onednn-primitive-cache"]], "Releases": [[33, "releases"]], "2.1.100": [[33, "id1"]], "Highlights": [[33, "highlights"], [33, "id3"], [33, "id5"], [33, "id7"], [33, "id9"], [33, "id11"], [33, "id14"], [33, "id17"], [33, "id20"], [33, "id22"], [33, "id25"]], "2.1.0": [[33, "id2"]], "2.0.100": [[33, "id4"]], "2.0.0": [[33, "id6"]], "Known Issues": [[33, "known-issues"], [33, "id12"], [33, "id18"], [33, "id26"]], "1.13.100": [[33, "id8"]], "1.13.0": [[33, "id10"]], "1.12.300": [[33, "id13"]], "1.12.100": [[33, "id15"]], "1.12.0": [[33, "id16"]], "1.11.200": [[33, "id19"]], "1.11.0": [[33, "id21"]], "What\u2019s Changed": [[33, "what-s-changed"], [33, "id27"]], "1.10.100": [[33, "id23"]], "1.10.0": [[33, "id24"]], "1.9.0": [[33, "id28"]], "What\u2019s New": [[33, "what-s-new"], [33, "id30"], [33, "id32"], [33, "id35"], [33, "id38"]], "1.8.0": [[33, "id29"]], "1.2.0": [[33, "id31"]], "Performance Improvement": [[33, "performance-improvement"]], "Others": [[33, "others"]], "1.1.0": [[33, "id34"]], "1.0.2": [[33, "id36"]], "1.0.1-Alpha": [[33, "alpha"]], "1.0.0-Alpha": [[33, "id37"]], "Performance Result": [[33, "performance-result"]], "NOTE": [[33, "note"]]}, "indexentries": {"cpupool (class in intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.CPUPool"]], "multistreammodule (class in intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.MultiStreamModule"]], "multistreammodulehint (class in intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.MultiStreamModuleHint"]], "task (class in intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.Task"]], "autotune() (in module intel_extension_for_pytorch.quantization)": [[2, "intel_extension_for_pytorch.quantization.autotune"]], "convert() (in module intel_extension_for_pytorch.quantization)": [[2, "intel_extension_for_pytorch.quantization.convert"]], "enable_onednn_fusion() (in module intel_extension_for_pytorch)": [[2, "intel_extension_for_pytorch.enable_onednn_fusion"]], "fast_bert() (in module intel_extension_for_pytorch)": [[2, "intel_extension_for_pytorch.fast_bert"]], "get_core_list_of_node_id() (in module intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.get_core_list_of_node_id"]], "get_smooth_quant_qconfig_mapping() (in module intel_extension_for_pytorch.quantization)": [[2, "intel_extension_for_pytorch.quantization.get_smooth_quant_qconfig_mapping"]], "intel_extension_for_pytorch.cpu.runtime": [[2, "module-intel_extension_for_pytorch.cpu.runtime"]], "intel_extension_for_pytorch.quantization": [[2, "module-intel_extension_for_pytorch.quantization"]], "is_runtime_ext_enabled() (in module intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.is_runtime_ext_enabled"]], "module": [[2, "module-intel_extension_for_pytorch.cpu.runtime"], [2, "module-intel_extension_for_pytorch.quantization"]], "optimize() (in module intel_extension_for_pytorch)": [[2, "intel_extension_for_pytorch.optimize"]], "optimize_transformers() (in module intel_extension_for_pytorch)": [[2, "intel_extension_for_pytorch.optimize_transformers"]], "pin (class in intel_extension_for_pytorch.cpu.runtime)": [[2, "intel_extension_for_pytorch.cpu.runtime.pin"]], "prepare() (in module intel_extension_for_pytorch.quantization)": [[2, "intel_extension_for_pytorch.quantization.prepare"]], "verbose (class in intel_extension_for_pytorch)": [[2, "intel_extension_for_pytorch.verbose"]], "frozenbatchnorm2d (class in intel_extension_for_pytorch.nn)": [[7, "intel_extension_for_pytorch.nn.FrozenBatchNorm2d"]], "mergedembeddingbag (class in intel_extension_for_pytorch.nn.modules)": [[7, "intel_extension_for_pytorch.nn.modules.MergedEmbeddingBag"]], "mergedembeddingbagwithsgd (class in intel_extension_for_pytorch.nn.modules)": [[7, "intel_extension_for_pytorch.nn.modules.MergedEmbeddingBagWithSGD"]], "interaction() (in module intel_extension_for_pytorch.nn.functional)": [[7, "intel_extension_for_pytorch.nn.functional.interaction"]]}})